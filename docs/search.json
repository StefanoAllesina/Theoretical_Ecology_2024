[
  {
    "objectID": "ch3.html",
    "href": "ch3.html",
    "title": "Models for disease dynamics",
    "section": "",
    "text": "Disease dynamics are typically represented using compartmental models. In these models, the population is divided into classes (the compartments/boxes) and moves between classes at given rates (the arrows connecting the boxes).\nThe simplest model categorizes individuals as either susceptible (\\(X\\)) or infectious (\\(Y\\)). Susceptible individuals are healthy and infective/infectious people are sick. A susceptible individual can become infectious by contact with an infectious one. We assume that the population is well mixed so that every individual has equal probability of coming into contact with every other individual. Note that infectious individuals cannot recover (e.g., herpes, HIV). For simplicity, we study the model in the absence of demography (births, deaths, immigration, emigration) and assume no disease-induced mortality.\nWe derive the differential equation for the susceptible-infectious (SI) model by considering the number of individuals that become infectious during time \\(\\Delta t\\).\nWe have \\(N\\) individuals in the population, and \\(N=X+Y\\) is fixed. This implies that \\(dN/dt = 0\\), and therefore \\(dX / dt + dY/dt = 0\\). We define \\(S=X/N\\) as the fraction of the population susceptible and \\(I=Y/N\\) as the fraction infectious. Let \\(\\beta \\Delta t\\) be the probability that an infectious person infects a susceptible during \\(\\Delta t\\). The expected fraction of new infectious individuals over this interval is therefore \\(\\beta \\Delta t S I\\):\n\\[\nI(t+\\Delta t)= I(t) + \\beta \\Delta t S(t) I(t)\n\\]\nLet’s analyze the system in continuous time. To convert to differential equations, we consider\n\\[\nI(t+\\Delta t)- I(t) = \\beta \\Delta t\\, S(t) I(t)\n\\]\nand take the limit for \\(\\Delta t \\rightarrow 0\\),\n\\[\n\\lim_{\\Delta t \\rightarrow 0}  \\dfrac{I(t+\\Delta t)- I(t)}{\\Delta t} = \\frac{d I(t)}{d t}  = \\beta S(t) I(t)\n\\]\nTherefore,\n\\[\n\\frac{d S(t)}{d t} = -\\beta S(t) I(t)\n\\]\nWe can sketch the model\n\n\n\n\n\n\n\nIf in a population each individual interacts with equal probability with everyone else, we have homogeneous mixing. Assume a susceptible individual has \\(k\\) contacts/unit time. Of these contacts, \\(I = X/N\\) are with infectious individuals. During \\(\\Delta t\\), the expected number of contacts with infectious individuals is thus \\(k I \\Delta t\\). If the disease is transmitted with probability \\(c\\), the probability that a susceptible individual is not infected in the time interval is\n\\[\n(1-c)^{k I \\Delta t}=1-\\Delta q\n\\]\nWhere \\(\\Delta q\\) is the quantity we want to estimate (the probability/rate of becoming infected/infectious). Taking the logarithm of both sides, and defining \\(\\beta = -k \\log(1-c) &gt; 0\\) we obtain:\n\\[\n\\begin{aligned}\n{kI\\, \\Delta t}\\log(1-c) &=\\log(1-\\Delta q)\\\\\n-\\beta I \\Delta t&=\\log(1-\\Delta q)\\\\\ne^{-\\beta I \\Delta t}&=1-\\Delta q\\\\\n\\Delta q&=1-e^{-\\beta I \\Delta t}\\\\\n\\end{aligned}\n\\]\nRemember that\n\\[\ne^x=1+x+\\frac{x^2}{2!}+\\frac{x^3}{3!}+\\frac{x^4}{4!}+\\ldots\n\\]\nwhich means \\(\\Delta q\\) can be approximated as\n\\[\n\\Delta q \\approx 1-(1+({-\\beta I \\Delta t})) = \\beta I \\Delta t\n\\]\ndividing both sides by \\(\\Delta t\\)\n\\[\n\\frac{\\Delta q}{\\Delta t} = {\\beta I}\n\\]\nAs we take \\(\\Delta t \\rightarrow 0\\), we have\n\\[\n\\frac{d q}{d t} = {\\beta I}\n\\]\nwhich is the transmission (infection) rate per susceptible individual. Often this is called the force of infection and represented by \\(\\lambda\\). Rescaling,\n\\[\n\\frac{d X}{d t}=-\\lambda X  =-\\beta XI\n\\]\nDividing both sides by \\(N\\), we obtain the change in the fraction susceptible:\n\\[\n\\frac{d S}{d t}=-\\beta I S\n\\]\n\n\n\nIf we assume a fixed population, \\(1=S+I\\) (i.e. no births or deaths, we can take \\(N = 1\\) without loss of generality), we can eliminate \\(S\\) from the equations above and write\n\\[\n\\frac{d I(t)}{d t} = \\beta I(t) (1-I(t))\n\\]\nThe equation above should remind you of something: it is logistic growth with \\(r=\\beta\\) and \\(K=1\\). We already know that for every initial condition for which \\(I(0)=I_0&gt;0\\), and for \\(\\beta &gt;0\\), eventually the whole population becomes infected. There is only one stable equilibrium (all individuals infected) and one unstable equilibrium (disease-free).\n\n\n\n\nThe SI model can be extended to the SIS model, where an infected can recover and become susceptible again (a good approximation for some bacterial infections). We assume that the probability that an infectious individual recovers during time \\(\\Delta t\\) is given by \\(\\gamma \\Delta t\\). Then the fraction of infective individuals that recover during time \\(\\Delta t\\) is given by \\(I \\gamma \\Delta t\\):\n\\[\nI(t + \\Delta t)=I(t)+ \\beta \\Delta t S(t) I(t) - \\gamma I(t)\\Delta t\n\\]\n\\[    \nI(t + \\Delta t)-I(t)= \\beta \\Delta t S(t) I(t) - \\gamma I(t)\\Delta t\n\\]\n\\[\n\\lim_{\\Delta t \\rightarrow 0}\\frac{I(t + \\Delta t)-I(t)}{\\Delta t}= \\beta S(t) I(t) - \\gamma I(t)\n\\]\n\\[\n\\frac{dI(t)}{d t}= \\beta S(t) I(t) - \\gamma I(t) = I(t) (\\beta S(t) - \\gamma)\n\\]\nThe parameter \\(\\gamma\\) is the recovery rate, and \\(1/\\gamma\\) is the expected duration of infection. The flow diagram becomes\n\n\n\n\n\nSetting \\(S=1-I\\), we obtain\n\\[\n\\frac{dI(t)}{d t}= I(t) (\\beta (1-I(t)) - \\gamma) = I(t) (\\beta - \\gamma) - \\beta I(t)^2\n\\]\nWhen the disease is rare (i.e., \\(I(t) \\approx 0\\)), we can write the initial growth as:\n\\[\n\\dfrac{1}{I(t)} \\dfrac{dI(t)}{dt} = \\beta - \\gamma - \\beta I(t) \\approx \\beta - \\gamma\n\\]\nThe basic reproductive ratio or intrinsic reproductive number, \\({\\mathcal R}_0\\), for this model is defined as\n\\[\n{\\mathcal R}_0=\\frac{\\beta}{\\gamma}\n\\]\nNote that \\({\\mathcal R}_0\\) determines whether a disease will spread in a susceptible population when infections are rare. Looking at the ratio above, you can probably intuit the criteria for growth in terms of \\({\\mathcal R}_0\\) (we’ll see this in more detail later).\n\\[\n\\frac{dI}{d t}=\\beta I \\left(1 - \\frac{\\gamma}{\\beta}  - I\\right) = \\beta I \\left(1 - \\frac{1}{{\\mathcal R}_0}  - I\\right)\n\\]\nThe equilibria are (\\(I^\\star=0\\), \\(S^\\star=1\\)) and (\\(I^\\star=1-1/{\\mathcal R}_0\\), \\(S^\\star =1/{\\mathcal R}_0\\)). The latter equilibrium is feasible whenever \\({\\mathcal R}_0&gt;1\\). Let’s reformulate the model:\n\\[\n\\frac{dI}{d t}=\\beta I\\left(\\frac{{\\mathcal R}_0-1}{{\\mathcal R}_0}-I\\right)\n\\]\nWe again have a logistic model with \\(r=\\beta \\frac{{\\mathcal R}_0-1}{{\\mathcal R}_0}\\) and \\(K= \\frac{{\\mathcal R}_0-1}{{\\mathcal R}_0}\\).\n\nIf \\({\\mathcal R}_0&lt;1\\), the disease will die out.\nIf \\({\\mathcal R}_0&gt;1\\), the system will eventually arrive to the second equilibrium point. Depending on the value of \\({\\mathcal R}_0\\), in the SIS model, a certain fraction of the population will constantly be infected (i.e., the disease will be endemic).\n\n\n\nLet \\(l(t)\\) be the probability that an individual who is infected at time \\(t_0=0\\) is still infectious at time \\(t\\). This probability is simply the probability of not being recovered at time \\(t\\):\n\\[\n\\begin{aligned}\nl(t + \\Delta t) &= l(t)(1- \\gamma \\Delta t)\\\\\nl(t + \\Delta t)-l(t) &= -l(t) \\gamma \\Delta t\\\\\n\\dfrac{l(t + \\Delta t)-l(t)}{\\Delta t} &= - l(t) \\gamma\\\\\n\\end{aligned}\n\\]\nAnd therefore\n\\[\n\\lim_{\\Delta t \\rightarrow 0}  \\frac{l(t + \\Delta t)-l(t)}{\\Delta t} = \\dfrac{d l(t)}{ dt}= - l(t) \\gamma\n\\]\nAssuming that the individual is infected at time \\(t(0)=t_0\\), \\(l(t_0)=1\\), we can solve by integration:\n\\[\nl(t)=e^{-\\gamma t}\n\\]\nHow many individuals will an infectious individual infect? We want to estimate the number of “secondary infections” caused by each infectious individual. The expected number of secondary infections is obtained by multiplying the probability that the individual is still infected during time \\(dt\\) by the contact rate times the number of susceptibles, \\(X(t)\\beta dt\\). Assuming that the number of infections caused by a single individual is negligible compared to the whole population \\(N\\) (i.e., \\(X \\approx N\\)), the expected total number of secondary infections caused by a single infected is\n\\[\n\\int_0^{\\infty}\\beta X(t)l(t) dt \\approx \\beta N \\int_0^{\\infty} l(t) dt\n\\]\nSubstituting \\(l(t)\\) with its solution, we get\n\\[\n\\int_0^{\\infty}\\beta X(t)l(t) dt \\approx \\beta N \\int_0^{\\infty}\n    e^{-\\gamma t} dt\n\\]\n\\[\n  \\int_0^{\\infty}\\beta X(t)l(t) dt \\approx \\beta N \\frac{1}{\\gamma}\n\\]\nDividing both sides by \\(N\\), we arrive at\n\\[\n\\int_0^{\\infty}\\beta S(t)l(t) dt \\approx {\\mathcal R}_0\n\\]\nHow do we justify the approximation \\(X(t)=N\\)? Suppose we have a completely susceptible population. We then introduce a single infectious individual, and we assume that before the person recovers, the number of susceptibles remains \\(\\approx N\\). Therefore, if \\({\\mathcal R}_0&gt;1\\), the individual produces more than one other infection. (In theory, this might be just one additional infection, or an expectation of \\(&gt;1\\) infection. As long as the reproductive number \\(R_t&gt;1\\), we effectively have a “chain reaction” and a growing epidemic.) On the other hand, if \\({\\mathcal R}_0&lt;1\\), the initial infectious individual cannot pass on the infection, and the disease dies out.\n\n\n\n\nIn this model, once an individual has recovered from the disease, she becomes immune to it. We call such individuals recovered (\\(R\\), sometimes “removed”). This model is indicated for non-life-threatening pathogens that induce sterilizing immunity (however, one could assimilate deaths to recovery). The model consists of three ODEs:\n\\[\n\\begin{cases}\n  \\dfrac{dS}{dt}=-\\beta SI\\\\\n  \\dfrac{dI}{dt}=\\beta SI -\\gamma I \\\\\n  \\dfrac{dR}{dt}=\\gamma I\n\\end{cases}\n\\]\nAgain, we assume that \\(1=S+I+R\\), and thus \\(\\dfrac{dS}{dt} + \\dfrac{dI}{dt} + \\dfrac{dR}{dt} = 0\\). Draw the flow diagram for this model\n\n\n\n\n\nWhen will an epidemic occur? Consider the equation for the infectious class:\n\\[\n\\frac{dI}{dt}=\\beta SI -\\gamma I = I(\\beta S -\\gamma)\n\\]\nIt is clear that for any \\(S(0)&lt;\\gamma/\\beta\\), the growth rate of the infectious class is negative, and the disease dies out. The minimum susceptible fraction for \\(\\frac{dI}{dt}&lt;0\\) is called the susceptible threshold, and it determines the level of herd immunity needed to prevent an outbreak. Recall the basic reproductive ratio for this model is \\({\\mathcal R}_0=\\beta/\\gamma\\). As shown before, if \\({\\mathcal R}_0&gt;1\\), the disease will spread, and it fail to spread if \\({\\mathcal R}_0&lt;1\\). More fundamentally, we know that \\(R_t&lt;1\\) whenever \\(S(t)&lt;\\gamma/\\beta\\). Thus, an epidemic’s inflection point occurs at the susceptible threshold (\\(S(t)=\\gamma/\\beta=1/{\\mathcal R}_0\\)).\n\n\nWe want to know how many individuals will be infected by the disease. We assume that at the beginning, \\(R(0)=0\\). (Note \\(R(t)\\) for this section refers to recovered individuals and \\({\\mathcal R}_0\\) to the intrinsic reproductive number; the notation is treacherous.) We want to write the fraction recovered at \\(R(t)\\). Let’s start by analyzing how the growth rate of \\(S(t)\\) changes in response to \\(R(t)\\):\n\\[\n\\begin{aligned}\n\\dfrac{dS}{dR} & =\\dfrac{dS}{dt}\\dfrac{dt}{dR}\\\\\n&= \\dfrac{-\\beta S I}{\\gamma I}\\\\\n&=-\\dfrac{\\beta}{\\gamma}S\\\\\n&=-{\\mathcal R}_0 S\n\\end{aligned}\n\\]\nWe can separate the equation:\n\\[\n\\frac{dS}{S}=-{\\mathcal R}_0 dR\n\\]\nIntegrating,\n\\[\n\\begin{aligned}\n\\int \\dfrac{1}{S} dS & =-{\\mathcal R}_0 \\int dR \\\\\n\\log{S}  & =-{\\mathcal R}_0 R + C\\\\\nS &= e^{-{\\mathcal R}_0 R} e^C\n\\end{aligned}\n\\] To determine the constant of integration, we substitute \\(S(0) = S_0\\) and \\(R(0) = 0\\), obtaining \\(S_0 = e^C\\) and thus:\n\\[\nS(t) = S(0)e^{-{\\mathcal R}_0 R(t)}\n\\]\nNote that \\(e^{-{\\mathcal R}_0 R_t}\\) is always positive. Thus, the fraction susceptible is always \\(S(t)&gt;0\\). This means that, regardless the value of \\({\\mathcal R}_0\\), some of the population escapes the disease. Another key point is that the end of the epidemic is not caused by the complete absence of susceptibles, but rather their decline below the susceptible threshold. What happens for \\(t \\rightarrow \\infty\\)? We expect that all the infectious individuals will have recovered, so \\(I=0\\). Therefore, \\(S(\\infty)=1-R(\\infty)\\).\nWe take the equation\n\\[\nS(t)=S(0)e^{-{\\mathcal R}_0 R(t)}\n\\]\nand consider the limit at \\(t \\rightarrow \\infty\\),\n\\[\n    S(\\infty)=1-R(\\infty)=S(0)e^{-{\\mathcal R}_0 R(\\infty)}\n\\]\nand assuming that at the beginning, \\(S(0) \\approx 1\\), we obtain\n\\[\nR(\\infty)=1-e^{-{\\mathcal R}_0 R(\\infty)}\n\\]\nwhich is a transcendental equation, i.e., an equation we cannot solve analytically, but only numerically. This is because it contains the transcendental function \\(e^x\\) that cannot be expressed as a finite sequence of algebraic operations (other transcendental functions are, for example, \\(\\log(x)\\), \\(\\sin(x)\\), and \\(\\tan(x)\\)). Only some special transcendental equations can be solved analytically.\n\n\n\n\n\n\nNewton’s method\n\n\n\n\n\nThis is a simple and powerful method to find numerically the solutions (roots, or zeros) of an equation, i.e. the values of \\(x\\) such that \\(f(x) = 0\\). There is no guarantee it will work, given that there are some “degenerate” cases for which the method does not converge.\nThe main idea can be seen using Taylor expansion. We want to approximate the value of the function \\(f(x)\\) at its root (\\(\\alpha\\), such that \\(f(\\alpha) = 0\\)). We have:\n\\[\n\\begin{aligned}\nf(\\alpha) =  0 &= f(x_0) + \\left. \\dfrac{d f(x)}{d x} \\right|_{x_0} (x_0 - \\alpha) + \\mathcal E \\\\\n&= f(x_0) + f'(x_0) (x_0 - \\alpha) + \\mathcal E\n\\end{aligned}\n\\]\nwhere \\(R\\) is the sum of all the higher-order terms (interpreted here as an error). Dividing both sides by \\(f'(x_0)\\), we have:\n\\[\n\\alpha - \\frac{\\mathcal E }{f'(x_0)}= x_0 + \\dfrac{f(x_0)}{f'(x_0)}\n\\]\nNote that whenever \\(x_0\\) is close to \\(\\alpha\\), \\(\\mathcal E \\approx 0\\). The idea of Newton’s method is to iterate:\n\\[\nx_1 = x_0 + \\dfrac{f(x_0)}{f'(x_0)}\n\\]\nand in general\n\\[\nx_{n+1} = x_n + \\dfrac{f(x_n)}{f'(x_n)}\n\\]\nIf the function behaves well, we should get increasingly better approximations of the solution. The R code for the Newton’s method looks something like\n\nxn &lt;- 1000000  # a very large number\nxnp1 &lt;- 1      # a guesstimate of the root\nEps &lt;- 10^(-3) # tolerance\nwhile (abs(xn - xnp1) &gt; Eps) {\n  xn &lt;- xnp1\n  xnp1 &lt;- xn - Funct(xn, par1, par2) / DeriFunct(xn, par1, par2)\n}\n\nwhere Funct and DeriFunct are two R functions returning the value of \\(f(x)\\) and \\(f'(x)\\) respectively using the parameters par1,par2.\n\n\n\n\n\n\n\n\n\nExercise: Approximating epidemic sizes using Newton’s method\n\n\n\n\n\nExamine the following templates:\n\nlibrary(ggplot2)\n\nFunct &lt;- function(x, R0) {\n  # write the code for the function here:\n  # return the value f(x)\n  return(\"???????\")\n}\nDeriFunct &lt;- function(x, R0) {\n  # write the code for the derivative here\n  # return the value of df(x)/dx evaluated at x\n  return(\"???????\")\n}\n\nRInf &lt;- function(R0, Funct, DeriFunct) {\n   xn &lt;- 1000000  # a very large number\n   xnp1 &lt;- 0.5    # a guesstimate of the root\n   Eps &lt;- 10^(-3) # tolerance\n   while (abs(xn - xnp1) &gt; Eps) {\n      xn &lt;- xnp1\n      xnp1 &lt;- xn - Funct(xn, R0) / DeriFunct(xn, R0)\n   }\n   return(xnp1)\n}\n\n# get the R0 values to look at\nR0s &lt;- seq(0, 5, length.out=500)\n# initialize and then fill out the fraction recovered after\n# the dynamics have completed at each R0 value\nRecFracs &lt;- rep(0, 500)\nfor (ii in 1:500){\n    RecFracs[ii] &lt;- RInf(R0s[ii], Funct, DeriFunct)\n}\n# plot the results\nggplot(data_frame(RecFracs, R0s)) +\n    geom_line(aes(x=R0s, y=RecFracs)) +\n    # add in the threshold R0 value\n    geom_hline(aes(yintercept=1), colour=\"red\") +\n    # make the labels nicer and more informative\n    xlab(expression(paste(R[0]))) +\n    ylab(\"Fraction Recovered\") +\n    theme_bw()\n\nUse the templates to plot the fraction of recovered population \\(R({\\infty})\\) as a function of \\({\\mathcal R}_0\\). Values for \\({\\mathcal R}_0\\) change from disease to disease and from host population to host population. For example, estimates for influenza are \\({\\mathcal R}_0 \\in [1.2,3]\\); for rubella, we have \\({\\mathcal R}_0 \\in [6,7]\\); and for measles, \\({\\mathcal R}_0 \\in [16,18]\\). What fraction of a completely susceptible population will be infected by measles? rubella? influenza? Change the code above to compute the values.\n\n\n\n\n\n\nWe can approximate the development of the disease through time. Let’s start from\n\\[\n\\frac{d R}{dt}= \\gamma I\n\\]\nWe know that \\(R+I+S=1\\); therefore,\n\\[\n\\frac{d R}{dt}= \\gamma(1-S-R)\n\\]\nPlugging in the equation we found above, which is valid for \\(R(0) \\approx 0\\),\n\\[\nS(t)=S(0)e^{-{\\mathcal R}_0 R(t)}\n\\]\nwe obtain\n\\[\n\\frac{d R}{dt}= \\gamma (1-S(0)e^{-{\\mathcal R}_0 R(t)}-R(t))\n\\]\n\n\n\n\n\n\nExercise: Visualizing epidemic dynamics\n\n\n\n\n\nFor measles, it has been estimated that \\(\\gamma \\approx 0.2\\)/day and that \\({\\mathcal R}_0 \\approx 18\\). Use the Runge-Kutta 4th-order ODE solver from the R package deSolve to integrate the equation above for the disease in a population for which \\(S(0)=0.9999\\), \\(R(0)=0\\), \\(I(0)=0.0001\\). Run the model for 30 days. What is the proportion of recovered individuals after 5 days? And after 10 days? Plot the curves of \\(S\\), \\(I\\), and \\(R\\). Gain experience points by experimenting with different solvers to see if they have an effect.\n\n\n\n\n\n\nNumerical approximations can go wrong. We can reformulate the models so that the numerical noise introduced by rounding is minimized. Let’s start by log-transforming:\n\\[\n\\begin{cases}\n  s=\\log(S)\\\\\n  i=\\log(I)\\\\\n  r=\\log(R)\n\\end{cases}\n\\] we don’t actually need the equation for \\(r\\), as we know that \\(S+I+R=1\\). The system becomes:\n\\[\n\\begin{cases}\n  e^s \\dfrac{ds}{dt}=-\\beta e^{s+i}\\\\\n  e^i \\dfrac{di}{dt}=\\beta e^{s+i}-\\gamma e^i\n\\end{cases}\n\\]\nwhich, after simplification, becomes:\n\\[\n\\begin{cases}\n  \\dfrac{ds}{dt}=-\\beta e^{i}\\\\\n  \\dfrac{di}{dt}=\\beta e^{s}-\\gamma\n\\end{cases}\n\\]\nNote that there are no multiplications and that each term is a function of just one variable. Thus, the rounding errors are dramatically reduced.\n\n\n\n\n\n\nExercise: Visualizing epidemic dynamics after log-transforming to minimize error\n\n\n\n\n\nUse the equations above to model an outbreak of influenza, assuming that \\(\\beta \\approx 1.66\\)/day and \\(1/\\gamma \\approx 2.2\\) days. Run the model for 15 days using deSolve. Let the initial states be \\(I(0)N=2\\), \\(R(0)N=0\\) and \\(N=750\\). Plot the fraction of infected and susceptible individuals through time. Compare the predicted trajectories to those from the original (non-log-transformed) equations using the same ODE solver.\nIf you want more practice with numerical integration, contrast the solutions obtained with Euler’s method for the original and log-transformed equations. As a template for developing the code, you may use the following, which integrates using Euler2 a Lotka-Volterra predator-prey system.\n\n# Lotka Volterra Model\n# dX/dt=rX-aXY\n# dY/dt=aXY-Y\n\nPredatorPrey &lt;- function(MySpp, MyParams) {\n  x1 &lt;- MyParams[1] * MySpp[1] -\n      MyParams[2] * MySpp[1] * MySpp[2]\n  y1 &lt;- MyParams[2] * MySpp[1] * MySpp[2] - MySpp[2]\n  return(c(x1, y1))\n}\n\nEuler2 &lt;- function(MySpp, D, FUN, MyParams) {\n  m1 &lt;- MySpp + FUN(MySpp, MyParams) * D\n  return(MySpp + 0.5 * (FUN(MySpp, MyParams) +\n                            FUN(m1, MyParams)) * D)\n}\n\n# Initial conditions\nMySpp &lt;- c(8, 5)\n# Parameters\nMyParams &lt;- c(0.7, 0.1)\nDeltat &lt;- 0.005\n# Integration\nPointsToEstimate &lt;- seq(0, 50, by=Deltat)\n# Initialize the data structure\napproximation &lt;- matrix(0, length(PointsToEstimate), 2)\napproximation[1,] &lt;- MySpp\nfor (i in 1:(length(PointsToEstimate) - 1)) {\n    approximation[i+1,] &lt;- Euler2(approximation[i,], Deltat,\n                                  PredatorPrey, MyParams)\n}\n\n# transform the data for plotting\ntrajectories &lt;- approximation %&gt;%\n    # convert to data frame (tibble)\n    as_tibble() %&gt;%\n    # make names nicer\n    rename(Predator=V1, Prey=V2) %&gt;%\n    # add time steps\n    mutate(Time=1:n()) %&gt;%\n    # convert from wide to long format\n    gather(\"Species\", \"Density\", -Time)\n\nWarning: The `x` argument of `as_tibble.matrix()` must have unique column names if\n`.name_repair` is omitted as of tibble 2.0.0.\nℹ Using compatibility `.name_repair`.\n\n# plot the population trajectory approximations\nggplot(trajectories) +\n    aes(x = Time, y = Density, colour = Species) +\n    geom_line(linewidth = 1) +\n    # custom color scale\n    scale_colour_manual(values=c(\"Prey\" = \"#66a1e5\",\n                                 \"Predator\" = \"#b94c75\")) +\n    theme_bw()\n\n\n\n\n\n\n\n\n\n\n\nWe introduce the “natural” mortality rate \\(\\mu\\), i.e., the per capita rate at which individuals die independently of the disease. Assuming a constant mortality rate \\(\\mu\\) is equivalent to assuming that individuals live on average \\(1/\\mu\\) years (or days, depending on the unit of measure of \\(\\mu\\)). We can also assume a birth rate \\(b\\). To simplify the analysis, we assume that the population is at steady state, \\(b=\\mu\\), so that \\(S+I+R=1\\). With these modifications, the model becomes\n\\[\n\\begin{cases}\n  \\dfrac{dS}{dt}=\\mu-\\beta SI-\\mu S\\\\\n  \\dfrac{dI}{dt}=\\beta SI -(\\mu+\\gamma) I\\\\\n  \\dfrac{dR}{dt}=\\gamma I -\\mu R\n\\end{cases}\n\\]\nWe assume that newborns are susceptible to the disease. By setting \\(S=1\\), we can compute \\({\\mathcal R}_0\\). The equation for the infectious class becomes\n\\[\n\\dfrac{dI}{dt}=\\beta SI -(\\mu+\\gamma) I \\approx (\\beta -(\\mu +\\gamma)) I\n\\]\nwhich tells us that the infectious class will grow if:\n\\[\n\\begin{aligned}\n  (\\beta -\\mu-\\gamma)&&gt;0\\\\\n  \\beta &&gt;\\mu+\\gamma\\\\\n  \\frac{\\beta}{\\mu+\\gamma}={\\mathcal R}_0&&gt;1\n\\end{aligned}\n\\]\n\n\nWe have an equilibrium point whenever\n\\[\n\\frac{dS}{dt}=\\frac{dI}{dt}=\\frac{dR}{dt}=0\n\\]\nAn obvious solution is a disease-free state for which \\((S^\\star,I^\\star,R^\\star)=(1,0,0)\\). A disease is endemic if it is constantly present in the population. To find the endemic equilibrium, we solve\n\\[\n    \\beta S^\\star I^\\star -(\\mu+\\gamma) I^\\star=0\n\\]\nand factor \\(I^* \\neq 0\\):\n\\[\n\\begin{aligned}\n\\beta S^\\star -(\\mu+\\gamma) & =0\\\\\nS^\\star &=\\frac{\\mu+\\gamma}{\\beta}\\\\\nS^\\star & =\\frac{1}{{\\mathcal R}_0}\n\\end{aligned}\n\\]\nTo solve for \\(I^\\star\\) and \\(R^\\star\\), we can substitute in the equation for the susceptibles:\n\\[\n\\begin{aligned}\n\\mu-\\beta S^\\star I^\\star -\\mu S^\\star  &=0\\\\\n\\mu-\\beta \\dfrac{I^\\star}{{\\mathcal R}_0}-\\frac{\\mu}{{\\mathcal R}_0}&=0\\\\\nI^\\star&=\\frac{{\\mathcal R}_0}{\\beta}\\left(\\mu -\\frac{\\mu}{{\\mathcal R}_0} \\right)\\\\\nI^\\star&=\\frac{\\mu}{\\beta}({\\mathcal R}_0-1)\n\\end{aligned}\n\\]\nWe can already see that the state is feasible only if \\({\\mathcal R}_0&gt;1\\). Otherwise, the number of infected individuals is negative (in which case, the point cannot be reached by the dynamics). Finally, we can get \\(R^\\star\\) by subtraction:\n\\[\nR^\\star=1-S^\\star-I^\\star=1-\\dfrac{1}{{\\mathcal R}_0}-\\dfrac{\\mu}{\\beta}({\\mathcal R}_0-1)\n\\]\n\n\n\nTo analyze the equilibria, we first build the Jacobian matrix; the equations are:\n\\[\n\\begin{cases}\n  \\dfrac{dS}{dt}=\\mu-\\beta SI-\\mu S\\\\\n  \\dfrac{dI}{dt}=\\beta SI -(\\mu+\\gamma) I\\\\\n  \\dfrac{dR}{dt}=\\gamma I -\\mu R\n\\end{cases}\n\\] yielding:\n\\[\nJ =\n\\begin{pmatrix}\n-\\beta I-\\mu & -\\beta S & 0\\\\\n\\beta I & \\beta S -(\\mu+\\gamma)  & 0\\\\\n0 & \\gamma & -\\mu\n\\end{pmatrix}\n\\]\nLet’s substitute the first, disease-free equilibrium \\((S^\\star,I^\\star,R^\\star)=(1,0,0)\\). The community matrix is\n\\[\nM =\n\\begin{pmatrix}\n-\\mu & -\\beta & 0\\\\\n0 & \\beta -(\\mu+\\gamma)  & 0\\\\\n0 & \\gamma & -\\mu\n\\end{pmatrix}\n\\]\nFor the disease-free equilibrium to be stable, we need all eigenvalues to have negative real part, which means that the determinant of the matrix must be negative.\nThe determinant is simply:\n\\[\n\\det M = \\mu^2 (\\beta - (\\gamma + \\mu)) = \\mu^2 (\\gamma + \\mu) (\\mathcal R_0 - 1)\n\\]\nTherefore, the equilibrium is unstable (i.e., the number of infections will grow) whenever \\(\\mathcal R_0 &gt; 1\\).\nLet’s consider the community matrix for the endemic equilibrium:\n\\[\nM = \\begin{pmatrix}\n-\\mathcal R_0 \\mu  & -\\gamma -\\mu  & 0 \\\\\n(\\mathcal R_0-1) \\mu  & 0 & 0 \\\\\n0 & \\gamma  & -\\mu  \\\\\n\\end{pmatrix}\n\\]\n\n\n\n\n\n\nEigenvalues of block-triangular matrices\n\n\n\n\n\nWe have seen before that the eigenvalues of a lower- (or upper-) triangular matrix are the eigenvalues of the diagonal matrix with the same diagonal. For example, the eigenvalues of\n\\[\nA = \\begin{pmatrix}\na & 0 & 0\\\\\nb & c & 0\\\\\nd & e & f\n\\end{pmatrix}\n\\] are \\(a\\), \\(c\\) and \\(f\\). The same idea applies to block-strucured matrices. Take a matrix \\(M\\)\n\\[\nM = \\begin{pmatrix}\nA_{n \\times n} & 0_{n \\times m}\\\\\nC_{m \\times n} &  B_{m \\times m}\n\\end{pmatrix}\n\\]\nwhere \\(A\\) and \\(B\\) are square matrices. Then the eigenvalues of \\(M\\) are given by the union of the eigenvalues of \\(A\\) and those of \\(B\\). To see why this is the case, write the definition of eigenvalues/eigenvectors for a block matrix of this form:\n\\[\n\\begin{pmatrix}\nA & 0\\\\\nC &  B\n\\end{pmatrix} \\begin{pmatrix} v\\\\w\\end{pmatrix} = \\lambda \\begin{pmatrix} v\\\\w\\end{pmatrix}\n\\]\nWe can rewrite this as a system of equations:\n\\[\n\\begin{aligned}\nA v &= \\lambda v\\\\\nC v + B w &= \\lambda w\n\\end{aligned}\n\\]\nand note that the first set of equations is the definition of an eigenvector \\(v\\) of matrix \\(A\\), associated with eigenvalue \\(\\lambda\\). Thus, \\(\\lambda\\) is an eigenvalue of both \\(A\\) and \\(M\\). If we choose \\(v = 0\\), on the other hand, we have \\(B w = \\lambda w\\), meaning that \\(\\lambda\\) is an eigenvalue of \\(B\\), as well as \\(M\\).\n\n\n\nThe community matrix is block lower-triangular:\n\\[\nM = \\begin{pmatrix}\nA & 0\\\\\nC &  B\n\\end{pmatrix}\n\\]\nWith:\n\\[\nA = \\begin{pmatrix}\n-\\mathcal R_0 \\mu  & -\\gamma -\\mu \\\\\n(\\mathcal R_0-1) \\mu  & 0\n\\end{pmatrix}, \\quad B = \\begin{pmatrix} -\\mu \\end{pmatrix}, \\quad C = \\begin{pmatrix}\n0 & \\gamma\n\\end{pmatrix}\n\\] The eigenvalues of \\(M\\) are given by the union of those of \\(B\\) (yielding \\(-\\mu &lt; 0\\)) and those of \\(A\\). The eigenvalues of \\(A\\) have negative real-part if the trace is negative (always true), and the determinant is positive. The determinant is:\n\\[\n\\det A =  \\mu (\\gamma + \\mu) (\\mathcal R_0-1)\n\\]\nwhich is positive only if \\(\\mathcal R_0 &gt;1\\). Thus, the endemic equilibrium is stable if \\(\\mathcal R_0 &gt; 1\\), and unstable otherwise.\n\n\n\nWe want to know the mean age at which individuals become infected with the disease. The time it takes for a newborn to become infected is approximately the inverse of the force of infection.\n\\[\nA \\approx \\frac{1}{\\beta I^\\star}\n\\]\nwhich at equilibrium becomes\n\\[\nA \\approx \\frac{1}{\\mu ({\\mathcal R}_0-1)}\n\\]\nNoting that \\(L=1/\\mu\\) is the expected life expectancy, we get\n\\[\n{\\mathcal R}_0-1 \\approx \\frac{L}{A}\n\\]\nThis equation is very useful. Knowing the age at which individuals become infected and their life expectancy, we can derive the value for \\({\\mathcal R}_0\\), even for historical diseases.\n\n\n\n\n\n\n\n\nLet \\(p\\) denote the fraction of infants vaccinated (coverage) times the probability that the vaccine actually works (efficacy). We can incorporate this modification into our SIR model:\n\\[\n\\begin{cases}\n  \\dfrac{dS}{dt}=\\mu(1-p)-\\beta SI-\\mu S\\\\\n  \\dfrac{dI}{dt}=\\beta SI -(\\mu+\\gamma) I\\\\\n  \\dfrac{dR}{dt}=\\gamma I -\\mu R + \\mu p\n\\end{cases}\n\\] where we just modified the equation for susceptibles (newborns are vaccinated) and recovered individuals (vaccinated infants go directly to \\(R\\)). A change of variables gives us a better idea of the dynamics of the system. Set \\(S'=(1-p)S\\), \\(I'=(1-p)I\\) and \\(R'=(1-p)R + p\\). By the chain rule,\n\\[\n\\begin{cases}\n  \\dfrac{(1-p)dS'}{dt}=\\mu(1-p)-\\beta S'I'(1-p)^2-\\mu S'(1-p)\\\\\n  \\dfrac{(1-p)dI'}{dt}=\\beta S'I'(1-p)^2 -(\\mu+\\gamma) I'(1-p)\\\\\n  \\dfrac{(1-p)dR'}{dt}=\\gamma I'(1-p) -\\mu R'(1-p) + \\mu p -\\mu p\n\\end{cases}\n\\]\nwhich becomes\n\\[\n\\begin{cases}\n  \\dfrac{dS'}{dt}=\\mu-\\beta S'I'(1-p)-\\mu S'\\\\\n  \\dfrac{dI'}{dt}=\\beta S'I'(1-p) -(\\mu+\\gamma) I'\\\\\n  \\dfrac{dR'}{dt}=\\gamma I' -\\mu R'\n\\end{cases}\n\\]\nFinally, set \\(\\beta'=\\beta(1-p)\\):\n\\[\n\\begin{cases}\n  \\dfrac{dS'}{dt}=\\mu-\\beta' S'I'-\\mu S'\\\\\n  \\dfrac{dI'}{dt}=\\beta' S'I' -(\\mu+\\gamma) I'\\\\\n  \\dfrac{dR'}{dt}=\\gamma I' -\\mu R'\n\\end{cases}\n\\]\nObserve that this is simply a new SIR model in which \\(\\beta'=\\beta(1-p)\\). Thus, \\({\\mathcal R}_0\\) becomes:\n\\[\n{\\mathcal R}_0'=\\frac{\\beta'}{\\gamma + \\mu}=(1-p){\\mathcal R}_0\n\\]\nWhat fraction of the population should we vaccinate to eradicate the disease? Let’s say that \\(p_c\\) is the critical threshold for \\(p\\).\n\\[\n\\begin{array}{l}\n      (1-p_c){\\mathcal R}_0&lt;1\\\\\n      (1-p_c)&lt;\\frac{1}{{\\mathcal R}_0}\\\\\n      p_c&gt;1-\\frac{1}{{\\mathcal R}_0}\n\\end{array}\n\\] Therefore, to eradicate a disease like smallpox (\\({\\mathcal R}_0 \\approx 5\\)), we can simply vaccinate\n\\[\np_c=1-\\frac{1}{5}=0.8\n\\]\nof the newborns. Note that to eradicate measles (\\({\\mathcal R}_0 \\approx 18\\)) we would have to vaccinate \\(\\approx 0.95\\) of the population. The efficacy of the vaccine for measles is around 97%. These differences explain why some diseases can be dramatically more difficult to eradicate than others.\n\n\n\nWe want to study whether a mutant pathogen can invade a population in which a wildtype is in endemic equilibrium. We rewrite our SIR model,\n\\[\n    \\begin{cases}\n      \\dfrac{dS}{dt}=\\mu-(\\beta I +\\beta' I')S-\\mu S\\\\\n      \\dfrac{dI}{dt}=\\beta I  S -(\\mu+\\gamma) I\\\\\n      \\dfrac{dI'}{dt}=\\beta' I'S -(\\mu+\\gamma') I'\\\\\n      \\dfrac{dR}{dt}=\\gamma I + \\gamma' I' -\\mu R\n    \\end{cases}\n\\]\nwhere \\(I\\) is the fraction infected by the wildtype and \\(I'\\) by the mutant. At the endemic equilibrium for which \\(I'=0\\), we have that \\(S^\\star=\\frac{\\mu+\\gamma}{\\beta}\\). To see whether the mutant invades, we can compute its growth rate when it is very rare:\n\\[\n\\frac{dI'}{dt}=\\beta' I'S -(\\mu+\\gamma') I' \\approx \\beta'\n    \\frac{\\mu+\\gamma}{\\beta} I' -(\\mu+\\gamma') I'\n\\]\nWe can rewrite the equation as\n\\[\n\\frac{dI'}{dt}=I' \\left(\\beta' \\frac{\\mu+\\gamma}{\\beta}  -(\\mu+\\gamma') \\right)\n\\]\nThe growth rate is positive if\n\\[\n\\begin{array}{l}\n\\left(\\beta' \\frac{\\mu+\\gamma}{\\beta}  -(\\mu+\\gamma') \\right)&gt;0  \\\\\n\\beta' \\frac{\\mu+\\gamma}{\\beta}  &gt;(\\mu+\\gamma') \\\\\n\\frac{\\mu+\\gamma}{\\beta}  &gt; \\frac{\\mu+\\gamma'}{\\beta'} \\\\\n{\\mathcal R}'_0 &gt; {\\mathcal R}_0\n\\end{array}\n\\]\nThe mutant will invade whenever, all other things being equal, it is either easier to transmit (\\(\\beta' &gt; \\beta\\)) or it makes people sick for a longer time (\\(\\gamma'&lt;\\gamma\\)). Embedding the mortality induced by the disease yields the same result. Therefore, less deadly diseases should be favored. But note that this expectation changes dramatically if we assume that transmission increases (at least over some range) with virulence. This is certainly the case for many pathogens, such as cholera. If this is the case, there we might expect more virulent pathogens to invade, or for some “intermediate” level of virulence to be selected.\n\n\n\n\nOne of the first disease models, proposed by Ronald Ross, who won the Nobel prize for his discovery of malaria transmission via mosquitoes:\n\nRonald Ross, 1915. Some a priori pathometric equations. British Medical Journal 1:546\n\nThe paper introducing compartmental models (SEIR):\n\nW. O. Kermack, A. G. McKendrick, 1927. [Contribution to the mathematical theory of epidemics (https://www.jstor.org/stable/94815). Proceedings of the Royal Society of London A 115.772: 700–721.\n\nThe two foundational papers by Anderson and May:\n\nRoy M. Anderson and Robert M. May, 1979. Population biology of infectious diseases: Part I. Nature 280.5721: 361–367.\nRobert M. May and Roy M. Anderson, 1979. Population biology of infectious diseases: Part II. Nature 280.5722: 455–461.\n\nA very interesting perspective on influence of infectious diseases on human history:\n\nAndrew P. Dobson and E. Robin Carper, 1996. Infectious diseases and human population history. BioScience 46.2: 115–126.\n\nReflections on the relationship between ecology and epidemiology:\n\nRoy M. Anderson, 1991. Populations and Infectious Diseases: Ecology or Epidemiology? Journal of Animal Ecology, 60:1-50"
  },
  {
    "objectID": "ch3.html#susceptibleinfectious",
    "href": "ch3.html#susceptibleinfectious",
    "title": "Models for disease dynamics",
    "section": "",
    "text": "Disease dynamics are typically represented using compartmental models. In these models, the population is divided into classes (the compartments/boxes) and moves between classes at given rates (the arrows connecting the boxes).\nThe simplest model categorizes individuals as either susceptible (\\(X\\)) or infectious (\\(Y\\)). Susceptible individuals are healthy and infective/infectious people are sick. A susceptible individual can become infectious by contact with an infectious one. We assume that the population is well mixed so that every individual has equal probability of coming into contact with every other individual. Note that infectious individuals cannot recover (e.g., herpes, HIV). For simplicity, we study the model in the absence of demography (births, deaths, immigration, emigration) and assume no disease-induced mortality.\nWe derive the differential equation for the susceptible-infectious (SI) model by considering the number of individuals that become infectious during time \\(\\Delta t\\).\nWe have \\(N\\) individuals in the population, and \\(N=X+Y\\) is fixed. This implies that \\(dN/dt = 0\\), and therefore \\(dX / dt + dY/dt = 0\\). We define \\(S=X/N\\) as the fraction of the population susceptible and \\(I=Y/N\\) as the fraction infectious. Let \\(\\beta \\Delta t\\) be the probability that an infectious person infects a susceptible during \\(\\Delta t\\). The expected fraction of new infectious individuals over this interval is therefore \\(\\beta \\Delta t S I\\):\n\\[\nI(t+\\Delta t)= I(t) + \\beta \\Delta t S(t) I(t)\n\\]\nLet’s analyze the system in continuous time. To convert to differential equations, we consider\n\\[\nI(t+\\Delta t)- I(t) = \\beta \\Delta t\\, S(t) I(t)\n\\]\nand take the limit for \\(\\Delta t \\rightarrow 0\\),\n\\[\n\\lim_{\\Delta t \\rightarrow 0}  \\dfrac{I(t+\\Delta t)- I(t)}{\\Delta t} = \\frac{d I(t)}{d t}  = \\beta S(t) I(t)\n\\]\nTherefore,\n\\[\n\\frac{d S(t)}{d t} = -\\beta S(t) I(t)\n\\]\nWe can sketch the model\n\n\n\n\n\n\n\nIf in a population each individual interacts with equal probability with everyone else, we have homogeneous mixing. Assume a susceptible individual has \\(k\\) contacts/unit time. Of these contacts, \\(I = X/N\\) are with infectious individuals. During \\(\\Delta t\\), the expected number of contacts with infectious individuals is thus \\(k I \\Delta t\\). If the disease is transmitted with probability \\(c\\), the probability that a susceptible individual is not infected in the time interval is\n\\[\n(1-c)^{k I \\Delta t}=1-\\Delta q\n\\]\nWhere \\(\\Delta q\\) is the quantity we want to estimate (the probability/rate of becoming infected/infectious). Taking the logarithm of both sides, and defining \\(\\beta = -k \\log(1-c) &gt; 0\\) we obtain:\n\\[\n\\begin{aligned}\n{kI\\, \\Delta t}\\log(1-c) &=\\log(1-\\Delta q)\\\\\n-\\beta I \\Delta t&=\\log(1-\\Delta q)\\\\\ne^{-\\beta I \\Delta t}&=1-\\Delta q\\\\\n\\Delta q&=1-e^{-\\beta I \\Delta t}\\\\\n\\end{aligned}\n\\]\nRemember that\n\\[\ne^x=1+x+\\frac{x^2}{2!}+\\frac{x^3}{3!}+\\frac{x^4}{4!}+\\ldots\n\\]\nwhich means \\(\\Delta q\\) can be approximated as\n\\[\n\\Delta q \\approx 1-(1+({-\\beta I \\Delta t})) = \\beta I \\Delta t\n\\]\ndividing both sides by \\(\\Delta t\\)\n\\[\n\\frac{\\Delta q}{\\Delta t} = {\\beta I}\n\\]\nAs we take \\(\\Delta t \\rightarrow 0\\), we have\n\\[\n\\frac{d q}{d t} = {\\beta I}\n\\]\nwhich is the transmission (infection) rate per susceptible individual. Often this is called the force of infection and represented by \\(\\lambda\\). Rescaling,\n\\[\n\\frac{d X}{d t}=-\\lambda X  =-\\beta XI\n\\]\nDividing both sides by \\(N\\), we obtain the change in the fraction susceptible:\n\\[\n\\frac{d S}{d t}=-\\beta I S\n\\]\n\n\n\nIf we assume a fixed population, \\(1=S+I\\) (i.e. no births or deaths, we can take \\(N = 1\\) without loss of generality), we can eliminate \\(S\\) from the equations above and write\n\\[\n\\frac{d I(t)}{d t} = \\beta I(t) (1-I(t))\n\\]\nThe equation above should remind you of something: it is logistic growth with \\(r=\\beta\\) and \\(K=1\\). We already know that for every initial condition for which \\(I(0)=I_0&gt;0\\), and for \\(\\beta &gt;0\\), eventually the whole population becomes infected. There is only one stable equilibrium (all individuals infected) and one unstable equilibrium (disease-free)."
  },
  {
    "objectID": "ch3.html#susceptibleinfectioussusceptible-sis",
    "href": "ch3.html#susceptibleinfectioussusceptible-sis",
    "title": "Models for disease dynamics",
    "section": "",
    "text": "The SI model can be extended to the SIS model, where an infected can recover and become susceptible again (a good approximation for some bacterial infections). We assume that the probability that an infectious individual recovers during time \\(\\Delta t\\) is given by \\(\\gamma \\Delta t\\). Then the fraction of infective individuals that recover during time \\(\\Delta t\\) is given by \\(I \\gamma \\Delta t\\):\n\\[\nI(t + \\Delta t)=I(t)+ \\beta \\Delta t S(t) I(t) - \\gamma I(t)\\Delta t\n\\]\n\\[    \nI(t + \\Delta t)-I(t)= \\beta \\Delta t S(t) I(t) - \\gamma I(t)\\Delta t\n\\]\n\\[\n\\lim_{\\Delta t \\rightarrow 0}\\frac{I(t + \\Delta t)-I(t)}{\\Delta t}= \\beta S(t) I(t) - \\gamma I(t)\n\\]\n\\[\n\\frac{dI(t)}{d t}= \\beta S(t) I(t) - \\gamma I(t) = I(t) (\\beta S(t) - \\gamma)\n\\]\nThe parameter \\(\\gamma\\) is the recovery rate, and \\(1/\\gamma\\) is the expected duration of infection. The flow diagram becomes\n\n\n\n\n\nSetting \\(S=1-I\\), we obtain\n\\[\n\\frac{dI(t)}{d t}= I(t) (\\beta (1-I(t)) - \\gamma) = I(t) (\\beta - \\gamma) - \\beta I(t)^2\n\\]\nWhen the disease is rare (i.e., \\(I(t) \\approx 0\\)), we can write the initial growth as:\n\\[\n\\dfrac{1}{I(t)} \\dfrac{dI(t)}{dt} = \\beta - \\gamma - \\beta I(t) \\approx \\beta - \\gamma\n\\]\nThe basic reproductive ratio or intrinsic reproductive number, \\({\\mathcal R}_0\\), for this model is defined as\n\\[\n{\\mathcal R}_0=\\frac{\\beta}{\\gamma}\n\\]\nNote that \\({\\mathcal R}_0\\) determines whether a disease will spread in a susceptible population when infections are rare. Looking at the ratio above, you can probably intuit the criteria for growth in terms of \\({\\mathcal R}_0\\) (we’ll see this in more detail later).\n\\[\n\\frac{dI}{d t}=\\beta I \\left(1 - \\frac{\\gamma}{\\beta}  - I\\right) = \\beta I \\left(1 - \\frac{1}{{\\mathcal R}_0}  - I\\right)\n\\]\nThe equilibria are (\\(I^\\star=0\\), \\(S^\\star=1\\)) and (\\(I^\\star=1-1/{\\mathcal R}_0\\), \\(S^\\star =1/{\\mathcal R}_0\\)). The latter equilibrium is feasible whenever \\({\\mathcal R}_0&gt;1\\). Let’s reformulate the model:\n\\[\n\\frac{dI}{d t}=\\beta I\\left(\\frac{{\\mathcal R}_0-1}{{\\mathcal R}_0}-I\\right)\n\\]\nWe again have a logistic model with \\(r=\\beta \\frac{{\\mathcal R}_0-1}{{\\mathcal R}_0}\\) and \\(K= \\frac{{\\mathcal R}_0-1}{{\\mathcal R}_0}\\).\n\nIf \\({\\mathcal R}_0&lt;1\\), the disease will die out.\nIf \\({\\mathcal R}_0&gt;1\\), the system will eventually arrive to the second equilibrium point. Depending on the value of \\({\\mathcal R}_0\\), in the SIS model, a certain fraction of the population will constantly be infected (i.e., the disease will be endemic).\n\n\n\nLet \\(l(t)\\) be the probability that an individual who is infected at time \\(t_0=0\\) is still infectious at time \\(t\\). This probability is simply the probability of not being recovered at time \\(t\\):\n\\[\n\\begin{aligned}\nl(t + \\Delta t) &= l(t)(1- \\gamma \\Delta t)\\\\\nl(t + \\Delta t)-l(t) &= -l(t) \\gamma \\Delta t\\\\\n\\dfrac{l(t + \\Delta t)-l(t)}{\\Delta t} &= - l(t) \\gamma\\\\\n\\end{aligned}\n\\]\nAnd therefore\n\\[\n\\lim_{\\Delta t \\rightarrow 0}  \\frac{l(t + \\Delta t)-l(t)}{\\Delta t} = \\dfrac{d l(t)}{ dt}= - l(t) \\gamma\n\\]\nAssuming that the individual is infected at time \\(t(0)=t_0\\), \\(l(t_0)=1\\), we can solve by integration:\n\\[\nl(t)=e^{-\\gamma t}\n\\]\nHow many individuals will an infectious individual infect? We want to estimate the number of “secondary infections” caused by each infectious individual. The expected number of secondary infections is obtained by multiplying the probability that the individual is still infected during time \\(dt\\) by the contact rate times the number of susceptibles, \\(X(t)\\beta dt\\). Assuming that the number of infections caused by a single individual is negligible compared to the whole population \\(N\\) (i.e., \\(X \\approx N\\)), the expected total number of secondary infections caused by a single infected is\n\\[\n\\int_0^{\\infty}\\beta X(t)l(t) dt \\approx \\beta N \\int_0^{\\infty} l(t) dt\n\\]\nSubstituting \\(l(t)\\) with its solution, we get\n\\[\n\\int_0^{\\infty}\\beta X(t)l(t) dt \\approx \\beta N \\int_0^{\\infty}\n    e^{-\\gamma t} dt\n\\]\n\\[\n  \\int_0^{\\infty}\\beta X(t)l(t) dt \\approx \\beta N \\frac{1}{\\gamma}\n\\]\nDividing both sides by \\(N\\), we arrive at\n\\[\n\\int_0^{\\infty}\\beta S(t)l(t) dt \\approx {\\mathcal R}_0\n\\]\nHow do we justify the approximation \\(X(t)=N\\)? Suppose we have a completely susceptible population. We then introduce a single infectious individual, and we assume that before the person recovers, the number of susceptibles remains \\(\\approx N\\). Therefore, if \\({\\mathcal R}_0&gt;1\\), the individual produces more than one other infection. (In theory, this might be just one additional infection, or an expectation of \\(&gt;1\\) infection. As long as the reproductive number \\(R_t&gt;1\\), we effectively have a “chain reaction” and a growing epidemic.) On the other hand, if \\({\\mathcal R}_0&lt;1\\), the initial infectious individual cannot pass on the infection, and the disease dies out."
  },
  {
    "objectID": "ch3.html#susceptibleinfectiousrecovered-sir",
    "href": "ch3.html#susceptibleinfectiousrecovered-sir",
    "title": "Models for disease dynamics",
    "section": "",
    "text": "In this model, once an individual has recovered from the disease, she becomes immune to it. We call such individuals recovered (\\(R\\), sometimes “removed”). This model is indicated for non-life-threatening pathogens that induce sterilizing immunity (however, one could assimilate deaths to recovery). The model consists of three ODEs:\n\\[\n\\begin{cases}\n  \\dfrac{dS}{dt}=-\\beta SI\\\\\n  \\dfrac{dI}{dt}=\\beta SI -\\gamma I \\\\\n  \\dfrac{dR}{dt}=\\gamma I\n\\end{cases}\n\\]\nAgain, we assume that \\(1=S+I+R\\), and thus \\(\\dfrac{dS}{dt} + \\dfrac{dI}{dt} + \\dfrac{dR}{dt} = 0\\). Draw the flow diagram for this model\n\n\n\n\n\nWhen will an epidemic occur? Consider the equation for the infectious class:\n\\[\n\\frac{dI}{dt}=\\beta SI -\\gamma I = I(\\beta S -\\gamma)\n\\]\nIt is clear that for any \\(S(0)&lt;\\gamma/\\beta\\), the growth rate of the infectious class is negative, and the disease dies out. The minimum susceptible fraction for \\(\\frac{dI}{dt}&lt;0\\) is called the susceptible threshold, and it determines the level of herd immunity needed to prevent an outbreak. Recall the basic reproductive ratio for this model is \\({\\mathcal R}_0=\\beta/\\gamma\\). As shown before, if \\({\\mathcal R}_0&gt;1\\), the disease will spread, and it fail to spread if \\({\\mathcal R}_0&lt;1\\). More fundamentally, we know that \\(R_t&lt;1\\) whenever \\(S(t)&lt;\\gamma/\\beta\\). Thus, an epidemic’s inflection point occurs at the susceptible threshold (\\(S(t)=\\gamma/\\beta=1/{\\mathcal R}_0\\)).\n\n\nWe want to know how many individuals will be infected by the disease. We assume that at the beginning, \\(R(0)=0\\). (Note \\(R(t)\\) for this section refers to recovered individuals and \\({\\mathcal R}_0\\) to the intrinsic reproductive number; the notation is treacherous.) We want to write the fraction recovered at \\(R(t)\\). Let’s start by analyzing how the growth rate of \\(S(t)\\) changes in response to \\(R(t)\\):\n\\[\n\\begin{aligned}\n\\dfrac{dS}{dR} & =\\dfrac{dS}{dt}\\dfrac{dt}{dR}\\\\\n&= \\dfrac{-\\beta S I}{\\gamma I}\\\\\n&=-\\dfrac{\\beta}{\\gamma}S\\\\\n&=-{\\mathcal R}_0 S\n\\end{aligned}\n\\]\nWe can separate the equation:\n\\[\n\\frac{dS}{S}=-{\\mathcal R}_0 dR\n\\]\nIntegrating,\n\\[\n\\begin{aligned}\n\\int \\dfrac{1}{S} dS & =-{\\mathcal R}_0 \\int dR \\\\\n\\log{S}  & =-{\\mathcal R}_0 R + C\\\\\nS &= e^{-{\\mathcal R}_0 R} e^C\n\\end{aligned}\n\\] To determine the constant of integration, we substitute \\(S(0) = S_0\\) and \\(R(0) = 0\\), obtaining \\(S_0 = e^C\\) and thus:\n\\[\nS(t) = S(0)e^{-{\\mathcal R}_0 R(t)}\n\\]\nNote that \\(e^{-{\\mathcal R}_0 R_t}\\) is always positive. Thus, the fraction susceptible is always \\(S(t)&gt;0\\). This means that, regardless the value of \\({\\mathcal R}_0\\), some of the population escapes the disease. Another key point is that the end of the epidemic is not caused by the complete absence of susceptibles, but rather their decline below the susceptible threshold. What happens for \\(t \\rightarrow \\infty\\)? We expect that all the infectious individuals will have recovered, so \\(I=0\\). Therefore, \\(S(\\infty)=1-R(\\infty)\\).\nWe take the equation\n\\[\nS(t)=S(0)e^{-{\\mathcal R}_0 R(t)}\n\\]\nand consider the limit at \\(t \\rightarrow \\infty\\),\n\\[\n    S(\\infty)=1-R(\\infty)=S(0)e^{-{\\mathcal R}_0 R(\\infty)}\n\\]\nand assuming that at the beginning, \\(S(0) \\approx 1\\), we obtain\n\\[\nR(\\infty)=1-e^{-{\\mathcal R}_0 R(\\infty)}\n\\]\nwhich is a transcendental equation, i.e., an equation we cannot solve analytically, but only numerically. This is because it contains the transcendental function \\(e^x\\) that cannot be expressed as a finite sequence of algebraic operations (other transcendental functions are, for example, \\(\\log(x)\\), \\(\\sin(x)\\), and \\(\\tan(x)\\)). Only some special transcendental equations can be solved analytically.\n\n\n\n\n\n\nNewton’s method\n\n\n\n\n\nThis is a simple and powerful method to find numerically the solutions (roots, or zeros) of an equation, i.e. the values of \\(x\\) such that \\(f(x) = 0\\). There is no guarantee it will work, given that there are some “degenerate” cases for which the method does not converge.\nThe main idea can be seen using Taylor expansion. We want to approximate the value of the function \\(f(x)\\) at its root (\\(\\alpha\\), such that \\(f(\\alpha) = 0\\)). We have:\n\\[\n\\begin{aligned}\nf(\\alpha) =  0 &= f(x_0) + \\left. \\dfrac{d f(x)}{d x} \\right|_{x_0} (x_0 - \\alpha) + \\mathcal E \\\\\n&= f(x_0) + f'(x_0) (x_0 - \\alpha) + \\mathcal E\n\\end{aligned}\n\\]\nwhere \\(R\\) is the sum of all the higher-order terms (interpreted here as an error). Dividing both sides by \\(f'(x_0)\\), we have:\n\\[\n\\alpha - \\frac{\\mathcal E }{f'(x_0)}= x_0 + \\dfrac{f(x_0)}{f'(x_0)}\n\\]\nNote that whenever \\(x_0\\) is close to \\(\\alpha\\), \\(\\mathcal E \\approx 0\\). The idea of Newton’s method is to iterate:\n\\[\nx_1 = x_0 + \\dfrac{f(x_0)}{f'(x_0)}\n\\]\nand in general\n\\[\nx_{n+1} = x_n + \\dfrac{f(x_n)}{f'(x_n)}\n\\]\nIf the function behaves well, we should get increasingly better approximations of the solution. The R code for the Newton’s method looks something like\n\nxn &lt;- 1000000  # a very large number\nxnp1 &lt;- 1      # a guesstimate of the root\nEps &lt;- 10^(-3) # tolerance\nwhile (abs(xn - xnp1) &gt; Eps) {\n  xn &lt;- xnp1\n  xnp1 &lt;- xn - Funct(xn, par1, par2) / DeriFunct(xn, par1, par2)\n}\n\nwhere Funct and DeriFunct are two R functions returning the value of \\(f(x)\\) and \\(f'(x)\\) respectively using the parameters par1,par2.\n\n\n\n\n\n\n\n\n\nExercise: Approximating epidemic sizes using Newton’s method\n\n\n\n\n\nExamine the following templates:\n\nlibrary(ggplot2)\n\nFunct &lt;- function(x, R0) {\n  # write the code for the function here:\n  # return the value f(x)\n  return(\"???????\")\n}\nDeriFunct &lt;- function(x, R0) {\n  # write the code for the derivative here\n  # return the value of df(x)/dx evaluated at x\n  return(\"???????\")\n}\n\nRInf &lt;- function(R0, Funct, DeriFunct) {\n   xn &lt;- 1000000  # a very large number\n   xnp1 &lt;- 0.5    # a guesstimate of the root\n   Eps &lt;- 10^(-3) # tolerance\n   while (abs(xn - xnp1) &gt; Eps) {\n      xn &lt;- xnp1\n      xnp1 &lt;- xn - Funct(xn, R0) / DeriFunct(xn, R0)\n   }\n   return(xnp1)\n}\n\n# get the R0 values to look at\nR0s &lt;- seq(0, 5, length.out=500)\n# initialize and then fill out the fraction recovered after\n# the dynamics have completed at each R0 value\nRecFracs &lt;- rep(0, 500)\nfor (ii in 1:500){\n    RecFracs[ii] &lt;- RInf(R0s[ii], Funct, DeriFunct)\n}\n# plot the results\nggplot(data_frame(RecFracs, R0s)) +\n    geom_line(aes(x=R0s, y=RecFracs)) +\n    # add in the threshold R0 value\n    geom_hline(aes(yintercept=1), colour=\"red\") +\n    # make the labels nicer and more informative\n    xlab(expression(paste(R[0]))) +\n    ylab(\"Fraction Recovered\") +\n    theme_bw()\n\nUse the templates to plot the fraction of recovered population \\(R({\\infty})\\) as a function of \\({\\mathcal R}_0\\). Values for \\({\\mathcal R}_0\\) change from disease to disease and from host population to host population. For example, estimates for influenza are \\({\\mathcal R}_0 \\in [1.2,3]\\); for rubella, we have \\({\\mathcal R}_0 \\in [6,7]\\); and for measles, \\({\\mathcal R}_0 \\in [16,18]\\). What fraction of a completely susceptible population will be infected by measles? rubella? influenza? Change the code above to compute the values.\n\n\n\n\n\n\nWe can approximate the development of the disease through time. Let’s start from\n\\[\n\\frac{d R}{dt}= \\gamma I\n\\]\nWe know that \\(R+I+S=1\\); therefore,\n\\[\n\\frac{d R}{dt}= \\gamma(1-S-R)\n\\]\nPlugging in the equation we found above, which is valid for \\(R(0) \\approx 0\\),\n\\[\nS(t)=S(0)e^{-{\\mathcal R}_0 R(t)}\n\\]\nwe obtain\n\\[\n\\frac{d R}{dt}= \\gamma (1-S(0)e^{-{\\mathcal R}_0 R(t)}-R(t))\n\\]\n\n\n\n\n\n\nExercise: Visualizing epidemic dynamics\n\n\n\n\n\nFor measles, it has been estimated that \\(\\gamma \\approx 0.2\\)/day and that \\({\\mathcal R}_0 \\approx 18\\). Use the Runge-Kutta 4th-order ODE solver from the R package deSolve to integrate the equation above for the disease in a population for which \\(S(0)=0.9999\\), \\(R(0)=0\\), \\(I(0)=0.0001\\). Run the model for 30 days. What is the proportion of recovered individuals after 5 days? And after 10 days? Plot the curves of \\(S\\), \\(I\\), and \\(R\\). Gain experience points by experimenting with different solvers to see if they have an effect.\n\n\n\n\n\n\nNumerical approximations can go wrong. We can reformulate the models so that the numerical noise introduced by rounding is minimized. Let’s start by log-transforming:\n\\[\n\\begin{cases}\n  s=\\log(S)\\\\\n  i=\\log(I)\\\\\n  r=\\log(R)\n\\end{cases}\n\\] we don’t actually need the equation for \\(r\\), as we know that \\(S+I+R=1\\). The system becomes:\n\\[\n\\begin{cases}\n  e^s \\dfrac{ds}{dt}=-\\beta e^{s+i}\\\\\n  e^i \\dfrac{di}{dt}=\\beta e^{s+i}-\\gamma e^i\n\\end{cases}\n\\]\nwhich, after simplification, becomes:\n\\[\n\\begin{cases}\n  \\dfrac{ds}{dt}=-\\beta e^{i}\\\\\n  \\dfrac{di}{dt}=\\beta e^{s}-\\gamma\n\\end{cases}\n\\]\nNote that there are no multiplications and that each term is a function of just one variable. Thus, the rounding errors are dramatically reduced.\n\n\n\n\n\n\nExercise: Visualizing epidemic dynamics after log-transforming to minimize error\n\n\n\n\n\nUse the equations above to model an outbreak of influenza, assuming that \\(\\beta \\approx 1.66\\)/day and \\(1/\\gamma \\approx 2.2\\) days. Run the model for 15 days using deSolve. Let the initial states be \\(I(0)N=2\\), \\(R(0)N=0\\) and \\(N=750\\). Plot the fraction of infected and susceptible individuals through time. Compare the predicted trajectories to those from the original (non-log-transformed) equations using the same ODE solver.\nIf you want more practice with numerical integration, contrast the solutions obtained with Euler’s method for the original and log-transformed equations. As a template for developing the code, you may use the following, which integrates using Euler2 a Lotka-Volterra predator-prey system.\n\n# Lotka Volterra Model\n# dX/dt=rX-aXY\n# dY/dt=aXY-Y\n\nPredatorPrey &lt;- function(MySpp, MyParams) {\n  x1 &lt;- MyParams[1] * MySpp[1] -\n      MyParams[2] * MySpp[1] * MySpp[2]\n  y1 &lt;- MyParams[2] * MySpp[1] * MySpp[2] - MySpp[2]\n  return(c(x1, y1))\n}\n\nEuler2 &lt;- function(MySpp, D, FUN, MyParams) {\n  m1 &lt;- MySpp + FUN(MySpp, MyParams) * D\n  return(MySpp + 0.5 * (FUN(MySpp, MyParams) +\n                            FUN(m1, MyParams)) * D)\n}\n\n# Initial conditions\nMySpp &lt;- c(8, 5)\n# Parameters\nMyParams &lt;- c(0.7, 0.1)\nDeltat &lt;- 0.005\n# Integration\nPointsToEstimate &lt;- seq(0, 50, by=Deltat)\n# Initialize the data structure\napproximation &lt;- matrix(0, length(PointsToEstimate), 2)\napproximation[1,] &lt;- MySpp\nfor (i in 1:(length(PointsToEstimate) - 1)) {\n    approximation[i+1,] &lt;- Euler2(approximation[i,], Deltat,\n                                  PredatorPrey, MyParams)\n}\n\n# transform the data for plotting\ntrajectories &lt;- approximation %&gt;%\n    # convert to data frame (tibble)\n    as_tibble() %&gt;%\n    # make names nicer\n    rename(Predator=V1, Prey=V2) %&gt;%\n    # add time steps\n    mutate(Time=1:n()) %&gt;%\n    # convert from wide to long format\n    gather(\"Species\", \"Density\", -Time)\n\nWarning: The `x` argument of `as_tibble.matrix()` must have unique column names if\n`.name_repair` is omitted as of tibble 2.0.0.\nℹ Using compatibility `.name_repair`.\n\n# plot the population trajectory approximations\nggplot(trajectories) +\n    aes(x = Time, y = Density, colour = Species) +\n    geom_line(linewidth = 1) +\n    # custom color scale\n    scale_colour_manual(values=c(\"Prey\" = \"#66a1e5\",\n                                 \"Predator\" = \"#b94c75\")) +\n    theme_bw()"
  },
  {
    "objectID": "ch3.html#sir-with-demography",
    "href": "ch3.html#sir-with-demography",
    "title": "Models for disease dynamics",
    "section": "",
    "text": "We introduce the “natural” mortality rate \\(\\mu\\), i.e., the per capita rate at which individuals die independently of the disease. Assuming a constant mortality rate \\(\\mu\\) is equivalent to assuming that individuals live on average \\(1/\\mu\\) years (or days, depending on the unit of measure of \\(\\mu\\)). We can also assume a birth rate \\(b\\). To simplify the analysis, we assume that the population is at steady state, \\(b=\\mu\\), so that \\(S+I+R=1\\). With these modifications, the model becomes\n\\[\n\\begin{cases}\n  \\dfrac{dS}{dt}=\\mu-\\beta SI-\\mu S\\\\\n  \\dfrac{dI}{dt}=\\beta SI -(\\mu+\\gamma) I\\\\\n  \\dfrac{dR}{dt}=\\gamma I -\\mu R\n\\end{cases}\n\\]\nWe assume that newborns are susceptible to the disease. By setting \\(S=1\\), we can compute \\({\\mathcal R}_0\\). The equation for the infectious class becomes\n\\[\n\\dfrac{dI}{dt}=\\beta SI -(\\mu+\\gamma) I \\approx (\\beta -(\\mu +\\gamma)) I\n\\]\nwhich tells us that the infectious class will grow if:\n\\[\n\\begin{aligned}\n  (\\beta -\\mu-\\gamma)&&gt;0\\\\\n  \\beta &&gt;\\mu+\\gamma\\\\\n  \\frac{\\beta}{\\mu+\\gamma}={\\mathcal R}_0&&gt;1\n\\end{aligned}\n\\]\n\n\nWe have an equilibrium point whenever\n\\[\n\\frac{dS}{dt}=\\frac{dI}{dt}=\\frac{dR}{dt}=0\n\\]\nAn obvious solution is a disease-free state for which \\((S^\\star,I^\\star,R^\\star)=(1,0,0)\\). A disease is endemic if it is constantly present in the population. To find the endemic equilibrium, we solve\n\\[\n    \\beta S^\\star I^\\star -(\\mu+\\gamma) I^\\star=0\n\\]\nand factor \\(I^* \\neq 0\\):\n\\[\n\\begin{aligned}\n\\beta S^\\star -(\\mu+\\gamma) & =0\\\\\nS^\\star &=\\frac{\\mu+\\gamma}{\\beta}\\\\\nS^\\star & =\\frac{1}{{\\mathcal R}_0}\n\\end{aligned}\n\\]\nTo solve for \\(I^\\star\\) and \\(R^\\star\\), we can substitute in the equation for the susceptibles:\n\\[\n\\begin{aligned}\n\\mu-\\beta S^\\star I^\\star -\\mu S^\\star  &=0\\\\\n\\mu-\\beta \\dfrac{I^\\star}{{\\mathcal R}_0}-\\frac{\\mu}{{\\mathcal R}_0}&=0\\\\\nI^\\star&=\\frac{{\\mathcal R}_0}{\\beta}\\left(\\mu -\\frac{\\mu}{{\\mathcal R}_0} \\right)\\\\\nI^\\star&=\\frac{\\mu}{\\beta}({\\mathcal R}_0-1)\n\\end{aligned}\n\\]\nWe can already see that the state is feasible only if \\({\\mathcal R}_0&gt;1\\). Otherwise, the number of infected individuals is negative (in which case, the point cannot be reached by the dynamics). Finally, we can get \\(R^\\star\\) by subtraction:\n\\[\nR^\\star=1-S^\\star-I^\\star=1-\\dfrac{1}{{\\mathcal R}_0}-\\dfrac{\\mu}{\\beta}({\\mathcal R}_0-1)\n\\]\n\n\n\nTo analyze the equilibria, we first build the Jacobian matrix; the equations are:\n\\[\n\\begin{cases}\n  \\dfrac{dS}{dt}=\\mu-\\beta SI-\\mu S\\\\\n  \\dfrac{dI}{dt}=\\beta SI -(\\mu+\\gamma) I\\\\\n  \\dfrac{dR}{dt}=\\gamma I -\\mu R\n\\end{cases}\n\\] yielding:\n\\[\nJ =\n\\begin{pmatrix}\n-\\beta I-\\mu & -\\beta S & 0\\\\\n\\beta I & \\beta S -(\\mu+\\gamma)  & 0\\\\\n0 & \\gamma & -\\mu\n\\end{pmatrix}\n\\]\nLet’s substitute the first, disease-free equilibrium \\((S^\\star,I^\\star,R^\\star)=(1,0,0)\\). The community matrix is\n\\[\nM =\n\\begin{pmatrix}\n-\\mu & -\\beta & 0\\\\\n0 & \\beta -(\\mu+\\gamma)  & 0\\\\\n0 & \\gamma & -\\mu\n\\end{pmatrix}\n\\]\nFor the disease-free equilibrium to be stable, we need all eigenvalues to have negative real part, which means that the determinant of the matrix must be negative.\nThe determinant is simply:\n\\[\n\\det M = \\mu^2 (\\beta - (\\gamma + \\mu)) = \\mu^2 (\\gamma + \\mu) (\\mathcal R_0 - 1)\n\\]\nTherefore, the equilibrium is unstable (i.e., the number of infections will grow) whenever \\(\\mathcal R_0 &gt; 1\\).\nLet’s consider the community matrix for the endemic equilibrium:\n\\[\nM = \\begin{pmatrix}\n-\\mathcal R_0 \\mu  & -\\gamma -\\mu  & 0 \\\\\n(\\mathcal R_0-1) \\mu  & 0 & 0 \\\\\n0 & \\gamma  & -\\mu  \\\\\n\\end{pmatrix}\n\\]\n\n\n\n\n\n\nEigenvalues of block-triangular matrices\n\n\n\n\n\nWe have seen before that the eigenvalues of a lower- (or upper-) triangular matrix are the eigenvalues of the diagonal matrix with the same diagonal. For example, the eigenvalues of\n\\[\nA = \\begin{pmatrix}\na & 0 & 0\\\\\nb & c & 0\\\\\nd & e & f\n\\end{pmatrix}\n\\] are \\(a\\), \\(c\\) and \\(f\\). The same idea applies to block-strucured matrices. Take a matrix \\(M\\)\n\\[\nM = \\begin{pmatrix}\nA_{n \\times n} & 0_{n \\times m}\\\\\nC_{m \\times n} &  B_{m \\times m}\n\\end{pmatrix}\n\\]\nwhere \\(A\\) and \\(B\\) are square matrices. Then the eigenvalues of \\(M\\) are given by the union of the eigenvalues of \\(A\\) and those of \\(B\\). To see why this is the case, write the definition of eigenvalues/eigenvectors for a block matrix of this form:\n\\[\n\\begin{pmatrix}\nA & 0\\\\\nC &  B\n\\end{pmatrix} \\begin{pmatrix} v\\\\w\\end{pmatrix} = \\lambda \\begin{pmatrix} v\\\\w\\end{pmatrix}\n\\]\nWe can rewrite this as a system of equations:\n\\[\n\\begin{aligned}\nA v &= \\lambda v\\\\\nC v + B w &= \\lambda w\n\\end{aligned}\n\\]\nand note that the first set of equations is the definition of an eigenvector \\(v\\) of matrix \\(A\\), associated with eigenvalue \\(\\lambda\\). Thus, \\(\\lambda\\) is an eigenvalue of both \\(A\\) and \\(M\\). If we choose \\(v = 0\\), on the other hand, we have \\(B w = \\lambda w\\), meaning that \\(\\lambda\\) is an eigenvalue of \\(B\\), as well as \\(M\\).\n\n\n\nThe community matrix is block lower-triangular:\n\\[\nM = \\begin{pmatrix}\nA & 0\\\\\nC &  B\n\\end{pmatrix}\n\\]\nWith:\n\\[\nA = \\begin{pmatrix}\n-\\mathcal R_0 \\mu  & -\\gamma -\\mu \\\\\n(\\mathcal R_0-1) \\mu  & 0\n\\end{pmatrix}, \\quad B = \\begin{pmatrix} -\\mu \\end{pmatrix}, \\quad C = \\begin{pmatrix}\n0 & \\gamma\n\\end{pmatrix}\n\\] The eigenvalues of \\(M\\) are given by the union of those of \\(B\\) (yielding \\(-\\mu &lt; 0\\)) and those of \\(A\\). The eigenvalues of \\(A\\) have negative real-part if the trace is negative (always true), and the determinant is positive. The determinant is:\n\\[\n\\det A =  \\mu (\\gamma + \\mu) (\\mathcal R_0-1)\n\\]\nwhich is positive only if \\(\\mathcal R_0 &gt;1\\). Thus, the endemic equilibrium is stable if \\(\\mathcal R_0 &gt; 1\\), and unstable otherwise.\n\n\n\nWe want to know the mean age at which individuals become infected with the disease. The time it takes for a newborn to become infected is approximately the inverse of the force of infection.\n\\[\nA \\approx \\frac{1}{\\beta I^\\star}\n\\]\nwhich at equilibrium becomes\n\\[\nA \\approx \\frac{1}{\\mu ({\\mathcal R}_0-1)}\n\\]\nNoting that \\(L=1/\\mu\\) is the expected life expectancy, we get\n\\[\n{\\mathcal R}_0-1 \\approx \\frac{L}{A}\n\\]\nThis equation is very useful. Knowing the age at which individuals become infected and their life expectancy, we can derive the value for \\({\\mathcal R}_0\\), even for historical diseases.\n\n\n\n\n\n\n\n\nLet \\(p\\) denote the fraction of infants vaccinated (coverage) times the probability that the vaccine actually works (efficacy). We can incorporate this modification into our SIR model:\n\\[\n\\begin{cases}\n  \\dfrac{dS}{dt}=\\mu(1-p)-\\beta SI-\\mu S\\\\\n  \\dfrac{dI}{dt}=\\beta SI -(\\mu+\\gamma) I\\\\\n  \\dfrac{dR}{dt}=\\gamma I -\\mu R + \\mu p\n\\end{cases}\n\\] where we just modified the equation for susceptibles (newborns are vaccinated) and recovered individuals (vaccinated infants go directly to \\(R\\)). A change of variables gives us a better idea of the dynamics of the system. Set \\(S'=(1-p)S\\), \\(I'=(1-p)I\\) and \\(R'=(1-p)R + p\\). By the chain rule,\n\\[\n\\begin{cases}\n  \\dfrac{(1-p)dS'}{dt}=\\mu(1-p)-\\beta S'I'(1-p)^2-\\mu S'(1-p)\\\\\n  \\dfrac{(1-p)dI'}{dt}=\\beta S'I'(1-p)^2 -(\\mu+\\gamma) I'(1-p)\\\\\n  \\dfrac{(1-p)dR'}{dt}=\\gamma I'(1-p) -\\mu R'(1-p) + \\mu p -\\mu p\n\\end{cases}\n\\]\nwhich becomes\n\\[\n\\begin{cases}\n  \\dfrac{dS'}{dt}=\\mu-\\beta S'I'(1-p)-\\mu S'\\\\\n  \\dfrac{dI'}{dt}=\\beta S'I'(1-p) -(\\mu+\\gamma) I'\\\\\n  \\dfrac{dR'}{dt}=\\gamma I' -\\mu R'\n\\end{cases}\n\\]\nFinally, set \\(\\beta'=\\beta(1-p)\\):\n\\[\n\\begin{cases}\n  \\dfrac{dS'}{dt}=\\mu-\\beta' S'I'-\\mu S'\\\\\n  \\dfrac{dI'}{dt}=\\beta' S'I' -(\\mu+\\gamma) I'\\\\\n  \\dfrac{dR'}{dt}=\\gamma I' -\\mu R'\n\\end{cases}\n\\]\nObserve that this is simply a new SIR model in which \\(\\beta'=\\beta(1-p)\\). Thus, \\({\\mathcal R}_0\\) becomes:\n\\[\n{\\mathcal R}_0'=\\frac{\\beta'}{\\gamma + \\mu}=(1-p){\\mathcal R}_0\n\\]\nWhat fraction of the population should we vaccinate to eradicate the disease? Let’s say that \\(p_c\\) is the critical threshold for \\(p\\).\n\\[\n\\begin{array}{l}\n      (1-p_c){\\mathcal R}_0&lt;1\\\\\n      (1-p_c)&lt;\\frac{1}{{\\mathcal R}_0}\\\\\n      p_c&gt;1-\\frac{1}{{\\mathcal R}_0}\n\\end{array}\n\\] Therefore, to eradicate a disease like smallpox (\\({\\mathcal R}_0 \\approx 5\\)), we can simply vaccinate\n\\[\np_c=1-\\frac{1}{5}=0.8\n\\]\nof the newborns. Note that to eradicate measles (\\({\\mathcal R}_0 \\approx 18\\)) we would have to vaccinate \\(\\approx 0.95\\) of the population. The efficacy of the vaccine for measles is around 97%. These differences explain why some diseases can be dramatically more difficult to eradicate than others.\n\n\n\nWe want to study whether a mutant pathogen can invade a population in which a wildtype is in endemic equilibrium. We rewrite our SIR model,\n\\[\n    \\begin{cases}\n      \\dfrac{dS}{dt}=\\mu-(\\beta I +\\beta' I')S-\\mu S\\\\\n      \\dfrac{dI}{dt}=\\beta I  S -(\\mu+\\gamma) I\\\\\n      \\dfrac{dI'}{dt}=\\beta' I'S -(\\mu+\\gamma') I'\\\\\n      \\dfrac{dR}{dt}=\\gamma I + \\gamma' I' -\\mu R\n    \\end{cases}\n\\]\nwhere \\(I\\) is the fraction infected by the wildtype and \\(I'\\) by the mutant. At the endemic equilibrium for which \\(I'=0\\), we have that \\(S^\\star=\\frac{\\mu+\\gamma}{\\beta}\\). To see whether the mutant invades, we can compute its growth rate when it is very rare:\n\\[\n\\frac{dI'}{dt}=\\beta' I'S -(\\mu+\\gamma') I' \\approx \\beta'\n    \\frac{\\mu+\\gamma}{\\beta} I' -(\\mu+\\gamma') I'\n\\]\nWe can rewrite the equation as\n\\[\n\\frac{dI'}{dt}=I' \\left(\\beta' \\frac{\\mu+\\gamma}{\\beta}  -(\\mu+\\gamma') \\right)\n\\]\nThe growth rate is positive if\n\\[\n\\begin{array}{l}\n\\left(\\beta' \\frac{\\mu+\\gamma}{\\beta}  -(\\mu+\\gamma') \\right)&gt;0  \\\\\n\\beta' \\frac{\\mu+\\gamma}{\\beta}  &gt;(\\mu+\\gamma') \\\\\n\\frac{\\mu+\\gamma}{\\beta}  &gt; \\frac{\\mu+\\gamma'}{\\beta'} \\\\\n{\\mathcal R}'_0 &gt; {\\mathcal R}_0\n\\end{array}\n\\]\nThe mutant will invade whenever, all other things being equal, it is either easier to transmit (\\(\\beta' &gt; \\beta\\)) or it makes people sick for a longer time (\\(\\gamma'&lt;\\gamma\\)). Embedding the mortality induced by the disease yields the same result. Therefore, less deadly diseases should be favored. But note that this expectation changes dramatically if we assume that transmission increases (at least over some range) with virulence. This is certainly the case for many pathogens, such as cholera. If this is the case, there we might expect more virulent pathogens to invade, or for some “intermediate” level of virulence to be selected."
  },
  {
    "objectID": "ch3.html#classic-papers",
    "href": "ch3.html#classic-papers",
    "title": "Models for disease dynamics",
    "section": "",
    "text": "One of the first disease models, proposed by Ronald Ross, who won the Nobel prize for his discovery of malaria transmission via mosquitoes:\n\nRonald Ross, 1915. Some a priori pathometric equations. British Medical Journal 1:546\n\nThe paper introducing compartmental models (SEIR):\n\nW. O. Kermack, A. G. McKendrick, 1927. [Contribution to the mathematical theory of epidemics (https://www.jstor.org/stable/94815). Proceedings of the Royal Society of London A 115.772: 700–721.\n\nThe two foundational papers by Anderson and May:\n\nRoy M. Anderson and Robert M. May, 1979. Population biology of infectious diseases: Part I. Nature 280.5721: 361–367.\nRobert M. May and Roy M. Anderson, 1979. Population biology of infectious diseases: Part II. Nature 280.5722: 455–461.\n\nA very interesting perspective on influence of infectious diseases on human history:\n\nAndrew P. Dobson and E. Robin Carper, 1996. Infectious diseases and human population history. BioScience 46.2: 115–126.\n\nReflections on the relationship between ecology and epidemiology:\n\nRoy M. Anderson, 1991. Populations and Infectious Diseases: Ecology or Epidemiology? Journal of Animal Ecology, 60:1-50"
  },
  {
    "objectID": "ch4.html",
    "href": "ch4.html",
    "title": "Models for many populations",
    "section": "",
    "text": "Models for many populations\nTODO\nMay R.M. 1972. Will a large complex system be stable? Nature 238:413-414\nMcCann, K.S. 2000. The diversity - stability debate. Nature 405:228-233"
  },
  {
    "objectID": "about.html",
    "href": "about.html",
    "title": "About",
    "section": "",
    "text": "These lecture notes were prepared by Stefano Allesina (sallesina@uchicago.edu) for the graduate class ECEV 42900, Theoretical Ecology, taught at the University of Chicago in Winter Quarter 2024. The notes grew a set of notes from Sarah Cobey.\nCall-out sections contain special material:\n\n\n\n\n\n\nMathematical review\n\n\n\n\n\nThis type of call-out contains brief reviews of important mathematical concepts.\n\n\n\n\n\n\n\n\n\nComputing in R\n\n\n\n\n\nThis type of call-out contains information about coding dynamical systems in R.\n\n\n\n\n\n\n\n\n\nExercises\n\n\n\n\n\nThis type of call-out contains exercises that should be submitted by the following class.\n\n\n\n\nResources\nThese are good introductions to theoretical ecology:\n\nCase, An Illustrated Guide to Theoretical Ecology, 1999\nMay and McLean, Theoretical Ecology: Principles and Applications, 2007\nGotelli, A primer of ecology, 2008\nHofbauer and Sigmund Evolutionary Games and Population Dynamics, 1998\n\nBooks on disease dynamics:\n\nAnderson and May Infectious Diseases of Humans: Dynamics and Control, 1992\nKeeling and Rohani Modelling Infectious Diseases, 2008\n\n\n\nCourse policies\nThe ethos of the course is collaborative rather than competitive. The instructors and TA are happy to help with assignments and clarifications. The first point of contact should be the TA, Kiseok Lee (kiseoklee@uchicago.edu); you can also email Stefano Allesina (sallesina@uchicago.edu) or Greg Dwyer (gdwyer@uchicago.edu) to set up a meeting.\nStudents are expected to work in accordance with the University Policy of Academic Integrity, which can be found here.\nStudents can collaborate, but graded homework should be completed by each student independently, and not copied from others or from online resources. Students can use online resources (e.g., StackOverflow, ChatGPT, or other LLMs) to help with coding, but should explicitly acknowledge sources whenever this is the case. Students should make sure that the code is correct, rather than blindly trusting these services.\nGrading: students should submit assigned homework by the beginning of the following class. Incomplete or late homework will be assigned zero points. The homework can be amended and resubmitted, as long as the original submission was complete, turned-in in time, and displayed solid effort. The grade is amended accordingly.\n\n\nMathematical background\nFollowing the material requires basic notions in calculus, linear algebra and dynamical systems. Students should be familiar with:\n\nFunctions, exponential function, logarithm\nLimits\nDerivatives and chain rule\nIntegration of functions in one and several variables\n\nThese concepts will be briefly reviewed in class; students who feel they will need to work on these at their own pace are encouraged to approach them before class:\n\nTaylor series\nVectors, dot product, cross product\nMatrix product, transpose, determinant, eigenvalue decomposition\nPositive and negative definiteness of a matrix\n\nThese are good websites offering a brief review of these materials, and cheat sheets reporting the main formulas:\n\nPaul’s Online Notes covering calculus I, II and III as well as dynamical systems; the cheat sheets are excellent.\nThe legendary Linear Algebra class by Gilbert Strang, who has written popular books on the subject, and taught legions of students at MIT.\nZiko Kolter has published a brief review of linear algebra concepts.\nLinear algebra in four pages by Ivan Savov.\nLinear algebra visualized by 3Blue1Brown.\nSteve Brunton’s (U. Washington) YouTube channel contains extremely well-done lectures on dynamical systems; for example, here are reviews of derivatives, Taylor series, simulating the logistic map, integrating ODEs in a computer."
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Lecture notes, Part 1: Population Dynamics",
    "section": "",
    "text": "The class is divided in two parts. The first part of the class deals with models for population dynamics. We are going to explore:\n\nModels for a single population\nModels for two populations\nModels for disease dynamics\nModels for many populations (if time allows)\n\n\n\nThe GitHub repository associated with the lecture notes contains the code used to generate the lecture notes, including all the figures and simulations. Crucially, the code depends on the following R packages:\n\nlibrary(tidyverse) # plotting, data organization\nlibrary(deSolve) # integrate differential equations\n\n\n\n\n\nWe write \\(x(t)\\) for the density of population \\(x\\) at time \\(t\\). In many cases, we will write simply \\(x\\), as the dependency on time is always assumed. For discrete-time models, we write \\(x_t\\) instead. Typically, \\(x(t)\\) is measured in either \\([\\text{mass}]/[\\text{area/volume}]\\) or \\([\\text{number of individuals}]/[\\text{area/volume}]\\)\nThe density of a population typically changes in time, and the change is modulated by several parameters. Unless specified, we use Greek letters for scalars, lower-case Latin letters for vectors, and upper-case Latin letters for matrices.\nOther useful notation:\n\n\\(i\\) is the imaginary unit, such that \\(i^2 = -1\\)\n\\(0_n\\) is a vector of zeros of lenght \\(n\\)\n\\(1_n\\) is a vector of ones of lenght \\(n\\)\n\\(I\\) is the identity matrix (i.e., a matrix with \\(1_n\\) on the diagonal, and zeros elsewhere)\n\\(D(a)\\) is a diagonal matrix with vector \\(a\\) on the diagonal\n\\(\\dfrac{d x(t)}{dt}\\) is sometimes written as \\(\\dfrac{d x}{dt}\\) or \\(\\dot{x}\\)"
  },
  {
    "objectID": "index.html#computing",
    "href": "index.html#computing",
    "title": "Lecture notes, Part 1: Population Dynamics",
    "section": "",
    "text": "The GitHub repository associated with the lecture notes contains the code used to generate the lecture notes, including all the figures and simulations. Crucially, the code depends on the following R packages:\n\nlibrary(tidyverse) # plotting, data organization\nlibrary(deSolve) # integrate differential equations"
  },
  {
    "objectID": "index.html#notation",
    "href": "index.html#notation",
    "title": "Lecture notes, Part 1: Population Dynamics",
    "section": "",
    "text": "We write \\(x(t)\\) for the density of population \\(x\\) at time \\(t\\). In many cases, we will write simply \\(x\\), as the dependency on time is always assumed. For discrete-time models, we write \\(x_t\\) instead. Typically, \\(x(t)\\) is measured in either \\([\\text{mass}]/[\\text{area/volume}]\\) or \\([\\text{number of individuals}]/[\\text{area/volume}]\\)\nThe density of a population typically changes in time, and the change is modulated by several parameters. Unless specified, we use Greek letters for scalars, lower-case Latin letters for vectors, and upper-case Latin letters for matrices.\nOther useful notation:\n\n\\(i\\) is the imaginary unit, such that \\(i^2 = -1\\)\n\\(0_n\\) is a vector of zeros of lenght \\(n\\)\n\\(1_n\\) is a vector of ones of lenght \\(n\\)\n\\(I\\) is the identity matrix (i.e., a matrix with \\(1_n\\) on the diagonal, and zeros elsewhere)\n\\(D(a)\\) is a diagonal matrix with vector \\(a\\) on the diagonal\n\\(\\dfrac{d x(t)}{dt}\\) is sometimes written as \\(\\dfrac{d x}{dt}\\) or \\(\\dot{x}\\)"
  },
  {
    "objectID": "ch1.html",
    "href": "ch1.html",
    "title": "Models for a single population",
    "section": "",
    "text": "Consider a population reproducing annually, with non-overlapping generations. Over its lifetime, each individual produces \\(\\rho\\) offspring, which form the next generation. Then, we can write:\n\\[\nx_{k+1} = \\rho x_k\n\\]\nwhere \\(x_k\\) is the number of individuals/area at generation \\(k\\). Naturally, we can iterate again, and find the population density at generation \\(k+2\\):\n\\[\nx_{k+2} = \\rho x_{k+1} = \\rho^2 x_{k}\n\\]\nand in general:\n\\[\nx_{n} = \\rho^n x_0\n\\]\nwhere \\(x_0\\) is the initial population size, and \\(n\\) is the number of generations since we started tracking the population. We assume \\(x_0 &gt; 0\\), and thus the population grows whenever \\(\\rho &gt; 1\\), declines whenever \\(\\rho &lt; 1\\), and is constant whenever \\(\\rho = 1\\). Armed with \\(x_0\\) and \\(\\rho\\), we can project the population forward in time for an arbitrary number of generations.\n\n\n\nTake the population density at time \\(t\\) and \\(t + \\Delta t\\); in the time interval \\(\\Delta t\\) the change in population density is \\(x(t + \\Delta t) - x(t)\\), and the average change per unit of time is \\((x(t + \\Delta t) - x(t))/\\Delta t\\). We can consider the limit in which the interval \\(\\Delta t\\) shrinks to zero:\n\\[\n\\lim_{\\Delta t \\to 0} \\dfrac{x(t + \\Delta t) - x(t)}{\\Delta t} = \\frac{dx(t)}{dt}\n\\]\nIn fact, this is exactly the definition of the derivative with respect to (w.r.t.) time of the function \\(x(t)\\). A great contribution of Newton and Leibniz was to recognize that many natural phenomena can be described by simple differential equations—even though the equations describing the rate of change \\(dx(t)/dt\\) are simple, the behavior of the solutions \\(x(t)\\) can be incredibly complex.\nIn ecology and evolutionary biology, one encounters two main types of differential equations:\n\nOrdinary differential equations (ODEs) describe the rate of change of a quantity (in our case, population densities, \\(x(t)\\)) as a function of an independent variable (in our case, the time \\(t\\)), and can contain functions of the quantity, and its derivatives. If only the first derivative (\\(dx(t)/dt\\)) is included, it is called a first-order ODE.\nPartial differential equations (PDEs) contain more than one independent variable (e.g., time and coordinates in space). Therefore, the quantity of interest is a multivariate function, such as \\(q(x,y,t)\\), denoting the density of a population at the coordinates \\(x,y\\) and time \\(t\\). The partial derivatives with respect to the independent variables are considered, hence the name.\n\nMany other types of differential equations (stochastic differential equations, SDEs; integro-differential equations, IDEs; etc.) are found in certain technical areas.\nIn this class, we will deal exclusively with ODEs of the form:\n\\[\n\\dfrac{dx(t)}{dt} = f(x(t))\n\\]\nwhere the function \\(f(x(t))\\) models different ecological phenomena influencing the growth and decline of populations. For example, take populations growing thanks to the per-capita birth rate \\(\\beta\\), and declining due to the death rate \\(\\delta\\):\n\\[\n\\dfrac{dx(t)}{dt} = \\beta x(t) - \\delta x(t) = (\\beta - \\delta) x(t) = \\rho\\, x(t)\n\\]\nhere the intrinsic growth rate \\(\\rho\\) represents the difference between birth and death rates. The parameter is taken to be independent of time, yielding an autonomous differential equation. An ODE is autonomous if it does not depend explicitly on the independent variable (in our case, time). I.e., if \\(dx/dt = f(x(t))\\) the system is autonomous, while \\(dx/dt = g(x(t),t)\\) is not.\n\n\n\n\n\n\nSeparation of variables\n\n\n\n\n\nA differential equation for \\(x(t)\\) is called separable, if it can be written as:\n\\[\n\\frac{dx(t)}{dt} = g(t)\\, h(x(t))\n\\]\nwhere \\(g(t)\\) is a function of \\(t\\), and \\(h(x(t))\\) a function of \\(x(t)\\). As long as \\(h(x(t)) \\neq 0\\), we can formally write:\n\\[\n\\frac{1}{h(x(t))} dx(t) = g(t)\\, dt\n\\]\nWe can now integrate both sides, obtaining\n\\[\n\\begin{aligned}\n\\int \\frac{1}{h(x(t))} dx(t) + \\mathcal c_1 &= \\int g(t)\\, dt + \\mathcal c_2\\\\\n\\int \\frac{1}{h(x(t))} dx(t) &= \\int g(t)\\, dt + \\mathcal c\n\\end{aligned}\n\\]\nwhere \\(\\mathcal c_1, \\mathcal c_2\\) and \\(\\mathcal c = \\mathcal c_2 - \\mathcal c_1\\) are constants of integration, whose value can be set by considering the initial conditions.\nExample\nConsider:\n\\[\n\\frac{dx(t)}{dt} = \\alpha\n\\]\nwith initial condition \\(x(0) = x_0\\). Separate the variables and integrate:\n\\[\n\\begin{aligned}\nd x(t) &= \\alpha\\, dt\\\\\n\\int d x(t) &= \\alpha \\int dt + \\mathcal c\\\\\nx(t) &= \\alpha t + \\mathcal c\n\\end{aligned}\n\\]\nNow substitute the initial condition:\n\\[\nx(0) = x_0 = \\alpha 0 + c  = c\n\\]\nYielding the solution:\n\\[\nx(t) = x_0 + \\alpha t\n\\]\nA solution of an initial-value problem is an equation which, given the values of the parameters (\\(\\alpha\\), in this case) and the initial conditions (\\(x_0\\), in this case), allows us to determine the value of the dependent variable (\\(x(t)\\)) for any value of the independent variable (\\(t\\)). Only relatively simple ODEs or systems of ODEs can be solved explicitly.\n\n\n\nWe can solve the differential equation:\n\\[\n\\begin{aligned}\n\\dfrac{dx}{dt} &= \\rho\\, x\\\\\n\\dfrac{1}{x}\\,dx &= \\rho\\, dt\n\\end{aligned}\n\\]\nIntegrate both sides\n\\[\n\\begin{aligned}\n\\int \\dfrac{1}{x}\\,dx &= \\int \\rho\\, dt\\\\\n\\log x &= \\rho\\, t + \\mathcal c\\\\\nx &= e^{\\rho\\, t  + \\mathcal c}\\\\\nx &= e^{\\rho\\, t} e^{\\mathcal c}\\\\\n\\end{aligned}\n\\]\nwhere \\(\\mathcal c\\) is a constant of integration. Then, we can plug in the initial condition: at \\(t=0\\), the population is at density \\(x_0\\):\n\\[\n\\begin{aligned}\nx_0 &= e^{\\rho\\, 0}e^{\\mathcal c}\\\\\nx_0 &= e^{\\mathcal c}\n\\end{aligned}\n\\]\nWe obtain the solution:\n\\[\nx(t) = x(0) e^{\\rho\\, t}\n\\]\n\n\n\n\n\n\nIntegrating differential equations numerically\n\n\n\n\n\nYou can compute \\(x(t)\\) for any differential equation (or system of differential equations) in R using numerical techniques. Your code needs to include two parts:\nFirst, we write a function defining the (system of) ODE(s). This function takes three arguments: t, the time, x, the state of the system, and parms, a list of parameters, and returns a list containing \\(dx/dt\\). For the exponential growth, we can write:\n\nexponential_growth &lt;- function(t, x, parms){\n  dxdt &lt;- x * parms$rho\n  return(list(dxdt))\n}\n\nBecause ecological models only make sense for positive population densities, we can set an arbitrarily small threshold, and consider the population extinct if it falls below the threshold:\n\nTHRESH &lt;- 10^-10\n\nexponential_growth &lt;- function(t, x, parms){\n  if(x &lt; THRESH) x &lt;- 0\n  dxdt &lt;- x * parms$rho\n  return(list(dxdt))\n}\n\nThe second part of the code invokes the numerical integration function ode. For this function, we need to set a) initial conditions, b) determine at which times do we want to observe the state of the population, c) specify the name of the function to use, d) the parameters to use, and e) (optional) specify the method to use for the integration. The function ode is part of the package deSolve:\n\nx0 &lt;- 1 # initial conditions\nmy_time &lt;- seq(0, 5, by = 0.1) # we will observe the system at these times\nparms &lt;- list(rho = 1.05) # list of parameters\noutput &lt;- ode(y = x0, # a) initial conditions\n             times = my_time,  # b) time at which we observe the system\n             func = exponential_growth, # c) function computing r.h.s. of ODEs\n             parms = parms, # d) parameters of ODEs\n             method = \"ode45\") # e) more on this later; this is a good general-purpose choice\n\nThe output is a matrix of class deSolve, containing the time in the first column, and the values of \\(x(t)\\) in the second. For plotting, it is best to convert this into a data frame:\n\noutput %&gt;% \n  as.data.frame() %&gt;% \n  ggplot() + aes(x = time, y = `1`) + \n  geom_point() + \n  geom_line() + \n  xlab(\"t\") + \n  ylab(expression(x(t))) + \n  theme_bw()\n\n\n\n\n\n\n\n\n\nHow long will it take for a growing population (\\(\\rho &gt; 0\\)) to double in density? We are looking for \\(\\tau\\) such that \\[\n\\begin{aligned}\nx(\\tau) &= 2 x_0\\\\\nx_0 e^{\\rho \\tau} &= 2 x_0\\\\\ne^{\\rho \\tau} &= 2\\\\\n\\rho \\tau &= \\log 2\\\\\n\\tau &= \\dfrac{\\log 2}{\\rho}\n\\end{aligned}\n\\]\nThus, the doubling time does not depend on the initial condition: the population will keep doubling every \\(\\log 2 / \\rho\\) units of time. For example, take \\(\\rho = 0.01\\), then \\(\\tau \\approx 30\\): a population growing exponentially with rate of 1% per year will double every 30 years or so. Then, a growth of 3% yields a doubling time of 10 years, etc.\n\n\n\n\n\n\nExercise: Radiocarbon dating\n\n\n\n\n\nWhile at the University of Chicago, Willard Libby (Nobel Laureate in Chemistry, 1960) pioneered radiocarbon dating. The carbon isotope \\({}^{14}\\)C is constantly being created in the Earth’s atmosphere by the interaction of cosmic rays with atmospheric nitrogen. The carbon combines with oxygen, to form CO\\({}_2\\) that is then absorbed by plants. When plants die, the isotope decays in their tissues. Radioactive decay follows the exponential model:\n\\[\nN(t) =  N(0)e^{\\lambda t}\n\\]\nwhere \\(\\lambda &lt; 0\\) is the decay rate of the isotope. The half-life of a radioisotope is the time it takes to be reduced to half of the original concentration, and is 5,730 years for \\({}^{14}\\)C.\n\nFind the value of \\(\\lambda\\) for \\({}^{14}\\)C given its half-life\nExpress \\(t\\) as a function of \\(\\lambda\\), and the ratio between \\(N(t)\\) and \\(N(0)\\)\nThe concentration in the atmosphere is about 1 atom of \\({}^{14}\\)C for every \\(10^{12}\\) atoms of carbon. You have a collected sample that contains \\(1/16\\) atoms of \\({}^{14}\\)C for every \\(10^{12}\\) atoms of carbon; date the sample.\n\n\n\n\n\n\n\n\nWe have a population that grows exponentially when at very low density, but experiences a slow down in growth when densities are higher. The logistic growth equation is typically written as:\n\\[\n\\frac{d X}{d \\tau} = X\\left(\\rho - \\alpha X\\right)\n\\]\nwhere \\(\\rho&gt;0\\) is the intrinsic growth rate of the population, and \\(\\alpha&gt;0\\) is a parameter that regulates the amount by which growth is decreased as \\(X\\) increases.\nAn equilibrium (steady-state, fixed point) of a differential equation is a value of the dependent variable (\\(X(t)\\)) that makes the right-hand side of the equation zero. We denote an equilibrium as \\(X^\\star\\). We can write:\n\\[\n\\left.\\dfrac{dX}{d\\tau}\\right|_{X^\\star} = 0\n\\]\ni.e., the differential equation, evaluated at the point \\(X^\\star\\) is zero: the population will not grow nor decline, but rather will remain at \\(X^\\star\\). The logistic equation has two equilibria: \\(X^\\star=0\\) (absence of the population), and \\(\\rho = \\alpha X^\\star\\), \\(X^\\star = \\rho / \\alpha = \\kappa\\), called the carrying capacity of the population.\n\n\n\n\n\n\nChain rule\n\n\n\n\n\nThis is one of the most useful formulas from calculus. It relates the derivative of the composition of two differentiable functions with the derivatives of the functions. If \\(h(x) = g(u)\\) and \\(u = f(x)\\), then:\n\\[\n\\dfrac{dh}{dx} = \\dfrac{dg}{du}\\dfrac{du}{dx}\n\\]\nAs put by George Simmons [Calculus with Analytic Geometry (1985)]: If a car travels twice as fast as a bicycle and the bicycle is four times as fast as a walking man, then the car travels 2 × 4 = 8 times as fast as the man.\nExample\nTake\n\\[\n\\dfrac{dx(t)}{dt} = x(t) f(x(t))\n\\]\nand write the ODE describing \\(d \\log x(t) /dt\\). We can write this function as the derivative of the composition \\(\\log x(t) = \\log u\\) and \\(u = x(t)\\). Then, by chain rule:\n\\[\n\\begin{aligned}\n\\dfrac{d \\log x(t)}{dt} &= \\dfrac{d \\log u}{du} \\dfrac{du}{dt}\\\\\n&= \\dfrac{1}{u} \\dfrac{du}{dt}\\\\\n&= \\dfrac{1}{x(t)} \\dfrac{d x(t)}{dt}\\\\\n&= \\dfrac{1}{x(t)}  x(t) f(x(t))\\\\\n&= f(x(t))\n\\end{aligned}\n\\]\nshowing that the per-capita rate of change:\n\\[\n\\dfrac{1}{x(t)} \\dfrac{dx(t)}{dt} = \\dfrac{\\log x(t)}{dt}\n\\]\nis the derivative in time of the logarithm of the density of the population.\n\n\n\nWe can simplify the analysis of the differential equation by rescaling all the variables by positive quantities, thus obtaining a simpler form that retains the behavior of the original equation.\n\n\n\n\n\n\nNondimensionalization\n\n\n\n\n\nEcological models can have many parameters, and the goal of nondimensionalization is to rewrite the equations using as few parameters as possible, via a change of variables. Importantly, the new system and the original one are equivalent, and share the same dynamics. In fact, the trajectories of the original system can be reconstructed from those of the simpler system by inverting the transformation.\nTo perform nondimensionalization:\n\nidentify all the variables that depend on time (\\(X(\\tau)\\), \\(Y(\\tau)\\), etc.), as well as the independent variable (the time, \\(\\tau\\))\nreplace each of them by a scaled version: \\(X = c_x x\\), \\(Y = c_y y\\), \\(\\tau = c_t t\\), in which \\(c_i\\) are positive constants to be determined, and rewrite the equations for the new variables\nchoose the values for the constants to eliminate as many parameters as possible. Generally, one should be able to remove one parameter for each dependent variable, plus one parameter by scaling the time.\n\nExample\nThe exponential growth equation has a single parameter:\n\\[\n\\frac{dx}{d\\tau} = \\rho x\n\\]\none can define \\(\\tau = c_1\\,t\\). But then \\(\\dfrac{d \\tau}{d t} = c_1\\) and thus \\(d \\tau = c_1\\, dt\\). We substitute this value, obtaining:\n\\[\n\\begin{aligned}\n\\frac{1}{c_1}\\frac{dx}{dt} &= \\rho x\\\\\n\\frac{dx}{dt} &= c_1 \\rho x\\\\\n\\frac{dx}{dt} &= x\n\\end{aligned}\n\\]\nwhere we have chosen \\(c_1 = 1/\\rho\\).\n\n\n\nWe rewrite the equation for the logistic growth by choosing \\(X = c_1\\, x\\) and \\(\\tau = c_2\\, t\\). Our equations become (use the chain rule):\n\\[\n\\begin{aligned}\n\\dfrac{c_1}{c_2}\\dfrac{dx}{dt} &= c_1 x (\\rho - \\alpha c_1 x)\\\\\n\\dfrac{dx}{dt} &= x (\\rho c_2 - \\alpha c_1 c_2 x)\\\\\n\\end{aligned}\n\\]\nWe choose \\(c_2 = 1/\\rho\\) to make the first coefficient in parenthesis be equal to 1; then, we choose \\(c_1 = \\rho/\\alpha\\) to make the second coefficient be 1:\n\\[\n\\dfrac{dx}{dt} = x (1 - x)\n\\]\nNote that, in practice, we have chosen to rescale the variables using the intrinsic growth rate, \\(t = \\tau / \\rho\\), and the carrying capacity, \\(x = X \\alpha / \\rho = X / \\kappa\\).\nThe logistic equation can be solved, because it is separable:\n\\[\n\\begin{aligned}\n\\dfrac{1}{x(1-x)} dx &= dt\\\\\n\\left(\\dfrac{1}{x}-\\dfrac{1}{x-1}\\right)dx &= dt\\\\\n\\int \\dfrac{1}{x} dx - \\int \\dfrac{1}{1-x} dx &= \\int dt + \\mathcal c\\\\\n\\log x - \\log(x-1)&= t + c\\\\\n\\log \\dfrac{x}{x-1}&= t + c\\\\\n\\dfrac{x}{x-1} &= e^t e^c\\\\\nx &= \\dfrac{e^t e^c}{e^t e^c - 1}\\\\\nx &= \\dfrac{1}{1 - e^{-t}e^{-c}}\n\\end{aligned}\n\\]\nPlugging in \\(x_0\\) when \\(t=0\\), we find the value for the constant of proportionality:\n\\[\n\\begin{aligned}\nx_0 &= \\frac{e^c}{e^c - 1}\\\\\ne^c &= \\frac{x_0}{x_0 - 1}\n\\end{aligned}\n\\]\nYielding the solution\n\\[\nx(t) = \\dfrac{x_0 e^t}{1 + (e^t - 1)x_0}\n\\]\n\n\n\nAs shown for the logistic growth, solving ODEs can be very hard, and for most equations found in ecology a closed-form solution cannot be found. Moreover, even when we can solve the equations, the solution might be difficult to interpret or overly complex. Important information on the behavior of the system can be found by performing a qualitative analysis of the system. Here we concentrate on the location of equilibria, and their stability.\n\n\nFor any first-order ODE with a single dependent variable, one can understand the behavior of the system by simply plotting \\(dx(t)/dt\\) (y-axis) vs \\(x(t)\\) (x-axis). For example, for the logistic model:\n\\[\n\\dfrac{dx}{dt} = x(1-x)\n\\]\n\n\n\n\n\nShowing that there are two equilibria (\\(x^\\star =0\\), and \\(x^\\star = 1\\)), corresponding to the points where the curve \\(dx/dt\\) intercepts the x-axis. The function \\(dx/dt\\) is positive whenever \\(0&lt;x&lt;1\\), and is negative when \\(x&gt;1\\). Thus, the population will grow in time when \\(0&lt;x&lt;1\\), eventually reaching \\(x^\\star = 1\\); similarly, if we start the population at a density that is larger than the equilibrium, it will decline, again eventually reaching \\(x^\\star = 1\\). We therefore say that \\(x^\\star = 1\\) is asymptotically stable.\n\n\n\n\n\n\nAsymptotic stability\n\n\n\n\n\nThere are two useful notions of equilibrium stability for dynamical systems. We state them informally; you can find a more rigorous definition in any book on dynamical systems.\nLyapunov stability For a given dynamical system \\(dx(t)/dt\\), \\(x^\\star\\) is Lyapunov stable if trajectories starting close to \\(x^\\star\\) remain close to it, indefinitely. More formally, we define a neighborhood of \\(x^\\star\\), \\(\\| x(0) - x^\\star\\| &lt; \\delta\\); then \\(x^\\star\\) is Lyapunov stable if \\(\\| x(t) - x^\\star\\| &lt; \\epsilon\\) for every \\(t\\), where \\(\\epsilon &gt; 0\\).\nAsymptotic stability An equilibrium is asymptotically stable if it is Lyapunov stable, and trajectories eventually converge to \\(x^\\star\\): \\(x^\\star\\) is asymptotically stable if there exist a neighborhood \\(\\| x(0) - x^\\star\\| &lt; \\delta\\) such that \\(\\lim_{t\\to\\infty}\\| x(t) - x^\\star\\| = 0\\).\n\n\n\nThe logistic model assumes that the per capita growth rate is higher at low densities. This assumption may not be realistic for all species: when the density is low, for example, it can be more difficult to find a partner and defend against predators. This phenomenon of lower per capita growth rates at low densities, and higher per capita growth at high densities—which can also be called positive density-dependence—is known as the Allee effect. It is named after Warder Clyde Allee (1885-1955), who received his PhD from the University of Chicago and was later a professor and chair of Zoology. We could model this effect with the following equation:\n\\[\n\\dfrac{dX}{dt} = X\\left(\\dfrac{u X}{v + X} - c X \\right) = X^2 \\left(\\dfrac{u}{v + X} - c  \\right)\n\\]\nwhere \\(c\\) is the density-dependent death rate. Assume that all parameters are positive; then, besides the trivial equilibrium \\(X^\\star =0\\), we have a positive equilibrium \\(X^\\star = \\frac{u}{c} - v &gt; 0\\).\n\n\n\n\n\nThe graphical method allows to classify all equilibria according to their stability in a straightforward manner. Here’s an example with many equilibria:\n\n\n\n\n\n\n\n\n\n\n\nExercise: Strong Allee effect\n\n\n\n\n\nA stronger version of the Allee effect can be modeled as:\n\\[\n\\dfrac{dX}{dt} = X (X - \\gamma)(\\kappa - X)\n\\]\nwith \\(0&lt;\\gamma &lt; \\kappa\\).\n\nInterpret the parameters\nPlot \\(dX/dt\\) vs \\(X\\), and identify all equilibria\nClassify the equilibria according to their stability\n\n\n\n\n\n\n\nYou might have noticed that, when performing the graphical analysis above, and equilibrium is stable if \\(dx/dt\\) has a negative slope at \\(x^\\star\\). Here we formalize this notion, by considering small perturbations of the system resting at an equilibrium.\n\nTake an ODE \\(dx/dt = f(x)\\)\nThe system is resting at an equilibrium \\(x^\\star\\)\nWe perturb the system, and track the dynamics when starting at \\(x(0) = x^\\star + \\epsilon\\), where \\(\\epsilon\\) (the perturbation) is taken to be sufficiently small \\(\\| \\epsilon \\| \\ll 1\\)\nWe write \\(\\Delta x(0) = x(0) - x^\\star\\)\nWe derive the dynamics for \\(\\Delta x\\):\n\nBy chain rule,\n\\[\n\\begin{aligned}\n\\dfrac{d \\Delta x}{dt} &= \\dfrac{d \\Delta x}{dx} \\dfrac{d x}{dt} \\\\\n&= 1 \\dfrac{d x}{dt}\\\\\n&= f(x)\\\\\n&= f(\\Delta x + x^\\star)\n\\end{aligned}\n\\] Where we have substituted \\(x = \\Delta x + x^\\star\\).\n\nNow we approximate the function \\(f(\\Delta x + x^\\star)\\) by Talyor expanding.\n\n\n\n\n\n\n\nTaylor series\n\n\n\n\n\nWe can approximate the behavior of a (infinitely differentiable) function in the vicinity of a point \\(a\\) by a power series:\n\\[\nf(x) = f(a) + \\dfrac{1}{1!} \\left. \\dfrac{df(x)}{dx} \\right|_a (x-a)+ \\dfrac{1}{2!} \\left. \\dfrac{d^2f(x)}{dx^2} \\right|_a (x-a)^2+ \\dfrac{1}{3!} \\left. \\dfrac{d^3f(x)}{dx^3} \\right|_a (x-a)^3 + \\ldots\n\\] where \\(n! = n (n-1)(n-2)\\ldots 1\\) is the factorial function and the derivatives are evaluated at \\(a\\). When we choose \\(a=0\\) this is called the Maclaurin series.\nExample\nExpand \\(e^x\\) around \\(0\\):\n\\[\n\\begin{aligned}\ne^x &= e^0 + \\left. e^x\\right|_0 x + \\frac{1}{2}\\left. e^x\\right|_0 x^2  + \\frac{1}{6}\\left. e^x\\right|_0 x^3 + \\ldots\\\\\n&=1 + x + \\frac{1}{2} x^2  + \\frac{1}{6}x^3 + \\ldots\\\\\n&=\\sum_{k=0}^\\infty \\frac{x^k}{k!}\n\\end{aligned}\n\\]\n\n\n\nWe want to Taylor-expand \\(f(x) = f(\\Delta x + x^\\star)\\) around \\(x^\\star\\):\n\\[\nf(x) = f(x^\\star) + \\left.\\dfrac{d f(x)}{d x}\\right|_{x^\\star} (x - x^\\star) + \\dfrac{1}{2}\\left.\\dfrac{d^2 f(x)}{d x^2}\\right|_{x^\\star} (x - x^\\star)^2 + \\ldots\n\\] Note that \\(f(x^\\star) = 0\\) by the definition of an equilibrium. If the deviation is small, we can neglect all the higher-order terms, obtaining:\n\\[\n\\dfrac{d \\Delta x}{dt} = f(x) \\approx \\left.\\dfrac{d f(x)}{d x}\\right|_{x^\\star} \\Delta x\n\\]\nwhich is the equation of the exponential growth model, with \\(\\rho = \\left.\\dfrac{d f(x)}{d x}\\right|_{x^\\star}\\). Then, the solution is \\(\\Delta x(t) = \\Delta x(0) e^{\\rho t}\\), and the deviation from the equilibrium goes to zero (i.e., the system goes back to \\(x^\\star\\)) whenever \\(\\rho &lt; 0\\).\nFor example, take the logistic growth model and evaluate the stability of \\(x^\\star = 1\\); we have:\n\\[\n\\left.\\dfrac{d f(x)}{d x}\\right|_{x^\\star} = \\left.\\dfrac{d (x - x^2)}{d x}\\right|_{x^\\star} = \\left.(1 - 2x)\\right|_{x^\\star} = -1\n\\]\nand thus the equilibrium is locally asymptotically stable. Locally, because we have considered very small deviations from the equilibrium, and asymptotic because convergence only happens eventually.\n\n\n\n\n\n\nExercise: Stability of equilibria for strong Allee effect\n\n\n\n\n\nTake the function for the Allee effect in the previous exercise:\n\\[\n\\dfrac{dX}{dt} = X (X - \\gamma)(\\kappa - X)\n\\]\nUse local stability analysis to show that the system has three equilibria, of which two are locally stable.\n\n\n\n\n\n\n\n\n\nExercise: Stability of model with weak Allee effect\n\n\n\n\n\nNow analyze the stability of the model with weak Allee effects:\n\\[\n\\dfrac{dX}{dt} = X^2 \\left(\\dfrac{u}{v + X} - c  \\right)\n\\]\nAssuming that \\(u/c &gt; v\\). You will find that the analysis of the equilibrium \\(X^\\star = 0\\) is inconclusive; expand the function \\(d\\Delta X/dt\\) to include higher-order terms to determine the stability of the equilibrium.\n\n\n\n\n\n\n\n\n\nExercise: Levins’ metapopulation model\n\n\n\n\n\nIn 1969, when he was a professor at the University of Chicago, Richard Levins proposed a model for metapopulation dynamics. The idea is that in a landscape there are numerous patches of suitable habitat that can be colonized by a given species. Each population in a patch undergoes extinction with a certain rate, and can colonize other patches by sending propagules to them. Because there are many patches, we track the proportion of occupied patches \\(0 \\leq p(t) \\leq 1\\); the proportion of empty patches is therefore \\(1 - p(t)\\). If individuals disperse to a random patch when leaving an occupied patch, the rate of colonization will be proportional to the product \\(\\gamma\\, p(t)(1-p(t))\\) (i.e., \\(\\gamma\\, p(t)\\) is the rate at which propagules are produced, and \\(1-p(t)\\) is the rate at which they land on an empty patch). The rate at which patches are vacated, the extinction rate, is \\(\\delta\\). The model can be written as:\n\\[\n\\dfrac{d p(t)}{dt} = \\gamma\\,p(t)(1 - p(t)) - \\delta\\, p(t)\n\\]\n\nFind the equilibria\nDetermine their stability\nShow that the equation is equivalent to that for the logitstic growth\n\n\n\n\n\n\n\nIn certain models, we can show that whenever the population starts at a positive value, it will always reach a certain equilibrium \\(x^\\star\\). In this case, we say the equilibrium is globally asymptotically stable.\nBecause as we said solving differential equations is in general very difficult, and in many cases of interest impossible, we employ a proxy function, called a Lyapunov function.\n\n\n\n\n\n\nLyapunov functions\n\n\n\n\n\nWe want to prove that all trajectories originating at \\(x(0) &gt; 0\\) eventually converge to \\(x^\\star\\). If we can find a function \\(V\\) such that:\n\n\\(V(x(t)) \\geq 0\\) for all \\(x(t) &gt; 0\\)\n\\(V(x(t)) = 0\\) if and only if \\(x(t) = x^\\star\\)\n\\(\\dfrac{d V(x(t))}{dt} \\leq 0\\) for all \\(t\\) and\n\\(\\dfrac{d V(x(t))}{dt} = 0\\) if and only if \\(x(t) = x^\\star\\)\n\nthen \\(x^\\star\\) is globally asymptotically stable: all trajectories starting at a positive point will converge to it.\nThe logic of this procedure is to identify a suitable function \\(V\\) that is positive everywhere but at the equilibrium, and is constantly declining in time; then necessarily the function will eventually reach zero, which is attained only at equilibrium.\nExample\n\\(V(x(t)) = (x(t) - x^\\star)^2\\) is a Lyapunov function that can be used to prove that the logistic growth model \\(dx/dt = x(1-x)\\) has an equilibrium \\(x^\\star = 1\\) that is globally asymptotically stable.\n\n\\(V(x(t))\\) is always nonnegative, and is zero only at \\(x(t) = x^\\star = 1\\)\nThe derivative of \\(V(x(t))\\) w.r.t. time is:\n\n\\[\n\\begin{aligned}\n\\dfrac{dV(t)}{dt} &= \\dfrac{dV(t)}{dx(t)}\\dfrac{dx(t)}{dt}\\\\\n&= 2(x(t) - x^\\star)\\dfrac{dx(t)}{dt}\\\\\n&=-2(x(t)-1) x(t)(x(t)-1)\\\\\n&=-2 x(t) (x(t)-1)^2 \\leq 0\n\\end{aligned}\n\\]\n\n\n\n\n\n\n\n\n\nExercise: Global stability of logistic growth\n\n\n\n\n\nShow that \\(V(x(t)) = x(t) - 1 - \\log x(t)\\) is a Lyapunov function that can be used to prove the global stability of \\(x^\\star = 1\\) for the logistic growth model \\(dx/dt = x(1-x)\\).\n\nProve that \\(V \\geq 0\\), with equality only at equilibrium\nProve that \\(dV/dt \\leq 0\\), with equality only at equilibrium\n\n\n\n\n\n\n\nAutonomous, first-order ODE models with a single variable can have only two types of behavior: a) \\(x(t)\\) eventually reaches a fixed point and remains there; b) \\(x(t)\\) goes to \\(\\pm \\infty\\). This is a consequence of an important mathematical fact: if \\(dx(t)/dt = f(x(t))\\) and the function \\(f(x(t))\\) is “smooth” (e.g., continuously differentiable) then the solution for the ODE exists and is unique. This means that the equation can cross each point \\(x(t) = \\alpha\\) only once, or infinitely many times. In contrast, discrete models with a single variable can have very interesting behavior.\n\n\n\n\nWe have so far analyzed models where the growth of a population is described by an ordinary differential equation. However, for particular situations, and especially for species with nonoverlapping generations, a discrete-time approach would be more suitable.\n\n\nTo understand whether a discrete model is stable, we analyze the plot of \\(x_{t+1}\\) against \\(x_t\\), superimposed on the diagonal (\\(x_{t+1}=x_{t}\\)). We use these two curves to “cobweb”:\n\nStarting from an initial condition \\(x_t=x(0)\\) (some point on the x-axis), we draw a line to the model’s projection of the population at the next time step (\\(x_{t+1}\\))\nWe then set \\(x_t=x_{t+1}\\) to obtain the population in the next time step. To speed the process along, rather than lifting our pencils to draw \\(x_{t+1}\\) at \\(x_t\\) on the x-axis, we can simply draw a horizontal line from \\(x_{t+1}\\) back to the diagonal (which shows \\(x_{t+1}=x_t\\)) and then move vertically to get the next \\(x_{t+1}\\)\nWith enough iterations, this process reveals whether the population converges to a fixed point or does something more elaborate, and if this trajectory involves oscillations. Note that at a fixed point, \\(x_{t+1}=x_t=x^\\star\\).\n\nWe can use this approach for any map (discrete-time model) of \\(x_{t+1}\\) to \\(x_t\\), although cobwebbing suffers the disadvantage of requiring a lot of manual labor to explore the asymptotic behavior. To explore its uses further, we’ll consider one of the most basic and important density-dependent, discrete-time models: the logistic map.\n\n\n\nThis is a model with a very similar formulation to the logistic growth ODE above:\n\\[\nx_{t+1} = r\\, x_t (1 - x_t)\n\\]\nWith \\(x_t &gt; 0\\) and \\(r &gt; 0\\). When \\(x_t &gt; 1\\), the population will decline; therefore it makes sense to start the population at a value \\(0&lt;x_0&lt;1\\). For these values, the population might grow only if \\(r &gt; 1\\) (i.e., we want \\(x_{t+1} &gt; x_t\\) for growth).\nLet’s try our hand at cobwebbing: set \\(x_0 = 1/2\\) and \\(r = 3/2\\). The cobwebbing plot becomes:\n\n\n\n\n\nshowing that the population declines and then stops at an equilibrium. We can compute the equilibrium by setting \\(x_{t+1} = x_t = x^\\star\\):\n\\[\n\\begin{aligned}\nx^\\star &= r\\, x^\\star (1 - x^\\star)\\\\\n1 &= r\\, (1 - x^\\star)\\\\\nx^\\star &= 1 - \\frac{1}{r}\n\\end{aligned}\n\\]\nThus, a feasible (positive) equilibrium is found only for \\(r &gt; 1\\), as expected. In the example above, the equilibrium is reached without oscillations. Let’s try the cobweb for a larger \\(r = 5/2\\)\n\n\n\n\n\nNow the solution \\(x^\\star = 1 - \\frac{2}{5} = \\frac{3}{5}\\) is reached after oscillating above and below this value.\n\n\n\nWe want to determine whether \\(x^\\star\\) is stable for a given map (discrete-time model) \\(x_{t+1} = f(x_t)\\), with \\(f(x^\\star)=x^\\star\\). In particular, we want to determine whether when we initialize the system close to \\(x^\\star\\) we converge back to \\(x^\\star\\).\nTake \\(x_t = x^\\star + \\epsilon_t\\), where \\(\\epsilon_t\\) is small. Then we have\n\\[\n\\begin{aligned}\nx_{t+1} &= f(x_t)\\\\\nx^\\star + \\epsilon_{t+1} &= f(x^\\star + \\epsilon_t)\\\\\nx^\\star + \\epsilon_{t+1} &\\approx f(x^\\star) + \\left. \\dfrac{d f(x_t)}{dx_t}\\right|_{x^\\star} (x_t - x^\\star) \\\\\nx^\\star + \\epsilon_{t+1} &\\approx x^\\star + \\left. \\dfrac{d f(x_t)}{dx_t}\\right|_{x^\\star} \\epsilon_t\\\\\n\\epsilon_{t+1} &\\approx \\left. \\dfrac{d f(x_t)}{dx_t}\\right|_{x^\\star} \\epsilon_t\\\\\n\\end{aligned}\n\\]\nwhich is the very first model we have written. We have:\n\\[\n\\epsilon_{t+k} = \\rho^{k} \\epsilon_t\n\\]\nwith \\(\\rho = \\left. \\dfrac{d f(x_t)}{dx_t}\\right|_{x^\\star}\\). We have that\n\\[\n\\lim_{k \\to \\infty} \\epsilon_{t+k} = 0 \\quad \\text{if} \\, |\\rho| &lt; 1\n\\]\nThus, the equilibrium is stable if and only if the absolute value of \\(\\left. \\dfrac{d f(x_t)}{dx_t}\\right|_{x^\\star}\\) is less than 1. If this value is greater than 1, then the equilibrium is unstable: small perturbations will amplify (at least initially); if the value is exactly 1, the analysis is inconclusive, and we might want to consider including higher-order terms in the Taylor expansion above.\nExample\nTake \\(r = 2\\), and show that the equilibrium \\(x^\\star = 1/2\\) is stable. We take the derivative:\n\\[\n\\rho = \\left.\\dfrac{d f(x_t)}{d x_t} \\right|_{x^\\star} = r \\left. \\dfrac{d (x_t (1- x_t))}{d x_t}\\right|_{x^\\star} = \\left. r (1 - 2 x_t)\\right|_{x^\\star}\n\\]\nand substitute the values of \\(r\\) and \\(x_t = x^\\star = 1/2\\). We obtain \\(\\rho = 0\\) and thus the equilibrium is stable. In fact, we see that, for any value of \\(r &gt; 0\\) leading to a feasible equilibrium, we have:\n\\[\n\\rho = r \\left(1 - 2 \\left(1 - \\frac{1}{r} \\right) \\right) = 2 - r\n\\]\nand thus whenever \\(|2 - r| &lt; 1\\) we have a stable equilibrium. This is true whenever \\(3&gt; r &gt;1\\).\n\n\n\nIf we make \\(r\\) even larger, we find new behavior. For example, take \\(r = 10/3\\), \\(x_0 = 3/4\\)\n\n\n\n\n\nAfter a few oscillations, the system sets into a cycle, alternating between two values. This is best seen by plotting a time-series, in which we have the (discrete) time in the x-axis, and the value \\(x_t\\) on the y-axis:\n\n\n\n\n\nWhat are the two values? To find them, we can set \\(x_{t+2} = x_{t}\\) making sure that \\(x_{t+1} \\neq x_t\\). Take:\n\\[\n\\begin{aligned}\nx_{t+2} &= x_t\\\\\nf(x_{t+1}) &= x_t\\\\\nf(f(x_t)) &= x_t\\\\\nf^{(2)}(x_t) &= x_t\n\\end{aligned}\n\\]\nFor the logistic map, we have:\n\\[\n\\begin{aligned}\nx_t &= r\\,x_{t+1}\\,(1 - x_{t+1})\\\\\n&= r\\, r\\, x_t (1 - x_t)\\, (1 -  r\\, x_t (1 - x_t))\\\\\n&= r^2 x_t (1-x_t) (1 -  r\\, x_t (1 - x_t))\n\\end{aligned}\n\\]\nWhen we discard the solution \\(x_t =0\\), we obtain the cubic polynomial:\n\\[\n-r^3 x_t^3+2 r^3 x_t^2-(r+1) r^2 x_t+r^2-1= 0\n\\]\nWe can factor out the solution \\(x_t = 1 - \\frac{1}{r}\\), which we know already, obtaining:\n\\[\n\\begin{aligned}\nr^3 x_t^2 - r^2 (1 + r) x_t + r (1 + r) &= 0\\\\\nr^2 x_t^2 - r (1 + r) x_t + (1 + r) &= 0\n\\end{aligned}\n\\]\nYielding:\n\\[\nx_c = \\dfrac{r +1 \\pm \\sqrt{(r-3) (r+1)}}{2 r}\n\\]\nBoth values are greater than zero whenever \\(r \\geq 3\\). We can investigate the stability of the cycle, we can take the derivative w.r.t. \\(x_t\\) of \\(f^{(2)}(x_t)\\), and plug in one of the two values above:\n\\[\n\\begin{aligned}\n\\rho &= \\left.\\dfrac{d f^{(2)}(x_t)}{d x_t} \\right|_{x_c}\\\\\n&= \\left. \\left(\\dfrac{d}{d x_t} r^2 x_t (1-x_t) (1 -  r\\, x_t (1 - x_t)) \\right)\\right|_{x_c}\\\\\n&= \\left. (r^2 (1 - 2 x_t)(1 - 2 r x_t(1-x_t))) \\right|_{x_c}\n\\end{aligned}\n\\]\nSubstituting the larger value of \\(x_c\\), we eventually find:\n\\[\n\\rho = 4 - r (r - 2)\n\\]\nThe period-2 cycle is stable whenever \\(|\\rho| &lt; 1\\). If we assume that \\(r \\geq 3\\) (required for the existence of the cycle in the first place), we have:\n\\[\n3 &lt; \\rho &lt; 1 + \\sqrt{6} \\approx 3.45\n\\]\nThe period-2 orbits are therefore stable in this range. What happens beyond this value of \\(r\\)? Take \\(r = 3.5\\) and cobweb:\n\n\n\n\n\nNow we have that the system oscillates between four values, as seen from the time-series (where we have removed the first 250 time steps for clarity):\n\n\n\n\n\nNow we have a period-4 solution, which is stable until \\(1 + \\sqrt{6} &lt; r &lt; 3.701\\), at which point we find period-8 cycles:\n\n\n\n\n\n\n\n\nThe system can yield cycles of period three. Take \\(r = 1 + 2 \\sqrt{2}\\), and plot the time series:\n\n\n\n\n\nA famous result (Sharkovsky’s theorem, Ukrainian Math J, 1964) states that if a map has cycles of period 3, then it must have cycles of every other period. Li and Yorke (“Period Three Implies Chaos”. Am. Math. Monthly, 1975) showed that indeed a period-three implies infinitely many trajectories that do not have a period, and oscillate without ever completing a cycle. We call this phenomenon chaos.\nChaos is aperiodic long-term behavior in a deterministic system that exhibits sensitive dependence to initial conditions. In particular, one can prove that in a chaotic regime, if we start with two initial conditions that are very close to each other (their distance being \\(\\Delta x_0\\)) we eventually find very different trajectories. In particular, when we have chaos:\n\\[\n|\\Delta x(t)| \\approx e^{\\lambda t}|\\Delta x_0|\n\\]\nwith \\(\\lambda&gt;0\\) (the Lyapunov exponent).\nTo show this behavior, let’s plot two trajectories for the system when \\(r = 3.675\\) and \\(x_0 = 0.5\\) or \\(x_0 = 0.4999\\):\n\n\n\n\n\n\n\n\nAll these results can be summarized in a beautiful graph. We build it as follows:\n\npick a value of \\(r\\)\nstarting from an arbitrary point, \\(x_0 = 1/2\\), compute \\(x_t\\) for a large number of points, and discard the first part of the time series (transient dynamics)\nlocate and record the minima and maxima of the time series\nplot \\(r\\) (x-axis) against the location of the minima and maxima (y-axis)\n\nIf the trajectories converge to an equilibrium, we will find a single point; if trajectories converge to a period-2 cycle, we will find two points; etc.\n\nlogistic_map_ts &lt;- function(r, max_time = 3000, discard = 2000){\n  ts &lt;- accumulate(.x = rep(1/2, max_time), .f = function(xt, xtp1) r * xt * (1-xt))[discard:max_time]\n  # discard points at which the trajectory repeats\n  difference &lt;- abs(ts - ts[1])\n  zz &lt;- which(difference &lt; 10^-6)\n  if(length(zz) &gt; 1) ts &lt;- ts[1:zz[2]]\n  return(tibble('x' = ts, 'r' = r))\n}\n# load results if available\nif (file.exists(\"data/logistic_bifurcation.RData\")){\n  load(\"data/logistic_bifurcation.RData\")\n} else {\n  # compute the results (this will take some time...)\n  bifurcation_logistic_map &lt;- map_df(.x = seq(2.95, 3.99, by = 0.001), \n                                     .f = logistic_map_ts)  \n  # and save the file\n  save(bifurcation_logistic_map, file = \"data/logistic_bifurcation.RData\")\n}\nggplot(bifurcation_logistic_map) + \n  aes(x = r, y = x) + \n  geom_point(size = 0.005, alpha = 0.2) + \n  theme_bw() + \n  xlab(expression(r)) + ylab(expression(x[t]))\n\n\n\n\n\n\n\n\n\n\nExercise: Ricker model\n\n\n\n\n\nThis period-doubling cascade to chaos is common to several models. Draw the bifurcation diagram for the Ricker model:\n\\[\nx_{t+1} = x_t e^{r(1-x_t)}\n\\]\nagain taking values of \\(r\\) between 1.95 and 4, and values of \\(x_0\\) between 0 and 1.\n\n\n\n\n\n\n\nSudden shifts in populations, such as sharp spikes and collapses (even extinctions), capture attention. Our intuition might be that such changes arise from exogenous influences, such as extreme weather events. One of the first powerful examples showing that sudden shifts can arise from gradual (arguably endogenous) changes comes from a model of the spruce budworm. The spruce budworm has huge outbreaks roughly every 40 years in North America. These dynamics were modeled by Ludwig, Jones, and Holling in 1978.\nThe change in the budworm population \\(B\\) can be described by \\[\n\\dfrac{dB}{d\\tau} = rB\\left(1-\\frac{B}{K}\\right)-b \\dfrac{B^2}{a^2 + B^2}\n\\] Predation in this model arises from birds, causing the mortality term. We can reduce the number of parameters by setting:\n\\[\nB = c_1 x \\quad \\tau = c_2 t\n\\]\nChoosing \\(c_1 = a\\), and \\(c_2 = a/b\\), we obtain:\n\\[\n\\dfrac{dx}{dt} = \\dfrac{a r}{b}x\\left(1 - \\dfrac{a}{K} x \\right) - \\dfrac{x^2}{1+x^2}\n\\]\nAnd defining \\(\\rho = a r / b\\) and \\(\\gamma = K/a\\), we finally have:\n\\[\n\\dfrac{dx}{dt} = \\rho x\\left(1 - \\dfrac{x}{\\gamma}  \\right)- \\dfrac{x^2}{1+x^2}\n\\]\nThe trivial equilibrium is \\(x^\\star = 0\\). Depending on the value of \\(\\gamma\\), we can have one, two or three equilibria at which:\n\\[\n\\rho \\left(1 - \\dfrac{x^\\star}{\\gamma}\\right) = \\dfrac{x^\\star}{1 + {x^\\star}^2}\n\\]\nBecause solving for the equilibria is involved, we can plot the l.h.s. and the r.h.s for different values of \\(\\rho\\) and \\(\\gamma\\).\n\n\n\n\n\nThe r.h.s. is the solid line, and the dashed lines represent different choices of r.h.s. when we vary the parameters \\(\\rho\\), \\(\\gamma\\). Depending on the choice of parameters, we can have a single equilibrium at which the spruce budworm is at low level (dotted line); two equilibria (dashed-dotted line), three equilibria (dashed line), and back to one equilibrium (long-dashed line).\nThe authors interpreted \\(\\rho\\) and \\(\\gamma\\) as “slow” parameters that relate to forest development. Keeping the x-intercept (\\(\\gamma\\)) fixed, and starting with a single (stable) positive equilibrium yiedling low values of \\(x\\); this is called a “refuge” in the literature. When we increase \\(\\rho\\), we transition to two positive equilibria (one stable, the other metastable), and then to three equilibria (with the first and the third that are stable); thus depending on the initial conditions, we can have a large or small population size. Finally, increasing \\(\\rho\\) even more takes us back to a single stable equilibrium with very high values of \\(x\\) (“outbreak”). The authors hypothesized that gradual shifts in forest conditions, effected mostly through \\(\\rho\\), could thus generate sudden outbreaks of the spruce budworm. We can recapitulate these behaviors by producing a bifurcation plot, in which we slowly vary \\(\\rho\\), and mark the equilibria and their stability.\n\n\n\n\n\nThis dynamic is an example of hysteresis. It shows that the position of \\(x\\) at a given (\\(\\rho\\), \\(\\gamma\\)) depends on the recent dynamics of the system. Hysteretic models have also been used to explain sudden shifts in nutrient loading in lakes (e.g., from eutrophic to oligotrophic). Hysteretic systems can get “stuck” in regimes (e.g., high \\(x\\)), and getting back to the starting point can require more than just reversing some parameter (like \\(\\gamma\\)) to its previous position.\n\n\n\n\n\n\nEuler’s method\n\n\n\n\n\nWhen we want to compute trajectories for a differential equations, we face the problem that typically the equations cannot be solved. Computers get around this issue by carefully computing the trajectory for a discrete-time model. The simplest case is that of Euler’s method.\nWe want to compute the solution of \\(dx(t)/dt = f(x(t))\\). For sufficiently small \\(\\Delta t\\), we can Taylor-expand \\(x(t_0 + \\Delta t)\\) around \\(t_0\\), obtaining:\n\\[\nx(t_0 + \\Delta t) \\approx x(t_0) + \\left. \\dfrac{d x(t)}{dt}\\right|_{t_0} \\Delta t\n\\]\nwe know the value of \\(x(t_0) = x_0\\), and the function \\(d x(t) / dt = f(x(t))\\), and as such:\n\\[\nx(t_0 + \\Delta t) \\approx x_0 + \\Delta t \\, f(x_0)\n\\]\nWe iterate this procedure again and again, drawing our trajectory. Naturally, taking smaller \\(\\Delta t\\) we should get better approximations, from a mathematical standpoint. In fact, one can show that the error we’re making is proportional to \\(\\Delta t\\). However, reducing \\(\\Delta t\\) has two undesirable effects: first, the calculation time will increase accordingly; second, because computers have limited precision when representing numbers, at each step we will make round off errors, and these will accumulate faster when the step size is small.\nIn practice, when we use Euler’s method we assume that \\(f(x)\\) is fixed during the step \\(\\Delta t\\) (which we now is generally not true). We can average across two points, yielding the so-called midpoint method:\n\\[\n\\begin{aligned}\ny_{t + \\Delta t} &= x_t + \\Delta_t f(x_t)\\\\\nx_{t + \\Delta t} &= x_t + \\frac{1}{2}(f(x_t) + f(y_{t + \\Delta t}))\n\\end{aligned}\n\\]\nwhere \\(y_{t + \\Delta t}\\) is what computed using Euler’s method, and the slope for the actual step is taken to be the average \\(f(x)\\) at the beginning and end of the step. One can show that the error is now proportional to \\((\\Delta t)^2\\), which is a good improvement.\nThe same logic applies when we take several intermediate steps, and average across them, as done for the Runge-Kutta methods.\nIn fact, the best software tries to pick small \\(\\Delta t\\) when \\(x(t)\\) is changing rapidly, and larger \\(\\Delta t\\) when \\(x(t)\\) is changing slowly. These adaptive-step methods are the state-of-the-art, and are implemented in the package deSolve in R.\n\n\n\n\n\n\nA brief paper discussing how to build models in biology:\n\nRichard Levins, 1966. The strategy of model building in population biology. American Scientist 54:421-431\n\nThis paper introduces the famous metapopulation model:\n\nRichard Levins, 1969. Some demographic and genetic consequences of environmental heterogeneity for biological control. Bull. Entomol. Soc. Am. 15:237–240.\n\nThis paper shows the onset of chaos in simple discrete-time models:\n\nRobert M. May, 1976. Simple mathematical models with very complicated dynamics. Nature 261:459-467\n\nThis paper discusses how simple models relates to experimental data on population growth:\n\nMichael P. Hassell, John H. Lawton, Robert M. May, 1976. Patterns of dynamical behavior in single species populations. Journal of Animal Ecology 45:471-486\n\nThe paper analyzing the dynamics of the spruce budworm:\n\nDonald Ludwig, D. D. Jones, Crawford S. Holling, 1978. Qualitative Analysis of Insect Outbreak Systems: The Spruce Budworm and Forest. Journal of Animal Ecology, 47:315-332"
  },
  {
    "objectID": "ch1.html#a-simple-model-for-non-overlapping-generations",
    "href": "ch1.html#a-simple-model-for-non-overlapping-generations",
    "title": "Models for a single population",
    "section": "",
    "text": "Consider a population reproducing annually, with non-overlapping generations. Over its lifetime, each individual produces \\(\\rho\\) offspring, which form the next generation. Then, we can write:\n\\[\nx_{k+1} = \\rho x_k\n\\]\nwhere \\(x_k\\) is the number of individuals/area at generation \\(k\\). Naturally, we can iterate again, and find the population density at generation \\(k+2\\):\n\\[\nx_{k+2} = \\rho x_{k+1} = \\rho^2 x_{k}\n\\]\nand in general:\n\\[\nx_{n} = \\rho^n x_0\n\\]\nwhere \\(x_0\\) is the initial population size, and \\(n\\) is the number of generations since we started tracking the population. We assume \\(x_0 &gt; 0\\), and thus the population grows whenever \\(\\rho &gt; 1\\), declines whenever \\(\\rho &lt; 1\\), and is constant whenever \\(\\rho = 1\\). Armed with \\(x_0\\) and \\(\\rho\\), we can project the population forward in time for an arbitrary number of generations."
  },
  {
    "objectID": "ch1.html#overlapping-generations-exponential-growth",
    "href": "ch1.html#overlapping-generations-exponential-growth",
    "title": "Models for a single population",
    "section": "",
    "text": "Take the population density at time \\(t\\) and \\(t + \\Delta t\\); in the time interval \\(\\Delta t\\) the change in population density is \\(x(t + \\Delta t) - x(t)\\), and the average change per unit of time is \\((x(t + \\Delta t) - x(t))/\\Delta t\\). We can consider the limit in which the interval \\(\\Delta t\\) shrinks to zero:\n\\[\n\\lim_{\\Delta t \\to 0} \\dfrac{x(t + \\Delta t) - x(t)}{\\Delta t} = \\frac{dx(t)}{dt}\n\\]\nIn fact, this is exactly the definition of the derivative with respect to (w.r.t.) time of the function \\(x(t)\\). A great contribution of Newton and Leibniz was to recognize that many natural phenomena can be described by simple differential equations—even though the equations describing the rate of change \\(dx(t)/dt\\) are simple, the behavior of the solutions \\(x(t)\\) can be incredibly complex.\nIn ecology and evolutionary biology, one encounters two main types of differential equations:\n\nOrdinary differential equations (ODEs) describe the rate of change of a quantity (in our case, population densities, \\(x(t)\\)) as a function of an independent variable (in our case, the time \\(t\\)), and can contain functions of the quantity, and its derivatives. If only the first derivative (\\(dx(t)/dt\\)) is included, it is called a first-order ODE.\nPartial differential equations (PDEs) contain more than one independent variable (e.g., time and coordinates in space). Therefore, the quantity of interest is a multivariate function, such as \\(q(x,y,t)\\), denoting the density of a population at the coordinates \\(x,y\\) and time \\(t\\). The partial derivatives with respect to the independent variables are considered, hence the name.\n\nMany other types of differential equations (stochastic differential equations, SDEs; integro-differential equations, IDEs; etc.) are found in certain technical areas.\nIn this class, we will deal exclusively with ODEs of the form:\n\\[\n\\dfrac{dx(t)}{dt} = f(x(t))\n\\]\nwhere the function \\(f(x(t))\\) models different ecological phenomena influencing the growth and decline of populations. For example, take populations growing thanks to the per-capita birth rate \\(\\beta\\), and declining due to the death rate \\(\\delta\\):\n\\[\n\\dfrac{dx(t)}{dt} = \\beta x(t) - \\delta x(t) = (\\beta - \\delta) x(t) = \\rho\\, x(t)\n\\]\nhere the intrinsic growth rate \\(\\rho\\) represents the difference between birth and death rates. The parameter is taken to be independent of time, yielding an autonomous differential equation. An ODE is autonomous if it does not depend explicitly on the independent variable (in our case, time). I.e., if \\(dx/dt = f(x(t))\\) the system is autonomous, while \\(dx/dt = g(x(t),t)\\) is not.\n\n\n\n\n\n\nSeparation of variables\n\n\n\n\n\nA differential equation for \\(x(t)\\) is called separable, if it can be written as:\n\\[\n\\frac{dx(t)}{dt} = g(t)\\, h(x(t))\n\\]\nwhere \\(g(t)\\) is a function of \\(t\\), and \\(h(x(t))\\) a function of \\(x(t)\\). As long as \\(h(x(t)) \\neq 0\\), we can formally write:\n\\[\n\\frac{1}{h(x(t))} dx(t) = g(t)\\, dt\n\\]\nWe can now integrate both sides, obtaining\n\\[\n\\begin{aligned}\n\\int \\frac{1}{h(x(t))} dx(t) + \\mathcal c_1 &= \\int g(t)\\, dt + \\mathcal c_2\\\\\n\\int \\frac{1}{h(x(t))} dx(t) &= \\int g(t)\\, dt + \\mathcal c\n\\end{aligned}\n\\]\nwhere \\(\\mathcal c_1, \\mathcal c_2\\) and \\(\\mathcal c = \\mathcal c_2 - \\mathcal c_1\\) are constants of integration, whose value can be set by considering the initial conditions.\nExample\nConsider:\n\\[\n\\frac{dx(t)}{dt} = \\alpha\n\\]\nwith initial condition \\(x(0) = x_0\\). Separate the variables and integrate:\n\\[\n\\begin{aligned}\nd x(t) &= \\alpha\\, dt\\\\\n\\int d x(t) &= \\alpha \\int dt + \\mathcal c\\\\\nx(t) &= \\alpha t + \\mathcal c\n\\end{aligned}\n\\]\nNow substitute the initial condition:\n\\[\nx(0) = x_0 = \\alpha 0 + c  = c\n\\]\nYielding the solution:\n\\[\nx(t) = x_0 + \\alpha t\n\\]\nA solution of an initial-value problem is an equation which, given the values of the parameters (\\(\\alpha\\), in this case) and the initial conditions (\\(x_0\\), in this case), allows us to determine the value of the dependent variable (\\(x(t)\\)) for any value of the independent variable (\\(t\\)). Only relatively simple ODEs or systems of ODEs can be solved explicitly.\n\n\n\nWe can solve the differential equation:\n\\[\n\\begin{aligned}\n\\dfrac{dx}{dt} &= \\rho\\, x\\\\\n\\dfrac{1}{x}\\,dx &= \\rho\\, dt\n\\end{aligned}\n\\]\nIntegrate both sides\n\\[\n\\begin{aligned}\n\\int \\dfrac{1}{x}\\,dx &= \\int \\rho\\, dt\\\\\n\\log x &= \\rho\\, t + \\mathcal c\\\\\nx &= e^{\\rho\\, t  + \\mathcal c}\\\\\nx &= e^{\\rho\\, t} e^{\\mathcal c}\\\\\n\\end{aligned}\n\\]\nwhere \\(\\mathcal c\\) is a constant of integration. Then, we can plug in the initial condition: at \\(t=0\\), the population is at density \\(x_0\\):\n\\[\n\\begin{aligned}\nx_0 &= e^{\\rho\\, 0}e^{\\mathcal c}\\\\\nx_0 &= e^{\\mathcal c}\n\\end{aligned}\n\\]\nWe obtain the solution:\n\\[\nx(t) = x(0) e^{\\rho\\, t}\n\\]\n\n\n\n\n\n\nIntegrating differential equations numerically\n\n\n\n\n\nYou can compute \\(x(t)\\) for any differential equation (or system of differential equations) in R using numerical techniques. Your code needs to include two parts:\nFirst, we write a function defining the (system of) ODE(s). This function takes three arguments: t, the time, x, the state of the system, and parms, a list of parameters, and returns a list containing \\(dx/dt\\). For the exponential growth, we can write:\n\nexponential_growth &lt;- function(t, x, parms){\n  dxdt &lt;- x * parms$rho\n  return(list(dxdt))\n}\n\nBecause ecological models only make sense for positive population densities, we can set an arbitrarily small threshold, and consider the population extinct if it falls below the threshold:\n\nTHRESH &lt;- 10^-10\n\nexponential_growth &lt;- function(t, x, parms){\n  if(x &lt; THRESH) x &lt;- 0\n  dxdt &lt;- x * parms$rho\n  return(list(dxdt))\n}\n\nThe second part of the code invokes the numerical integration function ode. For this function, we need to set a) initial conditions, b) determine at which times do we want to observe the state of the population, c) specify the name of the function to use, d) the parameters to use, and e) (optional) specify the method to use for the integration. The function ode is part of the package deSolve:\n\nx0 &lt;- 1 # initial conditions\nmy_time &lt;- seq(0, 5, by = 0.1) # we will observe the system at these times\nparms &lt;- list(rho = 1.05) # list of parameters\noutput &lt;- ode(y = x0, # a) initial conditions\n             times = my_time,  # b) time at which we observe the system\n             func = exponential_growth, # c) function computing r.h.s. of ODEs\n             parms = parms, # d) parameters of ODEs\n             method = \"ode45\") # e) more on this later; this is a good general-purpose choice\n\nThe output is a matrix of class deSolve, containing the time in the first column, and the values of \\(x(t)\\) in the second. For plotting, it is best to convert this into a data frame:\n\noutput %&gt;% \n  as.data.frame() %&gt;% \n  ggplot() + aes(x = time, y = `1`) + \n  geom_point() + \n  geom_line() + \n  xlab(\"t\") + \n  ylab(expression(x(t))) + \n  theme_bw()\n\n\n\n\n\n\n\n\n\nHow long will it take for a growing population (\\(\\rho &gt; 0\\)) to double in density? We are looking for \\(\\tau\\) such that \\[\n\\begin{aligned}\nx(\\tau) &= 2 x_0\\\\\nx_0 e^{\\rho \\tau} &= 2 x_0\\\\\ne^{\\rho \\tau} &= 2\\\\\n\\rho \\tau &= \\log 2\\\\\n\\tau &= \\dfrac{\\log 2}{\\rho}\n\\end{aligned}\n\\]\nThus, the doubling time does not depend on the initial condition: the population will keep doubling every \\(\\log 2 / \\rho\\) units of time. For example, take \\(\\rho = 0.01\\), then \\(\\tau \\approx 30\\): a population growing exponentially with rate of 1% per year will double every 30 years or so. Then, a growth of 3% yields a doubling time of 10 years, etc.\n\n\n\n\n\n\nExercise: Radiocarbon dating\n\n\n\n\n\nWhile at the University of Chicago, Willard Libby (Nobel Laureate in Chemistry, 1960) pioneered radiocarbon dating. The carbon isotope \\({}^{14}\\)C is constantly being created in the Earth’s atmosphere by the interaction of cosmic rays with atmospheric nitrogen. The carbon combines with oxygen, to form CO\\({}_2\\) that is then absorbed by plants. When plants die, the isotope decays in their tissues. Radioactive decay follows the exponential model:\n\\[\nN(t) =  N(0)e^{\\lambda t}\n\\]\nwhere \\(\\lambda &lt; 0\\) is the decay rate of the isotope. The half-life of a radioisotope is the time it takes to be reduced to half of the original concentration, and is 5,730 years for \\({}^{14}\\)C.\n\nFind the value of \\(\\lambda\\) for \\({}^{14}\\)C given its half-life\nExpress \\(t\\) as a function of \\(\\lambda\\), and the ratio between \\(N(t)\\) and \\(N(0)\\)\nThe concentration in the atmosphere is about 1 atom of \\({}^{14}\\)C for every \\(10^{12}\\) atoms of carbon. You have a collected sample that contains \\(1/16\\) atoms of \\({}^{14}\\)C for every \\(10^{12}\\) atoms of carbon; date the sample."
  },
  {
    "objectID": "ch1.html#logistic-growth",
    "href": "ch1.html#logistic-growth",
    "title": "Models for a single population",
    "section": "",
    "text": "We have a population that grows exponentially when at very low density, but experiences a slow down in growth when densities are higher. The logistic growth equation is typically written as:\n\\[\n\\frac{d X}{d \\tau} = X\\left(\\rho - \\alpha X\\right)\n\\]\nwhere \\(\\rho&gt;0\\) is the intrinsic growth rate of the population, and \\(\\alpha&gt;0\\) is a parameter that regulates the amount by which growth is decreased as \\(X\\) increases.\nAn equilibrium (steady-state, fixed point) of a differential equation is a value of the dependent variable (\\(X(t)\\)) that makes the right-hand side of the equation zero. We denote an equilibrium as \\(X^\\star\\). We can write:\n\\[\n\\left.\\dfrac{dX}{d\\tau}\\right|_{X^\\star} = 0\n\\]\ni.e., the differential equation, evaluated at the point \\(X^\\star\\) is zero: the population will not grow nor decline, but rather will remain at \\(X^\\star\\). The logistic equation has two equilibria: \\(X^\\star=0\\) (absence of the population), and \\(\\rho = \\alpha X^\\star\\), \\(X^\\star = \\rho / \\alpha = \\kappa\\), called the carrying capacity of the population.\n\n\n\n\n\n\nChain rule\n\n\n\n\n\nThis is one of the most useful formulas from calculus. It relates the derivative of the composition of two differentiable functions with the derivatives of the functions. If \\(h(x) = g(u)\\) and \\(u = f(x)\\), then:\n\\[\n\\dfrac{dh}{dx} = \\dfrac{dg}{du}\\dfrac{du}{dx}\n\\]\nAs put by George Simmons [Calculus with Analytic Geometry (1985)]: If a car travels twice as fast as a bicycle and the bicycle is four times as fast as a walking man, then the car travels 2 × 4 = 8 times as fast as the man.\nExample\nTake\n\\[\n\\dfrac{dx(t)}{dt} = x(t) f(x(t))\n\\]\nand write the ODE describing \\(d \\log x(t) /dt\\). We can write this function as the derivative of the composition \\(\\log x(t) = \\log u\\) and \\(u = x(t)\\). Then, by chain rule:\n\\[\n\\begin{aligned}\n\\dfrac{d \\log x(t)}{dt} &= \\dfrac{d \\log u}{du} \\dfrac{du}{dt}\\\\\n&= \\dfrac{1}{u} \\dfrac{du}{dt}\\\\\n&= \\dfrac{1}{x(t)} \\dfrac{d x(t)}{dt}\\\\\n&= \\dfrac{1}{x(t)}  x(t) f(x(t))\\\\\n&= f(x(t))\n\\end{aligned}\n\\]\nshowing that the per-capita rate of change:\n\\[\n\\dfrac{1}{x(t)} \\dfrac{dx(t)}{dt} = \\dfrac{\\log x(t)}{dt}\n\\]\nis the derivative in time of the logarithm of the density of the population.\n\n\n\nWe can simplify the analysis of the differential equation by rescaling all the variables by positive quantities, thus obtaining a simpler form that retains the behavior of the original equation.\n\n\n\n\n\n\nNondimensionalization\n\n\n\n\n\nEcological models can have many parameters, and the goal of nondimensionalization is to rewrite the equations using as few parameters as possible, via a change of variables. Importantly, the new system and the original one are equivalent, and share the same dynamics. In fact, the trajectories of the original system can be reconstructed from those of the simpler system by inverting the transformation.\nTo perform nondimensionalization:\n\nidentify all the variables that depend on time (\\(X(\\tau)\\), \\(Y(\\tau)\\), etc.), as well as the independent variable (the time, \\(\\tau\\))\nreplace each of them by a scaled version: \\(X = c_x x\\), \\(Y = c_y y\\), \\(\\tau = c_t t\\), in which \\(c_i\\) are positive constants to be determined, and rewrite the equations for the new variables\nchoose the values for the constants to eliminate as many parameters as possible. Generally, one should be able to remove one parameter for each dependent variable, plus one parameter by scaling the time.\n\nExample\nThe exponential growth equation has a single parameter:\n\\[\n\\frac{dx}{d\\tau} = \\rho x\n\\]\none can define \\(\\tau = c_1\\,t\\). But then \\(\\dfrac{d \\tau}{d t} = c_1\\) and thus \\(d \\tau = c_1\\, dt\\). We substitute this value, obtaining:\n\\[\n\\begin{aligned}\n\\frac{1}{c_1}\\frac{dx}{dt} &= \\rho x\\\\\n\\frac{dx}{dt} &= c_1 \\rho x\\\\\n\\frac{dx}{dt} &= x\n\\end{aligned}\n\\]\nwhere we have chosen \\(c_1 = 1/\\rho\\).\n\n\n\nWe rewrite the equation for the logistic growth by choosing \\(X = c_1\\, x\\) and \\(\\tau = c_2\\, t\\). Our equations become (use the chain rule):\n\\[\n\\begin{aligned}\n\\dfrac{c_1}{c_2}\\dfrac{dx}{dt} &= c_1 x (\\rho - \\alpha c_1 x)\\\\\n\\dfrac{dx}{dt} &= x (\\rho c_2 - \\alpha c_1 c_2 x)\\\\\n\\end{aligned}\n\\]\nWe choose \\(c_2 = 1/\\rho\\) to make the first coefficient in parenthesis be equal to 1; then, we choose \\(c_1 = \\rho/\\alpha\\) to make the second coefficient be 1:\n\\[\n\\dfrac{dx}{dt} = x (1 - x)\n\\]\nNote that, in practice, we have chosen to rescale the variables using the intrinsic growth rate, \\(t = \\tau / \\rho\\), and the carrying capacity, \\(x = X \\alpha / \\rho = X / \\kappa\\).\nThe logistic equation can be solved, because it is separable:\n\\[\n\\begin{aligned}\n\\dfrac{1}{x(1-x)} dx &= dt\\\\\n\\left(\\dfrac{1}{x}-\\dfrac{1}{x-1}\\right)dx &= dt\\\\\n\\int \\dfrac{1}{x} dx - \\int \\dfrac{1}{1-x} dx &= \\int dt + \\mathcal c\\\\\n\\log x - \\log(x-1)&= t + c\\\\\n\\log \\dfrac{x}{x-1}&= t + c\\\\\n\\dfrac{x}{x-1} &= e^t e^c\\\\\nx &= \\dfrac{e^t e^c}{e^t e^c - 1}\\\\\nx &= \\dfrac{1}{1 - e^{-t}e^{-c}}\n\\end{aligned}\n\\]\nPlugging in \\(x_0\\) when \\(t=0\\), we find the value for the constant of proportionality:\n\\[\n\\begin{aligned}\nx_0 &= \\frac{e^c}{e^c - 1}\\\\\ne^c &= \\frac{x_0}{x_0 - 1}\n\\end{aligned}\n\\]\nYielding the solution\n\\[\nx(t) = \\dfrac{x_0 e^t}{1 + (e^t - 1)x_0}\n\\]"
  },
  {
    "objectID": "ch1.html#qualitative-analysis",
    "href": "ch1.html#qualitative-analysis",
    "title": "Models for a single population",
    "section": "",
    "text": "As shown for the logistic growth, solving ODEs can be very hard, and for most equations found in ecology a closed-form solution cannot be found. Moreover, even when we can solve the equations, the solution might be difficult to interpret or overly complex. Important information on the behavior of the system can be found by performing a qualitative analysis of the system. Here we concentrate on the location of equilibria, and their stability.\n\n\nFor any first-order ODE with a single dependent variable, one can understand the behavior of the system by simply plotting \\(dx(t)/dt\\) (y-axis) vs \\(x(t)\\) (x-axis). For example, for the logistic model:\n\\[\n\\dfrac{dx}{dt} = x(1-x)\n\\]\n\n\n\n\n\nShowing that there are two equilibria (\\(x^\\star =0\\), and \\(x^\\star = 1\\)), corresponding to the points where the curve \\(dx/dt\\) intercepts the x-axis. The function \\(dx/dt\\) is positive whenever \\(0&lt;x&lt;1\\), and is negative when \\(x&gt;1\\). Thus, the population will grow in time when \\(0&lt;x&lt;1\\), eventually reaching \\(x^\\star = 1\\); similarly, if we start the population at a density that is larger than the equilibrium, it will decline, again eventually reaching \\(x^\\star = 1\\). We therefore say that \\(x^\\star = 1\\) is asymptotically stable.\n\n\n\n\n\n\nAsymptotic stability\n\n\n\n\n\nThere are two useful notions of equilibrium stability for dynamical systems. We state them informally; you can find a more rigorous definition in any book on dynamical systems.\nLyapunov stability For a given dynamical system \\(dx(t)/dt\\), \\(x^\\star\\) is Lyapunov stable if trajectories starting close to \\(x^\\star\\) remain close to it, indefinitely. More formally, we define a neighborhood of \\(x^\\star\\), \\(\\| x(0) - x^\\star\\| &lt; \\delta\\); then \\(x^\\star\\) is Lyapunov stable if \\(\\| x(t) - x^\\star\\| &lt; \\epsilon\\) for every \\(t\\), where \\(\\epsilon &gt; 0\\).\nAsymptotic stability An equilibrium is asymptotically stable if it is Lyapunov stable, and trajectories eventually converge to \\(x^\\star\\): \\(x^\\star\\) is asymptotically stable if there exist a neighborhood \\(\\| x(0) - x^\\star\\| &lt; \\delta\\) such that \\(\\lim_{t\\to\\infty}\\| x(t) - x^\\star\\| = 0\\).\n\n\n\nThe logistic model assumes that the per capita growth rate is higher at low densities. This assumption may not be realistic for all species: when the density is low, for example, it can be more difficult to find a partner and defend against predators. This phenomenon of lower per capita growth rates at low densities, and higher per capita growth at high densities—which can also be called positive density-dependence—is known as the Allee effect. It is named after Warder Clyde Allee (1885-1955), who received his PhD from the University of Chicago and was later a professor and chair of Zoology. We could model this effect with the following equation:\n\\[\n\\dfrac{dX}{dt} = X\\left(\\dfrac{u X}{v + X} - c X \\right) = X^2 \\left(\\dfrac{u}{v + X} - c  \\right)\n\\]\nwhere \\(c\\) is the density-dependent death rate. Assume that all parameters are positive; then, besides the trivial equilibrium \\(X^\\star =0\\), we have a positive equilibrium \\(X^\\star = \\frac{u}{c} - v &gt; 0\\).\n\n\n\n\n\nThe graphical method allows to classify all equilibria according to their stability in a straightforward manner. Here’s an example with many equilibria:\n\n\n\n\n\n\n\n\n\n\n\nExercise: Strong Allee effect\n\n\n\n\n\nA stronger version of the Allee effect can be modeled as:\n\\[\n\\dfrac{dX}{dt} = X (X - \\gamma)(\\kappa - X)\n\\]\nwith \\(0&lt;\\gamma &lt; \\kappa\\).\n\nInterpret the parameters\nPlot \\(dX/dt\\) vs \\(X\\), and identify all equilibria\nClassify the equilibria according to their stability\n\n\n\n\n\n\n\nYou might have noticed that, when performing the graphical analysis above, and equilibrium is stable if \\(dx/dt\\) has a negative slope at \\(x^\\star\\). Here we formalize this notion, by considering small perturbations of the system resting at an equilibrium.\n\nTake an ODE \\(dx/dt = f(x)\\)\nThe system is resting at an equilibrium \\(x^\\star\\)\nWe perturb the system, and track the dynamics when starting at \\(x(0) = x^\\star + \\epsilon\\), where \\(\\epsilon\\) (the perturbation) is taken to be sufficiently small \\(\\| \\epsilon \\| \\ll 1\\)\nWe write \\(\\Delta x(0) = x(0) - x^\\star\\)\nWe derive the dynamics for \\(\\Delta x\\):\n\nBy chain rule,\n\\[\n\\begin{aligned}\n\\dfrac{d \\Delta x}{dt} &= \\dfrac{d \\Delta x}{dx} \\dfrac{d x}{dt} \\\\\n&= 1 \\dfrac{d x}{dt}\\\\\n&= f(x)\\\\\n&= f(\\Delta x + x^\\star)\n\\end{aligned}\n\\] Where we have substituted \\(x = \\Delta x + x^\\star\\).\n\nNow we approximate the function \\(f(\\Delta x + x^\\star)\\) by Talyor expanding.\n\n\n\n\n\n\n\nTaylor series\n\n\n\n\n\nWe can approximate the behavior of a (infinitely differentiable) function in the vicinity of a point \\(a\\) by a power series:\n\\[\nf(x) = f(a) + \\dfrac{1}{1!} \\left. \\dfrac{df(x)}{dx} \\right|_a (x-a)+ \\dfrac{1}{2!} \\left. \\dfrac{d^2f(x)}{dx^2} \\right|_a (x-a)^2+ \\dfrac{1}{3!} \\left. \\dfrac{d^3f(x)}{dx^3} \\right|_a (x-a)^3 + \\ldots\n\\] where \\(n! = n (n-1)(n-2)\\ldots 1\\) is the factorial function and the derivatives are evaluated at \\(a\\). When we choose \\(a=0\\) this is called the Maclaurin series.\nExample\nExpand \\(e^x\\) around \\(0\\):\n\\[\n\\begin{aligned}\ne^x &= e^0 + \\left. e^x\\right|_0 x + \\frac{1}{2}\\left. e^x\\right|_0 x^2  + \\frac{1}{6}\\left. e^x\\right|_0 x^3 + \\ldots\\\\\n&=1 + x + \\frac{1}{2} x^2  + \\frac{1}{6}x^3 + \\ldots\\\\\n&=\\sum_{k=0}^\\infty \\frac{x^k}{k!}\n\\end{aligned}\n\\]\n\n\n\nWe want to Taylor-expand \\(f(x) = f(\\Delta x + x^\\star)\\) around \\(x^\\star\\):\n\\[\nf(x) = f(x^\\star) + \\left.\\dfrac{d f(x)}{d x}\\right|_{x^\\star} (x - x^\\star) + \\dfrac{1}{2}\\left.\\dfrac{d^2 f(x)}{d x^2}\\right|_{x^\\star} (x - x^\\star)^2 + \\ldots\n\\] Note that \\(f(x^\\star) = 0\\) by the definition of an equilibrium. If the deviation is small, we can neglect all the higher-order terms, obtaining:\n\\[\n\\dfrac{d \\Delta x}{dt} = f(x) \\approx \\left.\\dfrac{d f(x)}{d x}\\right|_{x^\\star} \\Delta x\n\\]\nwhich is the equation of the exponential growth model, with \\(\\rho = \\left.\\dfrac{d f(x)}{d x}\\right|_{x^\\star}\\). Then, the solution is \\(\\Delta x(t) = \\Delta x(0) e^{\\rho t}\\), and the deviation from the equilibrium goes to zero (i.e., the system goes back to \\(x^\\star\\)) whenever \\(\\rho &lt; 0\\).\nFor example, take the logistic growth model and evaluate the stability of \\(x^\\star = 1\\); we have:\n\\[\n\\left.\\dfrac{d f(x)}{d x}\\right|_{x^\\star} = \\left.\\dfrac{d (x - x^2)}{d x}\\right|_{x^\\star} = \\left.(1 - 2x)\\right|_{x^\\star} = -1\n\\]\nand thus the equilibrium is locally asymptotically stable. Locally, because we have considered very small deviations from the equilibrium, and asymptotic because convergence only happens eventually.\n\n\n\n\n\n\nExercise: Stability of equilibria for strong Allee effect\n\n\n\n\n\nTake the function for the Allee effect in the previous exercise:\n\\[\n\\dfrac{dX}{dt} = X (X - \\gamma)(\\kappa - X)\n\\]\nUse local stability analysis to show that the system has three equilibria, of which two are locally stable.\n\n\n\n\n\n\n\n\n\nExercise: Stability of model with weak Allee effect\n\n\n\n\n\nNow analyze the stability of the model with weak Allee effects:\n\\[\n\\dfrac{dX}{dt} = X^2 \\left(\\dfrac{u}{v + X} - c  \\right)\n\\]\nAssuming that \\(u/c &gt; v\\). You will find that the analysis of the equilibrium \\(X^\\star = 0\\) is inconclusive; expand the function \\(d\\Delta X/dt\\) to include higher-order terms to determine the stability of the equilibrium.\n\n\n\n\n\n\n\n\n\nExercise: Levins’ metapopulation model\n\n\n\n\n\nIn 1969, when he was a professor at the University of Chicago, Richard Levins proposed a model for metapopulation dynamics. The idea is that in a landscape there are numerous patches of suitable habitat that can be colonized by a given species. Each population in a patch undergoes extinction with a certain rate, and can colonize other patches by sending propagules to them. Because there are many patches, we track the proportion of occupied patches \\(0 \\leq p(t) \\leq 1\\); the proportion of empty patches is therefore \\(1 - p(t)\\). If individuals disperse to a random patch when leaving an occupied patch, the rate of colonization will be proportional to the product \\(\\gamma\\, p(t)(1-p(t))\\) (i.e., \\(\\gamma\\, p(t)\\) is the rate at which propagules are produced, and \\(1-p(t)\\) is the rate at which they land on an empty patch). The rate at which patches are vacated, the extinction rate, is \\(\\delta\\). The model can be written as:\n\\[\n\\dfrac{d p(t)}{dt} = \\gamma\\,p(t)(1 - p(t)) - \\delta\\, p(t)\n\\]\n\nFind the equilibria\nDetermine their stability\nShow that the equation is equivalent to that for the logitstic growth\n\n\n\n\n\n\n\nIn certain models, we can show that whenever the population starts at a positive value, it will always reach a certain equilibrium \\(x^\\star\\). In this case, we say the equilibrium is globally asymptotically stable.\nBecause as we said solving differential equations is in general very difficult, and in many cases of interest impossible, we employ a proxy function, called a Lyapunov function.\n\n\n\n\n\n\nLyapunov functions\n\n\n\n\n\nWe want to prove that all trajectories originating at \\(x(0) &gt; 0\\) eventually converge to \\(x^\\star\\). If we can find a function \\(V\\) such that:\n\n\\(V(x(t)) \\geq 0\\) for all \\(x(t) &gt; 0\\)\n\\(V(x(t)) = 0\\) if and only if \\(x(t) = x^\\star\\)\n\\(\\dfrac{d V(x(t))}{dt} \\leq 0\\) for all \\(t\\) and\n\\(\\dfrac{d V(x(t))}{dt} = 0\\) if and only if \\(x(t) = x^\\star\\)\n\nthen \\(x^\\star\\) is globally asymptotically stable: all trajectories starting at a positive point will converge to it.\nThe logic of this procedure is to identify a suitable function \\(V\\) that is positive everywhere but at the equilibrium, and is constantly declining in time; then necessarily the function will eventually reach zero, which is attained only at equilibrium.\nExample\n\\(V(x(t)) = (x(t) - x^\\star)^2\\) is a Lyapunov function that can be used to prove that the logistic growth model \\(dx/dt = x(1-x)\\) has an equilibrium \\(x^\\star = 1\\) that is globally asymptotically stable.\n\n\\(V(x(t))\\) is always nonnegative, and is zero only at \\(x(t) = x^\\star = 1\\)\nThe derivative of \\(V(x(t))\\) w.r.t. time is:\n\n\\[\n\\begin{aligned}\n\\dfrac{dV(t)}{dt} &= \\dfrac{dV(t)}{dx(t)}\\dfrac{dx(t)}{dt}\\\\\n&= 2(x(t) - x^\\star)\\dfrac{dx(t)}{dt}\\\\\n&=-2(x(t)-1) x(t)(x(t)-1)\\\\\n&=-2 x(t) (x(t)-1)^2 \\leq 0\n\\end{aligned}\n\\]\n\n\n\n\n\n\n\n\n\nExercise: Global stability of logistic growth\n\n\n\n\n\nShow that \\(V(x(t)) = x(t) - 1 - \\log x(t)\\) is a Lyapunov function that can be used to prove the global stability of \\(x^\\star = 1\\) for the logistic growth model \\(dx/dt = x(1-x)\\).\n\nProve that \\(V \\geq 0\\), with equality only at equilibrium\nProve that \\(dV/dt \\leq 0\\), with equality only at equilibrium\n\n\n\n\n\n\n\nAutonomous, first-order ODE models with a single variable can have only two types of behavior: a) \\(x(t)\\) eventually reaches a fixed point and remains there; b) \\(x(t)\\) goes to \\(\\pm \\infty\\). This is a consequence of an important mathematical fact: if \\(dx(t)/dt = f(x(t))\\) and the function \\(f(x(t))\\) is “smooth” (e.g., continuously differentiable) then the solution for the ODE exists and is unique. This means that the equation can cross each point \\(x(t) = \\alpha\\) only once, or infinitely many times. In contrast, discrete models with a single variable can have very interesting behavior."
  },
  {
    "objectID": "ch1.html#discrete-time-models",
    "href": "ch1.html#discrete-time-models",
    "title": "Models for a single population",
    "section": "",
    "text": "We have so far analyzed models where the growth of a population is described by an ordinary differential equation. However, for particular situations, and especially for species with nonoverlapping generations, a discrete-time approach would be more suitable.\n\n\nTo understand whether a discrete model is stable, we analyze the plot of \\(x_{t+1}\\) against \\(x_t\\), superimposed on the diagonal (\\(x_{t+1}=x_{t}\\)). We use these two curves to “cobweb”:\n\nStarting from an initial condition \\(x_t=x(0)\\) (some point on the x-axis), we draw a line to the model’s projection of the population at the next time step (\\(x_{t+1}\\))\nWe then set \\(x_t=x_{t+1}\\) to obtain the population in the next time step. To speed the process along, rather than lifting our pencils to draw \\(x_{t+1}\\) at \\(x_t\\) on the x-axis, we can simply draw a horizontal line from \\(x_{t+1}\\) back to the diagonal (which shows \\(x_{t+1}=x_t\\)) and then move vertically to get the next \\(x_{t+1}\\)\nWith enough iterations, this process reveals whether the population converges to a fixed point or does something more elaborate, and if this trajectory involves oscillations. Note that at a fixed point, \\(x_{t+1}=x_t=x^\\star\\).\n\nWe can use this approach for any map (discrete-time model) of \\(x_{t+1}\\) to \\(x_t\\), although cobwebbing suffers the disadvantage of requiring a lot of manual labor to explore the asymptotic behavior. To explore its uses further, we’ll consider one of the most basic and important density-dependent, discrete-time models: the logistic map.\n\n\n\nThis is a model with a very similar formulation to the logistic growth ODE above:\n\\[\nx_{t+1} = r\\, x_t (1 - x_t)\n\\]\nWith \\(x_t &gt; 0\\) and \\(r &gt; 0\\). When \\(x_t &gt; 1\\), the population will decline; therefore it makes sense to start the population at a value \\(0&lt;x_0&lt;1\\). For these values, the population might grow only if \\(r &gt; 1\\) (i.e., we want \\(x_{t+1} &gt; x_t\\) for growth).\nLet’s try our hand at cobwebbing: set \\(x_0 = 1/2\\) and \\(r = 3/2\\). The cobwebbing plot becomes:\n\n\n\n\n\nshowing that the population declines and then stops at an equilibrium. We can compute the equilibrium by setting \\(x_{t+1} = x_t = x^\\star\\):\n\\[\n\\begin{aligned}\nx^\\star &= r\\, x^\\star (1 - x^\\star)\\\\\n1 &= r\\, (1 - x^\\star)\\\\\nx^\\star &= 1 - \\frac{1}{r}\n\\end{aligned}\n\\]\nThus, a feasible (positive) equilibrium is found only for \\(r &gt; 1\\), as expected. In the example above, the equilibrium is reached without oscillations. Let’s try the cobweb for a larger \\(r = 5/2\\)\n\n\n\n\n\nNow the solution \\(x^\\star = 1 - \\frac{2}{5} = \\frac{3}{5}\\) is reached after oscillating above and below this value.\n\n\n\nWe want to determine whether \\(x^\\star\\) is stable for a given map (discrete-time model) \\(x_{t+1} = f(x_t)\\), with \\(f(x^\\star)=x^\\star\\). In particular, we want to determine whether when we initialize the system close to \\(x^\\star\\) we converge back to \\(x^\\star\\).\nTake \\(x_t = x^\\star + \\epsilon_t\\), where \\(\\epsilon_t\\) is small. Then we have\n\\[\n\\begin{aligned}\nx_{t+1} &= f(x_t)\\\\\nx^\\star + \\epsilon_{t+1} &= f(x^\\star + \\epsilon_t)\\\\\nx^\\star + \\epsilon_{t+1} &\\approx f(x^\\star) + \\left. \\dfrac{d f(x_t)}{dx_t}\\right|_{x^\\star} (x_t - x^\\star) \\\\\nx^\\star + \\epsilon_{t+1} &\\approx x^\\star + \\left. \\dfrac{d f(x_t)}{dx_t}\\right|_{x^\\star} \\epsilon_t\\\\\n\\epsilon_{t+1} &\\approx \\left. \\dfrac{d f(x_t)}{dx_t}\\right|_{x^\\star} \\epsilon_t\\\\\n\\end{aligned}\n\\]\nwhich is the very first model we have written. We have:\n\\[\n\\epsilon_{t+k} = \\rho^{k} \\epsilon_t\n\\]\nwith \\(\\rho = \\left. \\dfrac{d f(x_t)}{dx_t}\\right|_{x^\\star}\\). We have that\n\\[\n\\lim_{k \\to \\infty} \\epsilon_{t+k} = 0 \\quad \\text{if} \\, |\\rho| &lt; 1\n\\]\nThus, the equilibrium is stable if and only if the absolute value of \\(\\left. \\dfrac{d f(x_t)}{dx_t}\\right|_{x^\\star}\\) is less than 1. If this value is greater than 1, then the equilibrium is unstable: small perturbations will amplify (at least initially); if the value is exactly 1, the analysis is inconclusive, and we might want to consider including higher-order terms in the Taylor expansion above.\nExample\nTake \\(r = 2\\), and show that the equilibrium \\(x^\\star = 1/2\\) is stable. We take the derivative:\n\\[\n\\rho = \\left.\\dfrac{d f(x_t)}{d x_t} \\right|_{x^\\star} = r \\left. \\dfrac{d (x_t (1- x_t))}{d x_t}\\right|_{x^\\star} = \\left. r (1 - 2 x_t)\\right|_{x^\\star}\n\\]\nand substitute the values of \\(r\\) and \\(x_t = x^\\star = 1/2\\). We obtain \\(\\rho = 0\\) and thus the equilibrium is stable. In fact, we see that, for any value of \\(r &gt; 0\\) leading to a feasible equilibrium, we have:\n\\[\n\\rho = r \\left(1 - 2 \\left(1 - \\frac{1}{r} \\right) \\right) = 2 - r\n\\]\nand thus whenever \\(|2 - r| &lt; 1\\) we have a stable equilibrium. This is true whenever \\(3&gt; r &gt;1\\).\n\n\n\nIf we make \\(r\\) even larger, we find new behavior. For example, take \\(r = 10/3\\), \\(x_0 = 3/4\\)\n\n\n\n\n\nAfter a few oscillations, the system sets into a cycle, alternating between two values. This is best seen by plotting a time-series, in which we have the (discrete) time in the x-axis, and the value \\(x_t\\) on the y-axis:\n\n\n\n\n\nWhat are the two values? To find them, we can set \\(x_{t+2} = x_{t}\\) making sure that \\(x_{t+1} \\neq x_t\\). Take:\n\\[\n\\begin{aligned}\nx_{t+2} &= x_t\\\\\nf(x_{t+1}) &= x_t\\\\\nf(f(x_t)) &= x_t\\\\\nf^{(2)}(x_t) &= x_t\n\\end{aligned}\n\\]\nFor the logistic map, we have:\n\\[\n\\begin{aligned}\nx_t &= r\\,x_{t+1}\\,(1 - x_{t+1})\\\\\n&= r\\, r\\, x_t (1 - x_t)\\, (1 -  r\\, x_t (1 - x_t))\\\\\n&= r^2 x_t (1-x_t) (1 -  r\\, x_t (1 - x_t))\n\\end{aligned}\n\\]\nWhen we discard the solution \\(x_t =0\\), we obtain the cubic polynomial:\n\\[\n-r^3 x_t^3+2 r^3 x_t^2-(r+1) r^2 x_t+r^2-1= 0\n\\]\nWe can factor out the solution \\(x_t = 1 - \\frac{1}{r}\\), which we know already, obtaining:\n\\[\n\\begin{aligned}\nr^3 x_t^2 - r^2 (1 + r) x_t + r (1 + r) &= 0\\\\\nr^2 x_t^2 - r (1 + r) x_t + (1 + r) &= 0\n\\end{aligned}\n\\]\nYielding:\n\\[\nx_c = \\dfrac{r +1 \\pm \\sqrt{(r-3) (r+1)}}{2 r}\n\\]\nBoth values are greater than zero whenever \\(r \\geq 3\\). We can investigate the stability of the cycle, we can take the derivative w.r.t. \\(x_t\\) of \\(f^{(2)}(x_t)\\), and plug in one of the two values above:\n\\[\n\\begin{aligned}\n\\rho &= \\left.\\dfrac{d f^{(2)}(x_t)}{d x_t} \\right|_{x_c}\\\\\n&= \\left. \\left(\\dfrac{d}{d x_t} r^2 x_t (1-x_t) (1 -  r\\, x_t (1 - x_t)) \\right)\\right|_{x_c}\\\\\n&= \\left. (r^2 (1 - 2 x_t)(1 - 2 r x_t(1-x_t))) \\right|_{x_c}\n\\end{aligned}\n\\]\nSubstituting the larger value of \\(x_c\\), we eventually find:\n\\[\n\\rho = 4 - r (r - 2)\n\\]\nThe period-2 cycle is stable whenever \\(|\\rho| &lt; 1\\). If we assume that \\(r \\geq 3\\) (required for the existence of the cycle in the first place), we have:\n\\[\n3 &lt; \\rho &lt; 1 + \\sqrt{6} \\approx 3.45\n\\]\nThe period-2 orbits are therefore stable in this range. What happens beyond this value of \\(r\\)? Take \\(r = 3.5\\) and cobweb:\n\n\n\n\n\nNow we have that the system oscillates between four values, as seen from the time-series (where we have removed the first 250 time steps for clarity):\n\n\n\n\n\nNow we have a period-4 solution, which is stable until \\(1 + \\sqrt{6} &lt; r &lt; 3.701\\), at which point we find period-8 cycles:\n\n\n\n\n\n\n\n\nThe system can yield cycles of period three. Take \\(r = 1 + 2 \\sqrt{2}\\), and plot the time series:\n\n\n\n\n\nA famous result (Sharkovsky’s theorem, Ukrainian Math J, 1964) states that if a map has cycles of period 3, then it must have cycles of every other period. Li and Yorke (“Period Three Implies Chaos”. Am. Math. Monthly, 1975) showed that indeed a period-three implies infinitely many trajectories that do not have a period, and oscillate without ever completing a cycle. We call this phenomenon chaos.\nChaos is aperiodic long-term behavior in a deterministic system that exhibits sensitive dependence to initial conditions. In particular, one can prove that in a chaotic regime, if we start with two initial conditions that are very close to each other (their distance being \\(\\Delta x_0\\)) we eventually find very different trajectories. In particular, when we have chaos:\n\\[\n|\\Delta x(t)| \\approx e^{\\lambda t}|\\Delta x_0|\n\\]\nwith \\(\\lambda&gt;0\\) (the Lyapunov exponent).\nTo show this behavior, let’s plot two trajectories for the system when \\(r = 3.675\\) and \\(x_0 = 0.5\\) or \\(x_0 = 0.4999\\):\n\n\n\n\n\n\n\n\nAll these results can be summarized in a beautiful graph. We build it as follows:\n\npick a value of \\(r\\)\nstarting from an arbitrary point, \\(x_0 = 1/2\\), compute \\(x_t\\) for a large number of points, and discard the first part of the time series (transient dynamics)\nlocate and record the minima and maxima of the time series\nplot \\(r\\) (x-axis) against the location of the minima and maxima (y-axis)\n\nIf the trajectories converge to an equilibrium, we will find a single point; if trajectories converge to a period-2 cycle, we will find two points; etc.\n\nlogistic_map_ts &lt;- function(r, max_time = 3000, discard = 2000){\n  ts &lt;- accumulate(.x = rep(1/2, max_time), .f = function(xt, xtp1) r * xt * (1-xt))[discard:max_time]\n  # discard points at which the trajectory repeats\n  difference &lt;- abs(ts - ts[1])\n  zz &lt;- which(difference &lt; 10^-6)\n  if(length(zz) &gt; 1) ts &lt;- ts[1:zz[2]]\n  return(tibble('x' = ts, 'r' = r))\n}\n# load results if available\nif (file.exists(\"data/logistic_bifurcation.RData\")){\n  load(\"data/logistic_bifurcation.RData\")\n} else {\n  # compute the results (this will take some time...)\n  bifurcation_logistic_map &lt;- map_df(.x = seq(2.95, 3.99, by = 0.001), \n                                     .f = logistic_map_ts)  \n  # and save the file\n  save(bifurcation_logistic_map, file = \"data/logistic_bifurcation.RData\")\n}\nggplot(bifurcation_logistic_map) + \n  aes(x = r, y = x) + \n  geom_point(size = 0.005, alpha = 0.2) + \n  theme_bw() + \n  xlab(expression(r)) + ylab(expression(x[t]))\n\n\n\n\n\n\n\n\n\n\nExercise: Ricker model\n\n\n\n\n\nThis period-doubling cascade to chaos is common to several models. Draw the bifurcation diagram for the Ricker model:\n\\[\nx_{t+1} = x_t e^{r(1-x_t)}\n\\]\nagain taking values of \\(r\\) between 1.95 and 4, and values of \\(x_0\\) between 0 and 1."
  },
  {
    "objectID": "ch1.html#hysteresis",
    "href": "ch1.html#hysteresis",
    "title": "Models for a single population",
    "section": "",
    "text": "Sudden shifts in populations, such as sharp spikes and collapses (even extinctions), capture attention. Our intuition might be that such changes arise from exogenous influences, such as extreme weather events. One of the first powerful examples showing that sudden shifts can arise from gradual (arguably endogenous) changes comes from a model of the spruce budworm. The spruce budworm has huge outbreaks roughly every 40 years in North America. These dynamics were modeled by Ludwig, Jones, and Holling in 1978.\nThe change in the budworm population \\(B\\) can be described by \\[\n\\dfrac{dB}{d\\tau} = rB\\left(1-\\frac{B}{K}\\right)-b \\dfrac{B^2}{a^2 + B^2}\n\\] Predation in this model arises from birds, causing the mortality term. We can reduce the number of parameters by setting:\n\\[\nB = c_1 x \\quad \\tau = c_2 t\n\\]\nChoosing \\(c_1 = a\\), and \\(c_2 = a/b\\), we obtain:\n\\[\n\\dfrac{dx}{dt} = \\dfrac{a r}{b}x\\left(1 - \\dfrac{a}{K} x \\right) - \\dfrac{x^2}{1+x^2}\n\\]\nAnd defining \\(\\rho = a r / b\\) and \\(\\gamma = K/a\\), we finally have:\n\\[\n\\dfrac{dx}{dt} = \\rho x\\left(1 - \\dfrac{x}{\\gamma}  \\right)- \\dfrac{x^2}{1+x^2}\n\\]\nThe trivial equilibrium is \\(x^\\star = 0\\). Depending on the value of \\(\\gamma\\), we can have one, two or three equilibria at which:\n\\[\n\\rho \\left(1 - \\dfrac{x^\\star}{\\gamma}\\right) = \\dfrac{x^\\star}{1 + {x^\\star}^2}\n\\]\nBecause solving for the equilibria is involved, we can plot the l.h.s. and the r.h.s for different values of \\(\\rho\\) and \\(\\gamma\\).\n\n\n\n\n\nThe r.h.s. is the solid line, and the dashed lines represent different choices of r.h.s. when we vary the parameters \\(\\rho\\), \\(\\gamma\\). Depending on the choice of parameters, we can have a single equilibrium at which the spruce budworm is at low level (dotted line); two equilibria (dashed-dotted line), three equilibria (dashed line), and back to one equilibrium (long-dashed line).\nThe authors interpreted \\(\\rho\\) and \\(\\gamma\\) as “slow” parameters that relate to forest development. Keeping the x-intercept (\\(\\gamma\\)) fixed, and starting with a single (stable) positive equilibrium yiedling low values of \\(x\\); this is called a “refuge” in the literature. When we increase \\(\\rho\\), we transition to two positive equilibria (one stable, the other metastable), and then to three equilibria (with the first and the third that are stable); thus depending on the initial conditions, we can have a large or small population size. Finally, increasing \\(\\rho\\) even more takes us back to a single stable equilibrium with very high values of \\(x\\) (“outbreak”). The authors hypothesized that gradual shifts in forest conditions, effected mostly through \\(\\rho\\), could thus generate sudden outbreaks of the spruce budworm. We can recapitulate these behaviors by producing a bifurcation plot, in which we slowly vary \\(\\rho\\), and mark the equilibria and their stability.\n\n\n\n\n\nThis dynamic is an example of hysteresis. It shows that the position of \\(x\\) at a given (\\(\\rho\\), \\(\\gamma\\)) depends on the recent dynamics of the system. Hysteretic models have also been used to explain sudden shifts in nutrient loading in lakes (e.g., from eutrophic to oligotrophic). Hysteretic systems can get “stuck” in regimes (e.g., high \\(x\\)), and getting back to the starting point can require more than just reversing some parameter (like \\(\\gamma\\)) to its previous position.\n\n\n\n\n\n\nEuler’s method\n\n\n\n\n\nWhen we want to compute trajectories for a differential equations, we face the problem that typically the equations cannot be solved. Computers get around this issue by carefully computing the trajectory for a discrete-time model. The simplest case is that of Euler’s method.\nWe want to compute the solution of \\(dx(t)/dt = f(x(t))\\). For sufficiently small \\(\\Delta t\\), we can Taylor-expand \\(x(t_0 + \\Delta t)\\) around \\(t_0\\), obtaining:\n\\[\nx(t_0 + \\Delta t) \\approx x(t_0) + \\left. \\dfrac{d x(t)}{dt}\\right|_{t_0} \\Delta t\n\\]\nwe know the value of \\(x(t_0) = x_0\\), and the function \\(d x(t) / dt = f(x(t))\\), and as such:\n\\[\nx(t_0 + \\Delta t) \\approx x_0 + \\Delta t \\, f(x_0)\n\\]\nWe iterate this procedure again and again, drawing our trajectory. Naturally, taking smaller \\(\\Delta t\\) we should get better approximations, from a mathematical standpoint. In fact, one can show that the error we’re making is proportional to \\(\\Delta t\\). However, reducing \\(\\Delta t\\) has two undesirable effects: first, the calculation time will increase accordingly; second, because computers have limited precision when representing numbers, at each step we will make round off errors, and these will accumulate faster when the step size is small.\nIn practice, when we use Euler’s method we assume that \\(f(x)\\) is fixed during the step \\(\\Delta t\\) (which we now is generally not true). We can average across two points, yielding the so-called midpoint method:\n\\[\n\\begin{aligned}\ny_{t + \\Delta t} &= x_t + \\Delta_t f(x_t)\\\\\nx_{t + \\Delta t} &= x_t + \\frac{1}{2}(f(x_t) + f(y_{t + \\Delta t}))\n\\end{aligned}\n\\]\nwhere \\(y_{t + \\Delta t}\\) is what computed using Euler’s method, and the slope for the actual step is taken to be the average \\(f(x)\\) at the beginning and end of the step. One can show that the error is now proportional to \\((\\Delta t)^2\\), which is a good improvement.\nThe same logic applies when we take several intermediate steps, and average across them, as done for the Runge-Kutta methods.\nIn fact, the best software tries to pick small \\(\\Delta t\\) when \\(x(t)\\) is changing rapidly, and larger \\(\\Delta t\\) when \\(x(t)\\) is changing slowly. These adaptive-step methods are the state-of-the-art, and are implemented in the package deSolve in R."
  },
  {
    "objectID": "ch1.html#classic-papers",
    "href": "ch1.html#classic-papers",
    "title": "Models for a single population",
    "section": "",
    "text": "A brief paper discussing how to build models in biology:\n\nRichard Levins, 1966. The strategy of model building in population biology. American Scientist 54:421-431\n\nThis paper introduces the famous metapopulation model:\n\nRichard Levins, 1969. Some demographic and genetic consequences of environmental heterogeneity for biological control. Bull. Entomol. Soc. Am. 15:237–240.\n\nThis paper shows the onset of chaos in simple discrete-time models:\n\nRobert M. May, 1976. Simple mathematical models with very complicated dynamics. Nature 261:459-467\n\nThis paper discusses how simple models relates to experimental data on population growth:\n\nMichael P. Hassell, John H. Lawton, Robert M. May, 1976. Patterns of dynamical behavior in single species populations. Journal of Animal Ecology 45:471-486\n\nThe paper analyzing the dynamics of the spruce budworm:\n\nDonald Ludwig, D. D. Jones, Crawford S. Holling, 1978. Qualitative Analysis of Insect Outbreak Systems: The Spruce Budworm and Forest. Journal of Animal Ecology, 47:315-332"
  },
  {
    "objectID": "ch2.html",
    "href": "ch2.html",
    "title": "Models for two populations",
    "section": "",
    "text": "To start our exploration of more complex models, we consider two populations (\\(X\\) and \\(Y\\)), growing logistically on their own, that interact competitively:\n\\[\n\\begin{cases}\n\\dfrac{dX}{d\\tau} = X(r_1 - B_{11} X - B_{12}Y)\\\\\n\\dfrac{dY}{d\\tau} = Y(r_2 - B_{21} X - B_{22}Y)\\\\\n\\end{cases}\n\\]\nWhere all parameters are positive; the \\(r_i\\) are the intrinsic growth rates, and \\(B_{ij}\\) measures how much the growth of \\(i\\) is decreased when adding a unit of population \\(j\\).\n\n\n\n\n\n\nMatrices and vectors\n\n\n\n\n\nA matrix \\(A\\) is a rectangular array of numbers (the entries of the matrix, \\(A_{ij}\\)). For this class, we will consider matrices with either real entries (\\(A_{ij} \\in \\mathbb R; A_{ij} = \\alpha\\)), or complex entries (\\(A_{ij} \\in \\mathbb C; A_{ij}=\\alpha + i \\beta\\)). The size of the matrix is given by its number of rows \\(n\\) and its number of columns \\(m\\). To show the size explicitly, we use \\(A_{n \\times m}\\). If \\(n = m\\) the matrix is square.\nA (column) vector \\(b\\) is a matrix with a single column (i.e., size \\(n \\times 1\\)), and a row vector \\(a^T\\) is of size \\(1 \\times m\\). We use \\({}^T\\) to denote transposition, an operation that turns the rows into columns and vice versa: \\((A^T)_{ij} = A_{ji}\\); if \\(A_{n \\times m}\\), then \\(A^{T}_{m \\times n}\\).\nBasic operations that can be performed with matrices:\n\nTwo matrices can be added only if they have the same size \\(A + B = C\\), with \\(C_{ij} = A_{ij} + B_{ij}\\).\nTwo matrices can be multiplied if the number of columns of the first matrix matches the number of rows of the second matrix: \\(A_{n \\times m} B_{m \\times l} = C_{n \\times l}\\) with \\(C_{ij} = \\sum_{k = 1}^{m} A_{ik} B_{kj}\\). In general, \\(AB \\neq BA\\): matrices do not generally commute.\nIf two matrices have the same size, we can also take the Hadamard (element-by-element) product \\(A \\circ B = C\\), with \\(C_{ij} = A_{ij} B_{ij}\\).\n\nIn R, a vector can be defined by concatenation v &lt;- c(1,2,3), and a matrix by reshaping a vector M &lt;- matrix(c(1,2,3,4), 2, 2). Note that entries are filled by column; if you want to fill them by row use M &lt;- matrix(c(1,2,3,4), 2, 2, byrow = TRUE). The Hadamard product is coded as *, and the matrix multiplication as %*%\n\n\n\nWe can gather the variables and the parameters into two vectors and a matrix:\n\\[\nZ = (X, Y)^T\\quad r = (r_1, r_2)^T\\quad B = \\begin{pmatrix}\nB_{11} & B_{12}\\\\\nB_{21} & B_{22}\n\\end{pmatrix}\n\\]\nThus, the dynamics can be written as:\n\\[\n\\dfrac{d Z_i}{d\\tau} = Z_i (r_i - \\sum_j B_{ij} Z_j)\n\\]\nor, in vector form:\n\\[\n\\dfrac{dZ}{d\\tau} = D(Z)(r - BZ)\n\\]\nWhere \\(D(Z)\\) is a diagonal matrix, with \\(Z\\) on the diagonal, and zeros elsewhere.\nNon-dimensionalization\nWe define:\n\\[\nX = c_1 x \\quad Y = c_2 y \\quad \\tau = c_3 t\n\\]\nobtaining:\n\\[\n\\begin{cases}\n\\dfrac{dx}{dt} = x(c_3 r_1  - c_1 c_3 B_{11} x - c_2 c_3 B_{12}y)\\\\\n\\dfrac{dy}{dt} = y(c_3 r_2 - c_1  c_3 B_{21} x - c_2 c_3 B_{22}y)\\\\\n\\end{cases}\n\\]\nA convenient choice is:\n\\[\nc_3 = \\dfrac{1}{r_1}\\quad c_1 = \\dfrac{r_1}{B_{11}}\\quad c_2 = \\dfrac{r_1}{B_{22}}\n\\]\nYielding:\n\\[\n\\begin{cases}\n\\dfrac{dx}{dt} = x\\left(1  - x - \\dfrac{B_{12}}{B_{22}}y \\right)\\\\\n\\dfrac{dy}{d\\tau} = y\\left(\\dfrac{r_2}{r_1} - \\dfrac{B_{21}}{B_{11}} x - y \\right)\\\\\n\\end{cases}\n\\]\nWe define the ratio of intrinsic growth rates \\(\\rho = r_2 / r_1\\), the ratio between the effect of \\(y\\) on the growth of \\(x\\) and the effect on itself \\(A_{12} = B_{12} / B_{22}\\), and similarly \\(A_{21} = B_{21} / B_{11}\\), obtaining:\n\\[\n\\begin{cases}\n\\dfrac{dx}{dt} = x\\left(1  - x - A_{12 }y \\right)\\\\\n\\dfrac{dy}{d\\tau} = y\\left(\\rho - A_{21} x - y \\right)\\\\\n\\end{cases}\n\\]\nEquilibria\nThe system has a trivial equilibrium \\((x^\\star, y^\\star) = (0,0)\\), in which both species are absent. If \\(y\\) is absent, we obtain the marginal equilibrium \\((x^\\star, y^\\star) = (1,0)\\), and if \\(x\\) is absent, we have \\((x^\\star, y^\\star) = (0, \\rho)\\). Finally, we can have a coexistence equilibrium, as long as the two terms in parenthesis are simultaneously zero:\n\\[\n\\begin{cases}\n1-x^\\star-A_{12}y^\\star = 0\\\\\n\\rho - A_{21} x^\\star - y^\\star = 0\n\\end{cases}\n\\]\nSolving the first equation for \\(x^\\star\\), we obtain \\(x^\\star = 1 - A_{12} y^\\star\\); plugging this solution into the second equation yields:\n\\[\n\\begin{aligned}\n\\rho - A_{21} + A_{12}A_{21} y^\\star - y^\\star &= 0\\\\\ny^\\star &= \\dfrac{\\rho - A_{21}}{1 - A_{12}A_{21}}\n\\end{aligned}\n\\] and correspondingly:\n\\[\nx^\\star = \\dfrac{1 - A_{12} \\rho}{1 - A_{12}A_{21}}\n\\]\nIf both values of \\(x^\\star\\) and \\(y^\\star\\) are positive, we have a coexistence equilibrium, if not, then the point lies outside the nonnegative orthant \\(\\mathbb R^{2}_{0+}\\), and thus cannot be reached by the dynamics.\n\n\n\n\n\n\nSolving linear systems\n\n\n\n\n\nIn the equations above, either \\(x\\) (\\(y\\)) is zero, or the term in parenthesis is zero. If we define:\n\\[\nz = (x,y)^T \\quad s = (1, \\rho)^T \\quad A = \\begin{pmatrix}\n1 & A_{12}\\\\\nA_{21} & 1\n\\end{pmatrix}\n\\]\nwe have that both terms in parenthesis are simultaneously zero whenever:\n\\[\nAz^\\star = s\n\\]\nYou can solve a system of linear equations by inverting the matrix \\(A_{n \\times n}\\). A matrix \\(A\\) is called invertible if there is a matrix \\(B\\) such that:\n\\[\nAB = BA = I_n\n\\] where \\(I_n\\) is the identity matrix, a matrix with zero everywhere but the diagonal, and with the entries on the diagonal being all 1. The identity matrix is the neutral matrix for multiplication: \\(AI = IA = A\\).\nIf such a matrix \\(B\\) exists, it is called the inverse of \\(A\\), written as \\(A^{-1}\\). If a matrix is not invertible, it is called singular. For matrices with real or complex entries, the necessary and sufficient condition for invertibility is that the determinant of the matrix \\(\\det A \\neq 0\\).\nThe determinant of a \\(2 \\times 2\\) matrix \\(A\\) can be computed as:\n\\[\nA = \\begin{pmatrix}\na & b \\\\\nc & d\n\\end{pmatrix}\\quad \\det A = ad - bc\n\\]\nComputing a matrix inverse is typically quite involved. For a \\(2 \\times 2\\) matrix, you can write:\n\\[\nA^{-1} = \\dfrac{1}{ad - bc}\\begin{pmatrix}\nd & -b \\\\\n-c & a\n\\end{pmatrix}\n\\]\nFor the Lotka-Volterra system we have:\n\\[\n\\det A = 1 - A_{12} A_{21}\n\\]\nwhen the determinant is not zero, then\n\\[\n\\begin{aligned}\nA z^\\star &= s\\\\\nA^{-1} Az^\\star &= A^{-1}s\\\\\nI z^\\star &= A^{-1}s\\\\\nz^\\star &= A^{-1}s\\\\\nz^\\star &= \\dfrac{1}{1-A_{12}A_{21}}\\begin{pmatrix}\n1 & -A_{21}\\\\\n-A_{12} &1\n\\end{pmatrix} \\begin{pmatrix}\n1\\\\\n\\rho\n\\end{pmatrix}\\\\\nz^\\star &= \\dfrac{1}{1-A_{12}A_{21}}\\begin{pmatrix}\n1 - A_{21} \\rho\\\\\n\\rho - A_{12}\n\\end{pmatrix}\n\\end{aligned}\n\\]\nIn R, you can solve a system of equation using solve(A, b) where A is a square, invertible matrix, and b is a vector of appropriate size.\n\n\n\nThus, the model has three or four equilibria, depending on the parameters. Another way to see this is to think about the values of \\(y\\) making \\(dx/dt = 0\\), and viceversa.\nZero-growth isoclines\nTake the first equation, and set it to zero:\n\\[\nx\\left(1  - x - A_{12 }y \\right) = 0\n\\]\nequality is obtained when either \\(x =0\\) or \\(y = (1-x)/ A_{12}\\). This equation defines a line in the \\((x,y)\\) plane, called the phase plane. Similarly, if we take the second equation\n\\[\ny\\left(\\rho - A_{21} x - y \\right) = 0\n\\]\nwe see that this is zero whenever \\(y = 0\\) or when \\(y = \\rho - A_{21}x\\), another line in the phase plane. If the two lines meet in the positive quadrant, then we have the possibility of coexistence.\nFor example, take \\(\\rho = 1\\), \\(A_{12} = 1/3\\) and \\(A_{21} = 1/4\\):\n\n\n\n\n\nEach species grows at points that are below its zero-growth isocline, and declines at points that are above it. Thus, for each point in the phase plane we can determine the general direction of the trajectories:\n\n\n\n\n\nWe can use these arrows to classify the stability of the equilibria. For example, around \\((0,0)\\) arrows move away from the point; it is thus an unstable equilibrium. Similarly, the two marginal points have arrows pointing away from them, and are thus unstable; around the coexistence equilibrium, all arrows point back to it, indicating stability.\nIn fact, we can show trajectories converging to the coexistence equilibrium:\n\n\n\n\n\nDepending on the value of the parameters, we have four cases; two in which the two lines do not meet in the positive orthant; and two cases in which they do.\nThe isocline of zero growth for population \\(x\\) intercepts the x-axis at 1 and the y-axis at \\(1/A_{12}\\); the isocline of zero growth for population \\(y\\) intercepts the x-axis at \\(\\rho / A_{21}\\) and the y-axis at \\(\\rho\\).\n\nIf \\(1 &lt; \\rho / A_{21}\\) and \\(\\rho &gt; 1/A_{12}\\), the two isoclines do not meet in the positive orthant; the isocline for \\(y\\) is above that for \\(x\\); hence \\(y\\) will keep growing while \\(x\\) declines; eventually \\(y\\) will displace \\(x\\).\n\n\n\n\n\n\n\nIf \\(1 &gt; \\rho / A_{21}\\) and \\(\\rho &lt; 1/A_{12}\\), the two isoclines do not meet in the positive orthant; the isocline for \\(x\\) is above that for \\(y\\); hence \\(x\\) will keep growing while \\(y\\) declines; eventually \\(x\\) will displace \\(y\\).\n\n\n\n\n\n\n\nIf \\(1 &lt; \\rho / A_{21}\\) and \\(\\rho &lt; 1/A_{12}\\), the two isoclines meet in the positive orthant. Each species can invade the other when the other species is at its marginal equilibrium. The coexistence equilibrium is stable.\n\n\n\n\n\n\n\nIf \\(1 &gt; \\rho / A_{21}\\) and \\(\\rho &gt; 1/A_{12}\\), the two isoclines meet in the positive orthant. No population can invade the other when the other species is at its marginal equilibrium. The two marginal equilibria are (locally) stable. This is a case of bistability: depending on the initial conditions, we will end in one or the other equilibrium.\n\n\n\n\n\n\n\n\n\n\n\n\nExercise: Classify points using isoclines\n\n\n\n\n\nClassify the equilibria by analyzing the flow in the phase plane:\na)\n\n\n\n\n\nb)\n\n\n\n\n\n\n\n\nHaving seen how to classify the equilibria using a graphical method, we show an analytical approach that can be used for an arbitrary number of populations.\n\n\n\n\n\n\nEigenvalues and eigenvectors\n\n\n\n\n\nThe product of a matrix and a vector is another vector:\n\\[\nA x = b\n\\]\nEach matrix is associated with certain special vectors such that:\n\\[\nA v = \\lambda v\n\\] i.e., multiplying the vector with the matrix simply scales all the entries of the vector by a constant, \\(\\lambda\\). When this is the case, we say that \\(v\\) is an eigenvector of \\(A\\), with associated eigenvalue \\(\\lambda\\). Note that eigenvectors are defined up to a constant: if \\(v\\) is an eigenvector of \\(A\\), and \\(w = \\gamma v\\), then:\n\\[\nAw = \\gamma A v= \\gamma \\lambda v = \\lambda w\n\\]\nExample\n\\[\nA = \\begin{pmatrix}\n1 & 2\\\\\n4 & 3\n\\end{pmatrix}\\quad v = \\begin{pmatrix}\n1\\\\\n2\n\\end{pmatrix}\\quad\nAv = \\begin{pmatrix}\n5\\\\\n10\n\\end{pmatrix} = 5 v\n\\]\nThen \\(v= (1,2)^T\\) is an eigenvector of \\(A\\) with eigenvalue \\(\\lambda = 5\\).\nEigendecomposition\nA matrix \\(A\\) is called diagonalizable if there exists an invertible matrix \\(P\\) such that \\(PAP^{-1} = D\\), where \\(D\\) is a diagonal matrix, i.e., having nonzero values only on the diagonal.\nA diagonalizable matrix can be written as:\n\\[\nA = Q \\Lambda Q^{-1}\n\\]\nwhere each of the columns of \\(Q\\) is an eigenvector of \\(A\\), and \\(\\Lambda\\) is a diagonal matrix with the corresponding eigenvalues. This factorization (writing a matrix as a product of other matrices) is called the eigendecomposition of \\(A\\).\nYou can see that:\n\\[\n\\begin{aligned}\nA v &= \\lambda v\\\\\nA Q &= Q \\Lambda\\\\\nA &= Q \\Lambda Q^{-1}\n\\end{aligned}\n\\]\nThe trace of a matrix is the sum of the diagonal entries; it is also the sum of the eigenvalues:\n\\[\n\\text{Tr}\\, A = \\sum_i A_{ii} = \\sum_i \\lambda_i\n\\]\nThe determinant of a matrix is the product of its eigenvalues (and thus a singular matrix has at least one zero eigenvalue):\n\\[\n\\det A = \\prod_i \\lambda_i\n\\]\nA diagonalizable matrix of size has \\(n\\) eigenvalues (not necessarily distinct) and \\(n\\) corresponding eigenvectors. The number of nonzero eigenvalues is the rank of the matrix.\nComputing the eigenvalues of a matrix is very involved, and can be done analytically only for small matrices. The eigenvalues of \\(A\\) are the zeros of the characteristic polynomial:\n\\[\n\\det (A - \\lambda I) = p(\\lambda)\n\\]\nA matrix with real entries has eigenvalues that are either real, \\(\\lambda_i = \\alpha\\), or complex, \\(\\lambda = \\alpha + i \\beta\\); the complex root are paired: \\(\\lambda_{i,j} = \\alpha \\pm i \\beta\\) (complex conjugate eigenvalues). A symmetric matrix \\(A = A^T\\) has only real eigenvalues; a skew-symmetric matrix \\(A = -A^T\\) has only eigenvalues with real part zero.\nThe diagonal matrix \\(D(\\alpha)\\) has eigenvalues \\(\\alpha\\).\nThe eigenvalues of the inverse \\(A^{-1}\\) are the reciprocals of the eigenvalues of \\(A\\): if \\(A\\) has eigenvalue \\(\\lambda\\), then \\(A^{-1}\\) has eigenvalue \\(1/\\lambda\\). The eigenvectors of \\(A\\) and \\(A^{-1}\\) are the same. The transpose \\(A^T\\) has the same eigenvalues of \\(A\\); its eigenvectors are \\(A^T = (Q \\Lambda Q^{-1})^T = {Q^{-1}}^T \\Lambda Q^T\\)\nIf a matrix has only positive, real eigenvalues it is positive definite, if it has only nonnegative eigenvalues it is positive semi-definite; if it has only negative eigenvalues it is negative definite.\nIf \\(A\\) is positive definite, then\n\\[\n\\sum_i \\sum_j A_{ij} x_i x_j = x^T A x &gt; 0 \\quad \\forall x \\neq 0\n\\]\nIf \\(A\\) is symmetric, then it can be decomposed as:\n\\[\nA = A^T = Q \\Lambda Q^T\n\\]\ni.e., in this case \\(Q^{-1} = Q^T\\).\nFinding eigenvalues for \\(2\\times2\\) matrix\nThe matrix\n\\[\nA = \\begin{pmatrix}\na & b\\\\\nc & d\n\\end{pmatrix}\n\\]\nhas \\(\\text{Tr}\\, A = a+ d\\) and \\(\\det A = ad - bc\\). Then:\n\\[\n\\begin{cases}\n\\lambda_1 + \\lambda_2 = a + d\\\\\n\\lambda_1 \\lambda_2 = ad - bc\n\\end{cases}\n\\]\nand thus\n\\[\n\\lambda = \\dfrac{a + d \\pm \\sqrt{4bc + (a-d)^2}}{2} =\\dfrac{1}{2}\\left(\\text{Tr}{A} \\pm \\sqrt{(\\text{Tr}{A})^2 - 4 \\det A} \\right)\n\\]\nThe eigenvectors can be found by setting one of the entries to an arbitrary value (e.g., \\(v_1 = 1\\)), and solving the equations:\n\\[\nAv = \\lambda v\n\\]\nIn R, you can compute the eigenvalues and eigenvectors of a matrix \\(A\\) as eA &lt;- eigen(A); the function returns a list with the matrix of eigenvectors stored in eA$vectors and the vector of eigenvalues in eA$values.\n\n\n\n\n\nIn the previous lectures, we have approximated the behavior of \\(f(x)\\) around the equilibrium, to determine whether small perturbations would be buffered by the system. We can perform the same type of analysis here. However, now \\(dx_i / dt = f_i(x)\\) is a function of multiple populations, and therefore we need to Taylor-expand multivariate functions.\nIn analogy with the Talyor-expansion of functions of a single variable, we can write:\n\\[\nf_i(x^\\star + \\Delta x) = f_i(x^\\star) + \\sum_k \\left. \\dfrac{\\partial f_i(x)}{\\partial x_k} \\right|_{x^\\star} \\Delta x_k + \\dfrac{1}{2} \\sum_{k}\\sum_{l} \\left. \\dfrac{\\partial^2 f_i(x)}{\\partial x_k \\partial x_l} \\right|_{x^\\star} \\Delta x_k \\Delta x_l + \\cdots\n\\] As before, \\(f_i(x^\\star) = 0\\), and if we take only the second term (i.e., the term linear in \\(\\Delta x\\)) we can approximate the function as:\n\\[\nf_i(x^\\star + \\Delta x) \\approx \\sum_k \\left. J_{ik} \\right|_{x^\\star} \\Delta x_k\n\\]\nWhere we have defined the Jacobian matrix \\(J\\):\n\\[\nJ_{ij} = \\dfrac{\\partial f_i(x)}{\\partial x_j}\n\\] For each equilibrium in the system, we can obtain a different community matrix (the name is due to Levins) \\(M\\):\n\\[\nM = \\left. J \\right|_{x^\\star}\n\\]\nAs such, a system of ODEs has a single Jacobian, and as many community matrices as there are equilibria. As before, we assume that we have slightly perturbed the system at equilibrium, \\(x(t) = x^\\star + \\Delta x\\), where \\(\\Delta x\\) is assumed to be small, and then we approximate the dynamics:\n\\[\n\\dfrac{d\\Delta x}{dt} \\approx \\left. J \\right|_{x^\\star} \\Delta x\n\\]\ni.e., we need to solve a linear system of ODEs.\n\n\n\n\n\n\nSolving systems of linear ODEs\n\n\n\n\n\nConsider the system of first-order, autnonomous ODEs:\n\\[\n\\dfrac{dx}{dt} = Ax\n\\]\nIf the matrix \\(A\\) is diagonalizable, we can decompose the matrix as:\n\\[\nA = Q \\Lambda Q^{-1}\n\\]\nWe define a new system of equations, by changing the variables:\n\\[\ny = Q^{-1}x\\quad x = Q y\n\\]\nThen, by chain rule:\n\\[\n\\dfrac{dy}{dt} = Q^{-1} \\dfrac{d x}{dt} = Q^{-1}Q \\Lambda Q^{-1} x= \\Lambda Q^{-1} x = \\Lambda y\n\\]\nWe have decoupled all equations: now the \\(y_i\\) grow or decline independently of each other.\n\\[\n\\dfrac{dy_i}{dt} = \\lambda_i y_i\n\\]\nThis is in fact the equation for the exponential growth/decay, with solution \\(y_i(t) = y(0) e^{\\lambda_i t}\\).\nWe can bring these solutions back to the original form:\n\\[\ny(t) = e^{\\Lambda t} y(0)\n\\]\nwhere \\(e^\\Lambda t\\) is a diagonal matrix:\n\\[\ne^{\\Lambda t}= \\begin{pmatrix}\ne^{\\lambda_1 t} & 0 & \\cdots &0\\\\\n0 & e^{\\lambda_2 t} & \\cdots &0\\\\\n\\cdots & \\cdots & \\cdots & \\cdots\\\\\n0 & 0 & \\cdots & e^{\\lambda_n t}\\\\\n\\end{pmatrix}\n\\]\nThen:\n\\[\nx(t) = Q y(t) = Q e^{\\Lambda t} y(0) = Q e^{\\Lambda t} Q^{-1} x(0)\n\\]\nAllowing to easily compute the solution for any linear systems of ODEs.\nStability of the origin\nSuppose that \\(\\lambda_i\\) is a real, negative number; then \\(\\lim_{t \\to \\infty}e^{\\lambda_i t} = 0\\). If \\(\\lambda_i\\) is positive, on the other hand, then \\(\\lim_{t \\to \\infty}e^{\\lambda_i t} = \\infty\\). Thus, if any of the \\(\\lambda_i &gt; 0\\), the system will move to \\(\\infty\\) in the direction specified by the corresponding eigenvector.\nWhenever \\(\\lambda_i\\) is complex (e.g., generically, when \\(A\\) is not symmetric), then we need to consider:\n\\[\ne^{\\alpha t + i \\beta t} = e^{\\alpha t} e^{i \\beta t} = e^{\\alpha t} (\\cos \\beta + i \\sin \\beta )t\n\\]\nwhere we have used Euler’s formula. Importantly, \\((\\cos \\beta + i \\sin \\beta )\\) is bounded, and in fact its real (imaginary) part is \\(\\leq 1\\) (the equation describes a unit circle in the complex plane). Then, \\(\\lim_{t \\to \\infty} e^{\\alpha t + i \\beta t} = 0\\) if \\(\\alpha &lt; 0\\).\nTherefore, the vector \\(0_n\\) is an asymptotically stable equilibrium of the system \\(\\dfrac{dx}{dt} = A x\\) if and only if all the eigenvalues of \\(A\\) have negative real part.\nStability of the origin for \\(A_{2 \\times 2}\\)\nAs we have shown above, the eigenvalues of a \\(2\\times2\\) matrix \\(A\\):\n\\[\nA = \\begin{pmatrix}\na & b\\\\\nc & d\n\\end{pmatrix}\n\\]\nare:\n\\[\n\\lambda = \\dfrac{a + d \\pm \\sqrt{4bc + (a-d)^2}}{2}\n\\]\nWe can rewrite the values as:\n\\[\n\\lambda = \\dfrac{1}{2} \\left(\\text{Tr}A \\pm\\sqrt{\\left(\\text{Tr}A \\right)^2 - 4 \\det A} \\right)\n\\]\nIf the trace is negative, and the determinant positive, then the eigenvalues have negative real part, and thus the origin is stable for the corresponding system of linear ODEs. In fact, knowing the trace and the determinant is in this case sufficient to determine the type of dynamics around equilibrium:\n\n\n\nCharacterizing dynamics using trace and determinant\n\n\n\n\n\nTo probe the local asymptotic stability of the equilibria, we can:\n\nCalculate the Jacobian matrix, \\(J\\)\nPlug in an equilibrium, obtaining the corresponding community matrix \\(M\\)\nCompute the eigenvalues of \\(M\\), \\(\\lambda_i\\)\nIf all the eigenvalues have negative real part, \\(\\Re (\\lambda_i) &lt; 0\\), then the equilibrium is locally asymptotically stable; if any \\(\\Re (\\lambda_i) &gt; 0\\), then the equilibrium is unstable, and there are small perturbations that will amplify\n\nFor example, for the system above, we have:\n\\[\n\\begin{cases}\nf_x(x,y) = x- x^2 - A_{12}xy \\\\\nf_y(x,y) = \\rho y - A_{21} xy - y^2\n\\end{cases}\n\\]\n\\[\nJ = \\begin{pmatrix}\n(1 - 2 x - A_{12} y) & -A_{12} x\\\\\n-A_{21} y & (\\rho - 2 y - A_{21} x)\n\\end{pmatrix}\n\\] For \\((x^\\star, y^\\star) = (0,0)\\), we obtain:\n\\[\nM = \\begin{pmatrix}\n1 & 0\\\\\n0 & \\rho\n\\end{pmatrix}\n\\]\nwith eigenvalues \\(1\\) and \\(\\rho&gt;0\\): the equilibrium is unstable.\nFor the marginal equilibrium \\((x^\\star, y^\\star) = (1,0)\\), we obtain:\n\\[\nM = \\begin{pmatrix}\n-1  & -A_{12} \\\\\n0 & \\rho - A_{21}\n\\end{pmatrix}\n\\]\nThe eigenvalues are \\(-1\\) and \\(\\rho - A_{21}\\) and thus the equilibrium is stable whenever \\(\\rho &lt; A_{21}\\) and unstable when \\(\\rho &gt; A_{21}\\).\nFor the other marginal equilibrium \\((x^\\star, y^\\star) = (0,\\rho)\\), we obtain:\n\\[\nM = \\begin{pmatrix}\n1 - A_{12} \\rho & 0\\\\\n-A_{21} \\rho & -\\rho\n\\end{pmatrix}\n\\] with eigenvalues \\(-\\rho\\) and \\(1 - A_{12} \\rho\\). Thus, the equilibrium is stable whenever \\(\\rho &gt; 1/A_{12}\\) and unstable when \\(\\rho &lt; 1/A_{12}\\).\nFinally, whenever a feasible equilibrium \\((x^\\star, y^\\star) &gt; (0,0)\\) we have that the terms in parenthesis are zero. Thus \\((1 - x^\\star - A_{12} y^\\star) = 0\\) and \\((\\rho - y^\\star - A_{21} x^\\star) =0\\), yielding:\n\\[\nM = \\begin{pmatrix}\n- x^\\star & -A_{12} x^\\star\\\\\n-A_{21} y^\\star & -y^\\star\n\\end{pmatrix}\n\\]\nThe eigenvalues are:\n\\[\n\\lambda_{12} = \\dfrac{1}{2}\\left(-(x^\\star+y^\\star) \\pm \\sqrt{(x^\\star-y^\\star)^2 + 4 A_{12}A_{21} x^\\star y^\\star} \\right)\n\\]\nNote that if \\(A_{12}A_{21} = 1\\), then we have that the eigenvalues are \\(\\frac{1}{2}(-(x^\\star+y^\\star) \\pm (x^\\star+y^\\star))\\), and thus one of them is zero. Hence, the equilibrium is stable as long as \\(A_{12} A_{21} &lt; 1\\). One can also see that the term under the square root is always positive whenever \\(A_{12} A_{21}&gt;0\\), and thus the eigenvalues are always real.\n\n\n\n\n\n\nExercise: LV with mutualistic interactions\n\n\n\n\n\nConsider a LV model in which populations are facultative mutualists:\n\\[\n\\begin{cases}\n\\dfrac{dx}{dt} = x(1 - x + \\alpha y)\\\\\n\\dfrac{dy}{dt} = y(\\rho - y + \\beta x)\\\\\n\\end{cases}\n\\]\n\nfind all equilibria\nfor which combination of parameters will the system have a coexistence equilibrium?\ncompute the Jacobian matrix for the system, and the community matrices associated with each equilibrium\nclassify the equilibria according to their local asymptotic stability\n\n\n\n\n\n\n\n\nWe have a prey who would grow exponentially when the predator is absent, and a predator that would decline exponentially when the prey is absent. The two species interact, thus allowing for their coexistence:\n\\[\n\\begin{cases}\n\\dfrac{dX}{d\\tau} = \\rho X - \\alpha X Y = X(\\rho - \\alpha Y)\\\\\n\\dfrac{dY}{d\\tau} = -\\delta Y + \\beta X Y = Y(-\\delta + \\beta X)\n\\end{cases}\n\\]\nwhere all parameters are positive. There are two equilibria: \\((X, Y) = (0, 0)\\) and \\((X, Y) = \\left(\\frac{\\delta}{\\beta}, \\frac{\\rho}{\\alpha} \\right)\\).\nNondimensionalization To simplify the equation (but maintain all its important features), we can define two new variables and a new time scale:\n\\[\nX = c_1 x \\quad Y = c_2 y \\quad \\tau = c_3 t\n\\]\nUsing the new variables, we write:\n\\[\n\\begin{cases}\n\\dfrac{c_1}{c_3}\\dfrac{dx}{dt} = c_1 x(\\rho - \\alpha c_2 y)\\\\\n\\dfrac{c_2}{c_3}\\dfrac{dy}{dt} = c_2 y(-\\delta + \\beta c_1 x)\n\\end{cases}\n\\]\nand thus\n\\[\n\\begin{cases}\n\\dfrac{dx}{dt} = x(c_3 \\rho - \\alpha c_2 c_3 y)\\\\\n\\dfrac{dy}{dt} = y(-c_3 \\delta + \\beta c_1 c_3 x)\n\\end{cases}\n\\]\nIt is convenient to take \\(c_3 = 1/\\rho\\), \\(c_2 = \\rho / \\alpha\\), and \\(c_1 = \\rho / \\beta\\), thus simplifying the system to:\n\\[\n\\begin{cases}\n\\dfrac{dx}{dt} = x(1 - y)\\\\\n\\dfrac{dy}{dt} = y(-\\frac{\\delta}{\\rho} + x) = y(-\\alpha + x)\n\\end{cases}\n\\]\nWe can therefore analyze the case in which we have only a single free parameter, \\(\\alpha = \\rho / \\delta &gt; 0\\). The equilibria are \\((x^\\star,y^\\star) = (0,0)\\) and \\((x^\\star, y^\\star) = (\\alpha, 1)\\).\nIsoclines of net zero growth. Clearly, the first equation is zero when either the prey is absent, or the predator is at \\(y^\\star = 1\\); the second equation is zero when either the predator is absent or the prey is at \\(x^\\star = \\alpha\\); we can draw the two lines in a plane where we have \\(x\\) on the x-axis and \\(y\\) on the y-axis. The feasible (positive) equilibrium will be at the intersection of the two lines:\n\n\n\n\n\nDirection of trajectories\nWe have four quadrants surrounding the positive equilibrium:\n\n\\(x &lt; \\alpha, y &lt; 1\\): in the bottom-left corner, we have \\(dx/dt &gt; 0\\) and \\(dy/dt &lt; 0\\); accordingly, the prey will grow and the predator decline\n\\(x &gt; \\alpha, y &lt; 1\\): in the bottom-right corner, we have \\(dx/dt &gt; 0\\) and \\(dy/dt &gt; 0\\); accordingly, both populations will grow\n\\(x &gt; \\alpha, y &gt; 1\\): in the top-right corner, we have \\(dx/dt &lt; 0\\) and \\(dy/dt &gt; 0\\); the prey will decline, the predator grow\n\\(x &lt; \\alpha, y &gt; 1\\): in the top-left corner, we have \\(dx/dt &lt; 0\\) and \\(dy/dt &lt; 0\\); both populations will decline\n\nWe can show these directions visually, by computing \\((dx/dt, dy/dt)\\) at different values of \\((x, y)\\):\n\n\n\n\n\nWe would like to characterize the stability of the equilibria. The trivial equilibrium \\((0,0)\\) is clearly unstable, because the arrows move away from it. The flow for the system cycles counter-clockwise around the coexistence equilibrium; stability cannot be determined because trajectories could spiral away from the equilibrium, spiral toward the equilibrium, or form closed orbits.\nWe therefore compute the Jacobian:\n\\[\nJ = \\begin{pmatrix}\n1-y & -x\\\\\ny & x-\\alpha\n\\end{pmatrix}\n\\]\nPlugging \\((x^\\star, y^\\star) = (0,0)\\), we obtain:\n\\[\nM = \\begin{pmatrix}\n1 & 0\\\\\n0 & -\\alpha\n\\end{pmatrix}\n\\]\nwith eigenvalues \\(\\lambda = 1\\) and \\(\\lambda = -\\alpha\\); the equilibrium is indeed unstable.\nPlugging in the \\((x^\\star, y^\\star) = (\\alpha, 1)\\), we obtain the matrix:\n\\[\nM = \\begin{pmatrix}\n0 & -\\alpha\\\\\n1 & 0\n\\end{pmatrix}\n\\]\nwith purely imaginary eigenvalues \\(\\lambda = \\pm \\sqrt{-\\alpha} = \\pm i \\sqrt{\\alpha}\\). Because the real part is exactly zero, we have what is called a “center”: trajectories around the equilibrium form closed orbits.\nIf we look at the trajectories, we see the amplitude of the orbits is determined by the initial conditions:\n\n\n\n\n\n\n\nWe can write the dynamics for \\(dx / dy\\)—by chain rule:\n\\[\n\\dfrac{d x} {d y} = \\dfrac{x(1-y)}{y(-\\alpha + x)} = \\dfrac{x - xy}{-\\alpha y + xy}\n\\]\nThe equation is separable:\n\\[\n\\begin{aligned}\n(-\\alpha y + x y)d x &= (x-xy)dy\\\\\n\\left(-\\dfrac{\\alpha}{x} + 1 \\right)dx &= \\left(\\dfrac{1}{y}- 1\\right) dy\\\\\n\\int dx - \\alpha \\int \\dfrac{1}{x}dx &= \\int \\dfrac{1}{y} dy - \\int dy + \\mathcal c\\\\\nx - \\alpha \\log x &= \\log y - y + \\mathcal c\\\\\nx + y - \\alpha \\log x - \\log y &= \\mathcal c\n\\end{aligned}\n\\]\nAt the initial conditions, we have that:\n\\[\n\\left.V(x, y)\\right|_{(x_0, y_0)} = \\left(x+y-\\alpha \\log x - \\log y\\right)|_{(x_0, y_0)} = c_0\n\\]\nTaking the derivative w.r.t. time, we obtain:\n\\[\n\\begin{aligned}\n\\dfrac{dV}{dt} &= \\dfrac{dx}{dt} - \\alpha \\dfrac{1}{x}\\dfrac{dx}{dt} + \\dfrac{dy}{dt} - \\dfrac{1}{y} \\dfrac{dy}{dt}\\\\\n&= (x - \\alpha)(1-y)+ (y-1)(x-\\alpha)\\\\\n&=0\n\\end{aligned}\n\\]\nThus, the quantity is conserved: it is a constant of motion. The curves described by the trajectories connect all the points in the phase plane for which \\(x+y-\\alpha \\log x - \\log y = c_0\\).\n\n\n\nIn the classic LV predator-prey model, the prey grows exponentially if not kept in check by the predator. If we include a term to have the prey growing logistically, we obtain:\n\\[\n\\begin{cases}\n\\dfrac{dx}{dt} = x(1 - \\epsilon x - y)\\\\\n\\dfrac{dy}{dt} = y(-\\alpha + x)\n\\end{cases}\n\\]\nWe now have three equilibria: \\((x^\\star, y^\\star) = (0,0)\\), \\((x^\\star, y^\\star) = (\\frac{1}{\\epsilon},0)\\), and \\((x^\\star, y^\\star) = \\left(\\alpha, 1 - \\epsilon \\alpha\\right)\\). Compute the community matrix for the coexistence equilibrium:\n\\[\nJ = \\begin{pmatrix}\n(1 - 2 \\epsilon x - y) & -x\\\\\ny & x-\\alpha\n\\end{pmatrix}\n\\]\nSubstituting the equilibrium:\n\\[\nM = \\begin{pmatrix}\n- \\epsilon x^\\star & -x^\\star\\\\\ny^\\star & 0\n\\end{pmatrix}\n\\]\nThe eigenvalues are now:\n\\[\n\\lambda = \\dfrac{1}{2} \\left(-\\epsilon x^\\star \\pm \\sqrt{(\\epsilon x^\\star)^2 - 4 x^\\star y^\\star} \\right)\n\\]\nAnd thus have negative real part. Drawing the trajectories suggests global stability:\n\n\n\n\n\n\n\n\nIn 1977, BS Goh proposed a variation on the contant of motion found by Lotka and Volterra, that can be used as a Lyapunov function for the system to prove global stability. The function provides sufficient conditions, but not necessary conditions; i.e., if the function can be used to prove the stability of an equilibrium, the equilibrium is globally stable; however, there are cases in which the system is globally stable, and yet the function cannot be used to prove stability.\nFor two species, the function can be written as:\n\\[\nV(x, y) = \\left(x - x^\\star - x^\\star \\log \\dfrac{x}{x^\\star}\\right) + w \\left(y - y^\\star - y^\\star \\log \\dfrac{y}{y^\\star} \\right)\n\\]\nwhere \\(w&gt;0\\) can be chosen in the most convenient way. The function is always nonnegative and is zero only at equilibrium. Taking the derivative w.r.t time, we have:\n\\[\n\\dfrac{dV}{dt} = (x - x^\\star) \\dfrac{1}{x} \\dfrac{dx}{dt} + w (y - y^\\star)\\dfrac{1}{y} \\dfrac{dy}{dt}\n\\]\nIf we can prove that \\(dV/dt\\) is always negative unless the system is at equilibrium, we have proven the global asymptotic stability of the equilibrium.\nExample\nFor the predator-prey system with the prey growing logistically, with equilibrium \\((x^\\star, y^\\star) = \\left(\\alpha, 1 - \\epsilon \\alpha\\right)\\) (and thus \\(y^\\star = 1 - \\epsilon x^\\star\\)), we have:\n\\[\n\\begin{aligned}\n\\dfrac{dV}{dt} &= (x - x^\\star) (1 - \\epsilon x - y) + w(y-y^\\star)(x - \\alpha)\\\\\n&= (x - x^\\star) (1 - \\epsilon x - y) + w(y-y^\\star)(x - x^\\star)\\\\\n&=(x - x^\\star) (y^\\star + \\epsilon x^\\star - \\epsilon x - y) + w(y-y^\\star)(x - x^\\star)\\\\\n&=-\\epsilon (x - x^\\star)^2 + (w-1)(x - x^\\star)(y - y^\\star)\n\\end{aligned}\n\\]\nif we choose \\(w = 1\\), the function is negative unless \\(x = x^\\star\\):\n\\[\n\\dfrac{dV}{dt} =-\\epsilon (x - x^\\star)^2\n\\]\nbut when this is the case, we have \\(dy/dt = 0\\), and thus \\(y = y^\\star\\). The equilibrium is therefore globally asymptotically stable.\n\n\n\n\n\n\nExercise: Global stability for LV competition\n\n\n\n\n\nProve the global asymptotic stability of the coexistence equilibrium in the LV competition model above when \\(1 &lt; \\rho / A_{21}\\) and \\(\\rho &lt; 1/A_{12}\\).\n\n\n\n\n\n\n\nWe previously considered predator-prey interactions in which predation is proportional to the prey density, i.e.,\n\\[\n\\dfrac{dx}{dt} = x(r -a x) -\\alpha xy \\quad \\dfrac{dy}{dt} = -m y + \\beta \\alpha \\, xy\n\\]\nwhere \\(\\alpha\\) the probability of “effective encounters” (from the predator’s perspective) per unit time, and \\(\\beta\\) is the efficiency of converting prey to predators. The functional response is the rate at which predators capture prey. The model above shows a linear functional response, which is also known as a Holling type I functional response: there is a linear relationship between the number of prey eaten per unit time and the density of the prey.\n\n\n\n\n\nEcologists have traditionally focused on three different functional responses, which were originally described by Crawford S. Holling (b. 1930). The Holling type II assumes predation saturates with higher prey density. This model is justified if we assume predation is limited by prey handling time. Let \\(T\\) be total time, \\(T_{\\text{h}}\\) the handling time per prey item, and \\(X\\) the number of potential prey. We can model the number of prey caught, \\(V\\), as\n\\[\nV= \\alpha (T-VT_{\\text{h}})X\n\\]\nwhere \\(\\alpha\\) is a proportionality constant. The basic idea is that the number of prey caught is a function both of handling and searching time. Solving for \\(V\\), we obtain\n\\[\nV=\\frac{\\alpha TX}{1+\\alpha T_{\\text{h}}X}\n\\]\nwhich can be rewritten more generally as\n\\[\nf(X)= \\frac{cX}{a+X}\n\\]\nwhere \\(a\\) is the half-saturation constant.\nThe Holling type III functional response is a sigmoidal curve. It has the form\n\\[\nf(X)= \\frac{cX^2}{a^2+X^2}\n\\]\nIt assumes that predators are less efficient when prey density is low. At high prey density, their rate saturates.\nAre the differences between these forms dynamically important? They can be. Assume we have two species, a predator (consumer) \\(Y\\) and resource (prey) \\(X\\) that are stably coexisting. Assume that predation follows the type II functional response, i.e., that it saturates at high prey densities. The equations can be written as:\n\\[\n\\begin{cases}\n\\dfrac{dX}{d\\tau} = rX\\left(1-\\dfrac{X}{K}\\right)-\\dfrac{cXY}{b+X}\\\\\n\\dfrac{dY}{d\\tau} = -m Y + \\dfrac{aXY}{b+X}\n\\end{cases}\n\\]\nwhere \\(r\\) is the prey’s growth rate, \\(K\\) is the prey’s carrying capacity, \\(m\\) is the per capita mortality rate of the predator, and \\(a\\), \\(b\\), and \\(c\\) control the rate of predation and the conversion of prey into predators (efficiency).\nWe change variables to have fewer parameters:\n\\[\nX = c_1 x \\quad Y = c_2 y \\quad \\tau = c_3 t\n\\] For example, choosing \\(c_3 = 1/r\\), \\(c_1 = b\\), \\(c_2 = b r /c\\), and defining: \\(\\alpha = a / r\\), \\(\\beta = b / K\\) and \\(\\delta = m/r\\) we reduce the system to:\n\\[\n\\begin{cases}\n\\dfrac{dx}{dt} = x \\left(1 - \\beta x - \\dfrac{y}{1+x} \\right)\\\\\n\\dfrac{dy}{dt} = y \\left(- \\delta + \\dfrac{\\alpha x}{1+x} \\right)\\\\\n\\end{cases}\n\\]\nwhere all parameters are considered positive.\nEquilibria\nThe system has up to three equilibria: \\((x^\\star, y^\\star) = (0,0)\\) (trivial equilibrium); \\((x^\\star, y^\\star) = (1/\\beta,0)\\) (absence of the predator); \\((x^\\star, y^\\star) = (\\delta/(\\alpha - \\delta), \\alpha(\\alpha - (1 + \\beta) \\delta)/(\\alpha - \\delta)^2)\\) (coexistence equilibrium). With some calculations, one can show that the coexistence equilibrium is in the positive orthant whenever:\n\\[\n\\alpha &gt; \\delta (1 + \\beta)\n\\]\nNullclines\nAs before, we can draw the nullclines. The equation for the prey is zero whenever either the prey is absent, or:\n\\[\ny = - \\beta x^2 + (1-\\beta) x+1\n\\]\na downward facing parabola, intercepting the y-axis at \\(1\\), and the x-axis at \\(1/\\beta\\). The prey grows at points below the curve, and declines at points above it.\nThe equation for the predator is zero when the predator is absent or whenever:\n\\[\nx = \\dfrac{\\delta}{\\alpha - \\delta}\n\\]\na vertical line, which is in the positive orthant when \\(\\alpha &gt; \\delta\\).\n\n\n\n\n\nJacobian matrix\nWe compute the Jacobian, obtaining:\n\\[\nJ = \\begin{pmatrix}\n1 - 2 \\beta x - \\dfrac{y}{(1+x)^2} & - 1 + \\dfrac{1}{1+x}\\\\\n\\dfrac{\\alpha y}{(1+x)^2} & -\\delta + \\dfrac{\\alpha x}{1+x}\n\\end{pmatrix}\n\\] We first derive conditions for the stability of the coexistence equilibrium (when present):\n\\[\nM = \\begin{pmatrix}\n2 \\beta +\\dfrac{(\\beta +1) \\delta }{\\alpha } - \\dfrac{2 \\alpha  \\beta }{\\alpha -\\delta}& -\\dfrac{\\delta }{\\alpha } \\\\\n\\alpha -(\\beta +1) \\delta  & 0 \\\\\n\\end{pmatrix}\n\\]\nThe determinant of \\(M\\) is always positive when the coexistence equilibrium exists:\n\\[\n\\det M = \\dfrac{\\delta  (\\alpha -(\\beta +1) \\delta )}{\\alpha } &gt; 0 \\quad \\text{if}\\, \\alpha &gt; \\delta (1 + \\beta)\n\\]\nThe trace of the matrix, however, can be positive or negative depending on the parameter values:\n\\[\n\\text{Tr}M = 2 \\beta +\\dfrac{(\\beta +1) \\delta }{\\alpha } - \\dfrac{2 \\alpha  \\beta }{\\alpha -\\delta} &lt; 0\\quad \\text{if}\\, \\alpha&gt; \\delta (1 + \\beta)\\, \\text{and}\\, \\alpha -\\delta &lt; \\beta (\\alpha + \\delta)\n\\]\nThus, the stability depends on the carrying capacity, \\(1/\\beta\\). Specifically, increasing the carrying capacity (“enrichment”–subsidizing the prey) causes the equilibrium to move from stable to unstable.\nSimilarly, changes in the mortality \\(\\delta\\) or the efficiency of transformation \\(\\alpha\\),can also push the equilibrium from stable to unstable—specifically, to a limit cycle.\nFor example, let’s look at a case in which the equilibrium is stable:\n\n\n\n\n\nTrajectories converge to the equilibrium with dampened oscillations.\nNow a case in which the interior equilibrium is unstable:\n\n\n\n\n\ni.e., dynamics converge to a stable limit cycle. This is easier to see in the phase plane:\n\n\n\n\n\nWith oscillations, both the predator and prey can approach zero. If the prey goes extinct first, both will die out. Alternatively, the predator may go extinct first, and the prey will settle at its carrying capacity. The “paradox of enrichment” was first described by Michael Rosenzweig (b. 1941) in 1971. It demonstrates that the functional form of predation can have important dynamical consequences.\n\n\n\nThis is a model for host-parasitoid dynamics. Parasitoids are typically insects whose larvae develop inside an host, usually killing the host when they emerge. The model assumes that hosts are randomly distributed with density \\(H_t\\), parasitoids search for hosts with efficiency \\(a\\). Each parasitized host at time \\(t\\) will produce one parasitoid at time \\(t+1\\). Each non-parasitized host gives rise to \\(R&gt;1\\) new hosts at time \\(t+1\\). The probability of a host escaping an encounter with a parasitoid is \\(e^{-aP_t}\\). This gives us a simple model:\n\\[\n\\begin{cases}\n  H_{t+1}=RH_t e^{-aP_t}\\\\\n  P_{t+1}=H_t \\left(1- e^{-aP_t} \\right)\n\\end{cases}\n\\]\nWe could assume that parasitoids lay \\(c\\) eggs in hosts that survive to become parasitoids, which would yield \\(P_{t+1}=cH_t(1- e^{-aP_t})\\), but we’ll let \\(c=1\\). All the parameters are positive.\n\n\nWe want to find points for which:\n\\[\n\\begin{cases}\n      H_{t+1}=H_t=H^\\star\\\\\n      P_{t+1}=P_t =P^\\star\n    \\end{cases}\n\\]\nFirst, we can see that \\((H^\\star, P^\\star) = (0, 0)\\) is a trivial equilibrium. Then, if the predator is absent we have \\(H^\\star = R H^\\star\\), which happens only if \\(R = 1\\). If the predator is present, we have that at equilibrium \\(H^\\star = R H^\\star e^{-aP^\\star}\\) and thus\n\\[\n\\begin{aligned}\n1 &= R e^{-a P^\\star}\\\\\n0 &= \\log R - a P^\\star\\\\\nP^\\star &= \\dfrac{\\log R}{ a}\n\\end{aligned}\n\\] meaning that the parasitoid can reach a positive equilibrium only when \\(R &gt; 1\\). If this is the case, the equilibrium for the host is:\n\\[\n\\begin{aligned}\n\\dfrac{\\log R}{a} &= H^\\star \\left(1 -  \\dfrac{1}{R}\\right)\\\\\nH^\\star &= \\dfrac{R\\log R}{a(R-1)}\n\\end{aligned}\n\\]\n\n\n\n\n\n\n\n\n\nStability of discrete-time systems\n\n\n\n\n\nWe consider \\(x_t\\), a vector containing the population densities, and we have \\(x_{t+1} = f(x_t)\\), where each entry of \\(f(x_t)\\), \\(f_i(x_t)\\) is a function describing the dynamics of population \\(i\\). As done before, we want to evaluate the asymptotic stability of equilibria, i.e., vectors at which \\(f({x}^\\star) = x^\\star\\).\nWe take a perturbation of the equilibrium \\(x_t = {x}^\\star + p_t\\), and we Taylor-expand each \\(f_i(x_t)\\) around this point. Taking only the first two terms we find:\n\\[\n\\begin{aligned}\nf_i(x^\\star + p_t) &\\approx f_i(x^\\star) + \\sum_j \\left.\\dfrac{\\partial f_i}{\\partial x_j}\\right|_{x^\\star}(x_j^\\star + {p_j}_t - x_j^\\star)\\\\\n&\\approx x_j^\\star + \\sum_j \\left. J_{ij} \\right|_{x^\\star}{p_j}_t\n\\end{aligned}\n\\]\nWhich we can write in matrix form:\n\\[\n\\begin{aligned}\nx_{t + 1} &= f(x_t)\\\\\nx^\\star + p_{t+1} &= f(x^\\star + p_t)\\\\\nx^\\star + p_{t+1} &\\approx x^\\star + \\left. J\\right|_{x^\\star} p_t\\\\\np_{t+1} &\\approx Mp_t\n\\end{aligned}\n\\]\nWhere \\(M\\) again is the community matrix, and we have obtained a linear system in discrete time. Naturally, we can iterate:\n\\[\np_{t+2} = Mp_{t+1} = MMp_t= M^2p_t\n\\]\nand in general\n\\[\np_{t+n} = M^{n} p_t\n\\]\nIf the equilibrium is stable, eventually \\(p_{t+n} = 0_n\\), i.e., the perturbation will die out.\nConsider the real number \\(a\\). We have that:\n\\[\n\\begin{aligned}\n\\lim_{n \\to \\infty} |a|^n &= 0 & \\text{iff} \\quad |a| &lt; 1\\\\\n\\lim_{n \\to \\infty} |a|^n &= \\infty & \\text{iff} \\quad |a| &gt; 1\n\\end{aligned}\n\\]\nA similar result is found for matrices, but instead of taking the absolute value of the real number, we need to consider the spectral radius of the matrix, i.e., the largest modulus (absolute value) of its eigenvalues. An eigenvalue is in general a complex number \\(\\lambda = \\alpha + i \\beta\\). Its modulus is \\(|\\lambda|= \\sqrt{\\alpha^2 + \\beta^2}\\). We then have that the spectral radius \\(\\rho(A) = \\max |\\lambda_i|\\), where \\(\\lambda_i\\) are the eigenvalues of \\(A\\).\nThen\n\\[\n\\lim_{n \\to \\infty}A^n = 0_{n \\times n} \\quad \\text{iff } \\, \\rho(A) &lt; 1\n\\] As such, an equilibrium \\(x^\\star\\) is asymptotically stable if the associated community matrix \\(M\\) has spectral radius \\(\\rho(M) &lt; 1\\).\nFor a \\(2 \\times 2\\) matrix, we have that \\(\\text{Tr} A = t\\) and \\(\\det A = d\\); then\n\\[\n\\lambda = \\dfrac{1}{2} \\left(t \\pm \\sqrt{t^2 - 4d} \\right)\n\\]\nThere are two cases:\n\nwhen \\(t^2 &lt; 4d\\), both eigenvalues are complex: \\(\\lambda_1 = \\frac{1}{2} (t + i \\sqrt{4d -t^2})\\) and \\(\\lambda_2 = \\frac{1}{2} (t - i \\sqrt{4d -t^2})\\); but then \\(\\rho(A)^2 = \\Re(\\lambda_i)^2 + \\Im(\\lambda_i)^2 = \\lambda_i \\lambda_2 = \\det A\\), meaning that the condition for stability is simply \\(0&lt;\\det A &lt; 1\\). Combined with \\(t^2 &lt; 4d\\), yielding \\(|t| &lt; 2 \\sqrt{d} &lt; 2\\), we obtain:\n\n\\[\n|\\text{Tr}A| - 1&lt; \\det A &lt; 1\n\\]\n\nwhen \\(t^2 &gt; 4d\\) both eigenvalues are real, and thus the spectral radius is \\((|t|+\\sqrt{t^2 -4d})/2\\), which is less than one if \\(|t|-1 &lt; d\\) (from \\(|t| - 2 &gt; \\sqrt{t^2 - 4d}\\), \\(t^2 - 4 |t| + 4 &gt; t^2 - 4d\\)). Combining this condition with \\(|t| &lt;2\\), we have \\(t^2 &lt; 4\\) and thus \\(d &lt; 1\\), obtaining the same formula as above.\n\nAs done before, we can characterize the dynamics around the equilibrium point for a 2-dimensional system:\n\n\\(0&lt;\\lambda_1&lt;1&lt;\\lambda_2\\; \\implies\\) Saddle (unstable)\n\\(0&lt;\\lambda_1&lt;\\lambda_2&lt;1\\; \\implies\\) Stable node\n\\(\\lambda_2&gt;\\lambda_1&gt;1\\; \\implies\\) Unstable node\n\\(\\lambda=a \\pm ib, \\; |\\lambda|&lt;1, \\; b \\neq 0\\; \\implies\\) Stable spiral\n\\(\\lambda=a \\pm ib, \\; |\\lambda|&gt;1, \\; b \\neq 0\\; \\implies\\) Unstable spiral\n\\(\\lambda=a \\pm ib, \\; |\\lambda|=1, \\; b \\neq 0\\; \\implies\\) Center\n\\(-1&lt; \\lambda_1&lt;0, \\; \\lambda_2&lt;-1\\; \\implies\\) Oscillatory saddle (unstable)\n\\(\\lambda_1&gt;1, \\; \\lambda_2&gt;-1\\; \\implies\\) Oscillatory source (unstable)\n\n\n\n\nFor the Nicholson-Baley model, the Jacobian is:\n\\[\nJ = \\begin{pmatrix}\nR e^{-a P} & -a R H e^{-a P}\\\\\n1 - e^{-a P} & H a e^{-aP}\n\\end{pmatrix}\n\\]\nThe community matrix is therefore:\n\\[\nM = \\begin{pmatrix}\n1 & -\\dfrac{R \\log R}{R-1} \\\\\n\\dfrac{R-1}{R} & \\dfrac{\\log (R)}{R-1} \\\\\n\\end{pmatrix}\n\\] the determinant of \\(M\\) is\n\\[\n\\det M = \\dfrac{R \\log R}{R -1}\n\\]\nRemember that to have a coexistence equilibrium we need \\(R&gt;1\\). The determinant of \\(M\\) is greater than 1 if\n\\[\n\\begin{aligned}\nR \\log R &&gt; R-1\\\\\n-\\log \\dfrac{1}{R} &&gt; 1 - \\dfrac{1}{R}\\\\\n\\log r &&lt; r - 1\n\\end{aligned}\n\\] where \\(r = 1/R\\). The inequality is met for any \\(r &gt; 0\\) besides \\(r = 1\\). Hence, the equilibrium is always unstable.\n\n\n\n\n\n\nExercise: Spatial Nicholson-Bailey model (Long!)\n\n\n\n\n\nWe have studied the “mean field” Nicholson-Bailey model:\n\\[\n\\begin{aligned}\nH_{t+1}&=R\\,e^{-aP_t}H_t\\\\\nP_{t+1}&=c\\left(1-e^{-aP_t}\\right)H_t\n\\end{aligned}\n\\]\nWe now want to extend it to a \\(N \\times N\\) lattice, i.e., a grid in which in each cell we have local dynamics, and we allow neighboring cells to exchange individuals. The lattice is periodic, i.e., the top and the bottom boundaries of the grid are coincident, the right and the left boundaries are coincident, so that the system runs on a torus – a donut-shaped surface.\nWe write the dynamics for the density of the host and the parasitoid in each cell (\\(H_{ij}\\) and \\(P_{ij}\\)):\n\\[\n\\begin{aligned}\nH_{{ij}_{t+1}} &= R\\,e^{-a \\tilde{P}_{{ij}_t}} \\tilde{H}_{{ij}_t}\\\\\nP_{{ij}_{t+1}} &= c(1-e^{-a \\tilde{P}_{{ij}_t}}) \\tilde{H}_{{ij}_t}\n\\end{aligned}\n\\]\nwhere\n\\[\n  \\tilde{H}_{{ij}_t}=(1-d_h)H_{{ij}_t} +\\frac{d_h}{8} \\sum_{\\text{neighbors}\\, k,l}H_{{kl}_t}\n\\]\nthe sum is taken across the 8 nearest neighbors of the cell \\({i,j}\\). The parameter \\(d_h\\) is the dispersal rate of the host. Similarly,\n\\[\n\\tilde{P}_{{ij}_t} =(1-d_p) P_{{ij}_t}+\\frac{d_p}{8}\n  \\sum_{\\text{neighbors}\\, k,l} P_{{kl}_t}\n\\]\nStart with a \\(51 \\times 51\\) lattice, and set the density of host and parasites to zero everywhere but in cell \\(26,26\\), where \\(H_{26,26}(0)=4\\) and \\(P_{26,26}(0)=1\\). Set \\(d_h=p_h=0.1\\), \\(R=2.0\\), \\(a=c=1.0\\). Evolve the system for 1000 time steps and plot the density of host using image every 5 time steps (Note: R is really poor for doing animations. If you plot every time step and have a fast enough computer, you will get a nice “photosensitive epilectic seizure effect”).\n\n\nThere are at least three strategies to code the model. At each time step, we have to have the matrices for \\(H\\) and \\(P\\) at time \\(t\\) and use these to build the matrices at time \\(t+1\\). Then we can overwrite the matrices and repeat. The main problem is how to deal with the neighbors. We can:\n\nCompute the neighbors on the fly. This is very easy to implement (just remember that when a cell is at the border it disperses on the other side of the lattice). However, in R it is likely to be extremely slow.\nStore all the neighbors. Basically, you can have a matrix of \\((N^2)\\times 8\\) in which for every cell you store the neighbors. This is going to require some memory, but it should pay off in terms of speed.\nBuild a large matrix \\((N^2)\\times (N^2)\\) in which for each cell we have the dispersal rate to any other cell. The good point is that then the whole model becomes simple matrix multiplication, but it requires a lot of memory to store an enormous matrix whose elements are going to be 0 most of the times.\nOther solutions…\n\n\n\n\nHere’s the code that you could write using implementation 1. Choose any of the other method to implement your own code.\n\n# list the coordinates of the eight neighboring cells to a\n# particular cell of interest\nneighboring_cells &lt;- function(ii, jj, N){\n    # This is tedious to write, but fast to run\n    my_neighbors &lt;- matrix(0, 8, 2)\n    my_neighbors[1,] &lt;- c(ii+1, jj+1)\n    my_neighbors[2,] &lt;- c(ii+1, jj)\n    my_neighbors[3,] &lt;- c(ii+1, jj-1)\n    my_neighbors[4,] &lt;- c(ii, jj+1)\n    my_neighbors[5,] &lt;- c(ii, jj-1)\n    my_neighbors[6,] &lt;- c(ii-1, jj-1)\n    my_neighbors[7,] &lt;- c(ii-1, jj)\n    my_neighbors[8,] &lt;- c(ii-1, jj+1)\n    # Wrap the lattice by replacing off-grid elements with\n    # the first index on the opposite side of the grid\n    my_neighbors[my_neighbors == 0] &lt;- N\n    my_neighbors[my_neighbors == N+1] &lt;- 1\n    return(my_neighbors)\n}\n\n# Run the spatial Nicholson-Bailey model, staring with initial\n# matrices of host and parasitoid counts/locations H0 and P0,\n# dispersal rates dh and dp, host growth rate R, parasitoid\n# reproductive rate c, and parasitoid search efficiency a. The\n# remaining parameters set the number of time steps to take and\n# a logical flag for whether to plot the results or not.\nspatial_nicholson_bailey &lt;- function(H, P, dh, dp, R, c, a,\n                                     n_time_steps, plot_graph){\n    # Extract size of (square) grid from matrix of populations\n    N &lt;- nrow(H)\n    # For each time step\n    for (zz in 1:n_time_steps){\n        # Plot every 5 time steps (we use base plotting here\n        # because it is faster)\n        if (plot_graph == TRUE) if (zz %% 5 == 0) image(H)\n        # For each cell\n        for (ii in 1:N) {\n            for (jj in 1:N) {\n                # Find the neighbors\n                my_neighbors &lt;- neighboring_cells(ii, jj, N)\n                # Calculate the equilibrium values for each\n                # cell based on its neighbors\n                HStar &lt;- (1 - dh) * H[ii,jj] +\n                    dh * sum(H[my_neighbors])/8\n                PStar &lt;- (1 - dp) * P[ii,jj] +\n                    dp * sum(P[my_neighbors])/8\n                # Update the matrices\n                H[ii,jj] &lt;- R * HStar * exp(-a * PStar)\n                P[ii,jj] &lt;- c * HStar * (1 - exp(-a * PStar))\n            }\n        }\n    }\n    return(0)\n}\n\n# Initialize the system\nN &lt;- 51\nH &lt;- matrix(0, N, N)\nP &lt;- matrix(0, N, N)\n# put some hosts, parasitoids in the middle\nH[round(N/2), round(N/2)] &lt;- 4\nP[round(N/2), round(N/2)] &lt;- 1\n# Run the system\nspatial_nicholson_bailey(H, P, dh=0.2, dp=0.2, R=2, c=1, a=1,\n                         n_time_steps=100, plot_graph=TRUE)\n\n\n\n\n\n\n\n\n\nThe Lotka-Volterra predator-prey model was discovered independently by Alfred J. Lotka and Vito Volterra:\n\nAlfred J. Lotka, 1920. Analytical Note on Certain Rhythmic Relations in Organic Systems. PNAS 6 (7) 410-415\nVito Volterra, 1926. Fluctuations in the Abundance of a Species Considered Mathematically. Nature 118:558-60\n\nYou can read their exchange here.\nThe constant of motion was derived by Lotka in 1920:\n\nAlfred J. Lotka, 1920. Undamped oscillations derived from the law of mass action. Journal of the American Chemical Society 42:1595-1599\n\nVolterra considered many variations, including the competition between species. His results caught the eye of an experimentalist, who validated the principle of competitive exclusion using protozoans:\n\nG.F. Gause, 1934. Experimental Analysis of Vito Volterra’s Mathematical Theory of the Struggle for Existence. Science 79:16-17\n\nThe analysis of two-species competitive Lotka-Volterra inspired the so-called Modern Coexistence Theory:\n\nChesson, P. 2000. Mechanisms of Maintenance of Species Diversity. Annual Review of Ecology and Systematics 31:343-366\n\nOn functional responses:\n\nCrawford S. Holling, 1959. Some Characteristics of Simple Types of Predation and Parasitism. The Canadian Entomologist 91:385-398\n\nThe paper proposing the paradox of enrichment:\n\nRosenzweig, Michael, 1971. The Paradox of Enrichment. Science 171: 385–387\n\nMore on limit cycles in predator-prey systems:\n\nRobert M. May, 1972. Limit Cycles in Predator-Prey Communities Science 177:900-902\nMichael E. Gilpin, 1972. Enriched Predator-Prey Systems: Theoretical Stability Science 177:902-904\n\nThe Nicholson-Bailey model:\n\nA.J. Nicholson, V.A. Bailey, 1935. The Balance of Animal Populations. Part I. Proceedings of the Zoological Society of London. 105: 551–598\n\nand its spatial version:\n\nH.N. Comins, M.P. Hassell, R.M. May, 1992. The Spatial Dynamics of Host–Parasitoid Systems. Journal of Animal Ecology 61:735-748"
  },
  {
    "objectID": "ch2.html#lotka-volterra-competition",
    "href": "ch2.html#lotka-volterra-competition",
    "title": "Models for two populations",
    "section": "",
    "text": "To start our exploration of more complex models, we consider two populations (\\(X\\) and \\(Y\\)), growing logistically on their own, that interact competitively:\n\\[\n\\begin{cases}\n\\dfrac{dX}{d\\tau} = X(r_1 - B_{11} X - B_{12}Y)\\\\\n\\dfrac{dY}{d\\tau} = Y(r_2 - B_{21} X - B_{22}Y)\\\\\n\\end{cases}\n\\]\nWhere all parameters are positive; the \\(r_i\\) are the intrinsic growth rates, and \\(B_{ij}\\) measures how much the growth of \\(i\\) is decreased when adding a unit of population \\(j\\).\n\n\n\n\n\n\nMatrices and vectors\n\n\n\n\n\nA matrix \\(A\\) is a rectangular array of numbers (the entries of the matrix, \\(A_{ij}\\)). For this class, we will consider matrices with either real entries (\\(A_{ij} \\in \\mathbb R; A_{ij} = \\alpha\\)), or complex entries (\\(A_{ij} \\in \\mathbb C; A_{ij}=\\alpha + i \\beta\\)). The size of the matrix is given by its number of rows \\(n\\) and its number of columns \\(m\\). To show the size explicitly, we use \\(A_{n \\times m}\\). If \\(n = m\\) the matrix is square.\nA (column) vector \\(b\\) is a matrix with a single column (i.e., size \\(n \\times 1\\)), and a row vector \\(a^T\\) is of size \\(1 \\times m\\). We use \\({}^T\\) to denote transposition, an operation that turns the rows into columns and vice versa: \\((A^T)_{ij} = A_{ji}\\); if \\(A_{n \\times m}\\), then \\(A^{T}_{m \\times n}\\).\nBasic operations that can be performed with matrices:\n\nTwo matrices can be added only if they have the same size \\(A + B = C\\), with \\(C_{ij} = A_{ij} + B_{ij}\\).\nTwo matrices can be multiplied if the number of columns of the first matrix matches the number of rows of the second matrix: \\(A_{n \\times m} B_{m \\times l} = C_{n \\times l}\\) with \\(C_{ij} = \\sum_{k = 1}^{m} A_{ik} B_{kj}\\). In general, \\(AB \\neq BA\\): matrices do not generally commute.\nIf two matrices have the same size, we can also take the Hadamard (element-by-element) product \\(A \\circ B = C\\), with \\(C_{ij} = A_{ij} B_{ij}\\).\n\nIn R, a vector can be defined by concatenation v &lt;- c(1,2,3), and a matrix by reshaping a vector M &lt;- matrix(c(1,2,3,4), 2, 2). Note that entries are filled by column; if you want to fill them by row use M &lt;- matrix(c(1,2,3,4), 2, 2, byrow = TRUE). The Hadamard product is coded as *, and the matrix multiplication as %*%\n\n\n\nWe can gather the variables and the parameters into two vectors and a matrix:\n\\[\nZ = (X, Y)^T\\quad r = (r_1, r_2)^T\\quad B = \\begin{pmatrix}\nB_{11} & B_{12}\\\\\nB_{21} & B_{22}\n\\end{pmatrix}\n\\]\nThus, the dynamics can be written as:\n\\[\n\\dfrac{d Z_i}{d\\tau} = Z_i (r_i - \\sum_j B_{ij} Z_j)\n\\]\nor, in vector form:\n\\[\n\\dfrac{dZ}{d\\tau} = D(Z)(r - BZ)\n\\]\nWhere \\(D(Z)\\) is a diagonal matrix, with \\(Z\\) on the diagonal, and zeros elsewhere.\nNon-dimensionalization\nWe define:\n\\[\nX = c_1 x \\quad Y = c_2 y \\quad \\tau = c_3 t\n\\]\nobtaining:\n\\[\n\\begin{cases}\n\\dfrac{dx}{dt} = x(c_3 r_1  - c_1 c_3 B_{11} x - c_2 c_3 B_{12}y)\\\\\n\\dfrac{dy}{dt} = y(c_3 r_2 - c_1  c_3 B_{21} x - c_2 c_3 B_{22}y)\\\\\n\\end{cases}\n\\]\nA convenient choice is:\n\\[\nc_3 = \\dfrac{1}{r_1}\\quad c_1 = \\dfrac{r_1}{B_{11}}\\quad c_2 = \\dfrac{r_1}{B_{22}}\n\\]\nYielding:\n\\[\n\\begin{cases}\n\\dfrac{dx}{dt} = x\\left(1  - x - \\dfrac{B_{12}}{B_{22}}y \\right)\\\\\n\\dfrac{dy}{d\\tau} = y\\left(\\dfrac{r_2}{r_1} - \\dfrac{B_{21}}{B_{11}} x - y \\right)\\\\\n\\end{cases}\n\\]\nWe define the ratio of intrinsic growth rates \\(\\rho = r_2 / r_1\\), the ratio between the effect of \\(y\\) on the growth of \\(x\\) and the effect on itself \\(A_{12} = B_{12} / B_{22}\\), and similarly \\(A_{21} = B_{21} / B_{11}\\), obtaining:\n\\[\n\\begin{cases}\n\\dfrac{dx}{dt} = x\\left(1  - x - A_{12 }y \\right)\\\\\n\\dfrac{dy}{d\\tau} = y\\left(\\rho - A_{21} x - y \\right)\\\\\n\\end{cases}\n\\]\nEquilibria\nThe system has a trivial equilibrium \\((x^\\star, y^\\star) = (0,0)\\), in which both species are absent. If \\(y\\) is absent, we obtain the marginal equilibrium \\((x^\\star, y^\\star) = (1,0)\\), and if \\(x\\) is absent, we have \\((x^\\star, y^\\star) = (0, \\rho)\\). Finally, we can have a coexistence equilibrium, as long as the two terms in parenthesis are simultaneously zero:\n\\[\n\\begin{cases}\n1-x^\\star-A_{12}y^\\star = 0\\\\\n\\rho - A_{21} x^\\star - y^\\star = 0\n\\end{cases}\n\\]\nSolving the first equation for \\(x^\\star\\), we obtain \\(x^\\star = 1 - A_{12} y^\\star\\); plugging this solution into the second equation yields:\n\\[\n\\begin{aligned}\n\\rho - A_{21} + A_{12}A_{21} y^\\star - y^\\star &= 0\\\\\ny^\\star &= \\dfrac{\\rho - A_{21}}{1 - A_{12}A_{21}}\n\\end{aligned}\n\\] and correspondingly:\n\\[\nx^\\star = \\dfrac{1 - A_{12} \\rho}{1 - A_{12}A_{21}}\n\\]\nIf both values of \\(x^\\star\\) and \\(y^\\star\\) are positive, we have a coexistence equilibrium, if not, then the point lies outside the nonnegative orthant \\(\\mathbb R^{2}_{0+}\\), and thus cannot be reached by the dynamics.\n\n\n\n\n\n\nSolving linear systems\n\n\n\n\n\nIn the equations above, either \\(x\\) (\\(y\\)) is zero, or the term in parenthesis is zero. If we define:\n\\[\nz = (x,y)^T \\quad s = (1, \\rho)^T \\quad A = \\begin{pmatrix}\n1 & A_{12}\\\\\nA_{21} & 1\n\\end{pmatrix}\n\\]\nwe have that both terms in parenthesis are simultaneously zero whenever:\n\\[\nAz^\\star = s\n\\]\nYou can solve a system of linear equations by inverting the matrix \\(A_{n \\times n}\\). A matrix \\(A\\) is called invertible if there is a matrix \\(B\\) such that:\n\\[\nAB = BA = I_n\n\\] where \\(I_n\\) is the identity matrix, a matrix with zero everywhere but the diagonal, and with the entries on the diagonal being all 1. The identity matrix is the neutral matrix for multiplication: \\(AI = IA = A\\).\nIf such a matrix \\(B\\) exists, it is called the inverse of \\(A\\), written as \\(A^{-1}\\). If a matrix is not invertible, it is called singular. For matrices with real or complex entries, the necessary and sufficient condition for invertibility is that the determinant of the matrix \\(\\det A \\neq 0\\).\nThe determinant of a \\(2 \\times 2\\) matrix \\(A\\) can be computed as:\n\\[\nA = \\begin{pmatrix}\na & b \\\\\nc & d\n\\end{pmatrix}\\quad \\det A = ad - bc\n\\]\nComputing a matrix inverse is typically quite involved. For a \\(2 \\times 2\\) matrix, you can write:\n\\[\nA^{-1} = \\dfrac{1}{ad - bc}\\begin{pmatrix}\nd & -b \\\\\n-c & a\n\\end{pmatrix}\n\\]\nFor the Lotka-Volterra system we have:\n\\[\n\\det A = 1 - A_{12} A_{21}\n\\]\nwhen the determinant is not zero, then\n\\[\n\\begin{aligned}\nA z^\\star &= s\\\\\nA^{-1} Az^\\star &= A^{-1}s\\\\\nI z^\\star &= A^{-1}s\\\\\nz^\\star &= A^{-1}s\\\\\nz^\\star &= \\dfrac{1}{1-A_{12}A_{21}}\\begin{pmatrix}\n1 & -A_{21}\\\\\n-A_{12} &1\n\\end{pmatrix} \\begin{pmatrix}\n1\\\\\n\\rho\n\\end{pmatrix}\\\\\nz^\\star &= \\dfrac{1}{1-A_{12}A_{21}}\\begin{pmatrix}\n1 - A_{21} \\rho\\\\\n\\rho - A_{12}\n\\end{pmatrix}\n\\end{aligned}\n\\]\nIn R, you can solve a system of equation using solve(A, b) where A is a square, invertible matrix, and b is a vector of appropriate size.\n\n\n\nThus, the model has three or four equilibria, depending on the parameters. Another way to see this is to think about the values of \\(y\\) making \\(dx/dt = 0\\), and viceversa.\nZero-growth isoclines\nTake the first equation, and set it to zero:\n\\[\nx\\left(1  - x - A_{12 }y \\right) = 0\n\\]\nequality is obtained when either \\(x =0\\) or \\(y = (1-x)/ A_{12}\\). This equation defines a line in the \\((x,y)\\) plane, called the phase plane. Similarly, if we take the second equation\n\\[\ny\\left(\\rho - A_{21} x - y \\right) = 0\n\\]\nwe see that this is zero whenever \\(y = 0\\) or when \\(y = \\rho - A_{21}x\\), another line in the phase plane. If the two lines meet in the positive quadrant, then we have the possibility of coexistence.\nFor example, take \\(\\rho = 1\\), \\(A_{12} = 1/3\\) and \\(A_{21} = 1/4\\):\n\n\n\n\n\nEach species grows at points that are below its zero-growth isocline, and declines at points that are above it. Thus, for each point in the phase plane we can determine the general direction of the trajectories:\n\n\n\n\n\nWe can use these arrows to classify the stability of the equilibria. For example, around \\((0,0)\\) arrows move away from the point; it is thus an unstable equilibrium. Similarly, the two marginal points have arrows pointing away from them, and are thus unstable; around the coexistence equilibrium, all arrows point back to it, indicating stability.\nIn fact, we can show trajectories converging to the coexistence equilibrium:\n\n\n\n\n\nDepending on the value of the parameters, we have four cases; two in which the two lines do not meet in the positive orthant; and two cases in which they do.\nThe isocline of zero growth for population \\(x\\) intercepts the x-axis at 1 and the y-axis at \\(1/A_{12}\\); the isocline of zero growth for population \\(y\\) intercepts the x-axis at \\(\\rho / A_{21}\\) and the y-axis at \\(\\rho\\).\n\nIf \\(1 &lt; \\rho / A_{21}\\) and \\(\\rho &gt; 1/A_{12}\\), the two isoclines do not meet in the positive orthant; the isocline for \\(y\\) is above that for \\(x\\); hence \\(y\\) will keep growing while \\(x\\) declines; eventually \\(y\\) will displace \\(x\\).\n\n\n\n\n\n\n\nIf \\(1 &gt; \\rho / A_{21}\\) and \\(\\rho &lt; 1/A_{12}\\), the two isoclines do not meet in the positive orthant; the isocline for \\(x\\) is above that for \\(y\\); hence \\(x\\) will keep growing while \\(y\\) declines; eventually \\(x\\) will displace \\(y\\).\n\n\n\n\n\n\n\nIf \\(1 &lt; \\rho / A_{21}\\) and \\(\\rho &lt; 1/A_{12}\\), the two isoclines meet in the positive orthant. Each species can invade the other when the other species is at its marginal equilibrium. The coexistence equilibrium is stable.\n\n\n\n\n\n\n\nIf \\(1 &gt; \\rho / A_{21}\\) and \\(\\rho &gt; 1/A_{12}\\), the two isoclines meet in the positive orthant. No population can invade the other when the other species is at its marginal equilibrium. The two marginal equilibria are (locally) stable. This is a case of bistability: depending on the initial conditions, we will end in one or the other equilibrium.\n\n\n\n\n\n\n\n\n\n\n\n\nExercise: Classify points using isoclines\n\n\n\n\n\nClassify the equilibria by analyzing the flow in the phase plane:\na)\n\n\n\n\n\nb)\n\n\n\n\n\n\n\n\nHaving seen how to classify the equilibria using a graphical method, we show an analytical approach that can be used for an arbitrary number of populations.\n\n\n\n\n\n\nEigenvalues and eigenvectors\n\n\n\n\n\nThe product of a matrix and a vector is another vector:\n\\[\nA x = b\n\\]\nEach matrix is associated with certain special vectors such that:\n\\[\nA v = \\lambda v\n\\] i.e., multiplying the vector with the matrix simply scales all the entries of the vector by a constant, \\(\\lambda\\). When this is the case, we say that \\(v\\) is an eigenvector of \\(A\\), with associated eigenvalue \\(\\lambda\\). Note that eigenvectors are defined up to a constant: if \\(v\\) is an eigenvector of \\(A\\), and \\(w = \\gamma v\\), then:\n\\[\nAw = \\gamma A v= \\gamma \\lambda v = \\lambda w\n\\]\nExample\n\\[\nA = \\begin{pmatrix}\n1 & 2\\\\\n4 & 3\n\\end{pmatrix}\\quad v = \\begin{pmatrix}\n1\\\\\n2\n\\end{pmatrix}\\quad\nAv = \\begin{pmatrix}\n5\\\\\n10\n\\end{pmatrix} = 5 v\n\\]\nThen \\(v= (1,2)^T\\) is an eigenvector of \\(A\\) with eigenvalue \\(\\lambda = 5\\).\nEigendecomposition\nA matrix \\(A\\) is called diagonalizable if there exists an invertible matrix \\(P\\) such that \\(PAP^{-1} = D\\), where \\(D\\) is a diagonal matrix, i.e., having nonzero values only on the diagonal.\nA diagonalizable matrix can be written as:\n\\[\nA = Q \\Lambda Q^{-1}\n\\]\nwhere each of the columns of \\(Q\\) is an eigenvector of \\(A\\), and \\(\\Lambda\\) is a diagonal matrix with the corresponding eigenvalues. This factorization (writing a matrix as a product of other matrices) is called the eigendecomposition of \\(A\\).\nYou can see that:\n\\[\n\\begin{aligned}\nA v &= \\lambda v\\\\\nA Q &= Q \\Lambda\\\\\nA &= Q \\Lambda Q^{-1}\n\\end{aligned}\n\\]\nThe trace of a matrix is the sum of the diagonal entries; it is also the sum of the eigenvalues:\n\\[\n\\text{Tr}\\, A = \\sum_i A_{ii} = \\sum_i \\lambda_i\n\\]\nThe determinant of a matrix is the product of its eigenvalues (and thus a singular matrix has at least one zero eigenvalue):\n\\[\n\\det A = \\prod_i \\lambda_i\n\\]\nA diagonalizable matrix of size has \\(n\\) eigenvalues (not necessarily distinct) and \\(n\\) corresponding eigenvectors. The number of nonzero eigenvalues is the rank of the matrix.\nComputing the eigenvalues of a matrix is very involved, and can be done analytically only for small matrices. The eigenvalues of \\(A\\) are the zeros of the characteristic polynomial:\n\\[\n\\det (A - \\lambda I) = p(\\lambda)\n\\]\nA matrix with real entries has eigenvalues that are either real, \\(\\lambda_i = \\alpha\\), or complex, \\(\\lambda = \\alpha + i \\beta\\); the complex root are paired: \\(\\lambda_{i,j} = \\alpha \\pm i \\beta\\) (complex conjugate eigenvalues). A symmetric matrix \\(A = A^T\\) has only real eigenvalues; a skew-symmetric matrix \\(A = -A^T\\) has only eigenvalues with real part zero.\nThe diagonal matrix \\(D(\\alpha)\\) has eigenvalues \\(\\alpha\\).\nThe eigenvalues of the inverse \\(A^{-1}\\) are the reciprocals of the eigenvalues of \\(A\\): if \\(A\\) has eigenvalue \\(\\lambda\\), then \\(A^{-1}\\) has eigenvalue \\(1/\\lambda\\). The eigenvectors of \\(A\\) and \\(A^{-1}\\) are the same. The transpose \\(A^T\\) has the same eigenvalues of \\(A\\); its eigenvectors are \\(A^T = (Q \\Lambda Q^{-1})^T = {Q^{-1}}^T \\Lambda Q^T\\)\nIf a matrix has only positive, real eigenvalues it is positive definite, if it has only nonnegative eigenvalues it is positive semi-definite; if it has only negative eigenvalues it is negative definite.\nIf \\(A\\) is positive definite, then\n\\[\n\\sum_i \\sum_j A_{ij} x_i x_j = x^T A x &gt; 0 \\quad \\forall x \\neq 0\n\\]\nIf \\(A\\) is symmetric, then it can be decomposed as:\n\\[\nA = A^T = Q \\Lambda Q^T\n\\]\ni.e., in this case \\(Q^{-1} = Q^T\\).\nFinding eigenvalues for \\(2\\times2\\) matrix\nThe matrix\n\\[\nA = \\begin{pmatrix}\na & b\\\\\nc & d\n\\end{pmatrix}\n\\]\nhas \\(\\text{Tr}\\, A = a+ d\\) and \\(\\det A = ad - bc\\). Then:\n\\[\n\\begin{cases}\n\\lambda_1 + \\lambda_2 = a + d\\\\\n\\lambda_1 \\lambda_2 = ad - bc\n\\end{cases}\n\\]\nand thus\n\\[\n\\lambda = \\dfrac{a + d \\pm \\sqrt{4bc + (a-d)^2}}{2} =\\dfrac{1}{2}\\left(\\text{Tr}{A} \\pm \\sqrt{(\\text{Tr}{A})^2 - 4 \\det A} \\right)\n\\]\nThe eigenvectors can be found by setting one of the entries to an arbitrary value (e.g., \\(v_1 = 1\\)), and solving the equations:\n\\[\nAv = \\lambda v\n\\]\nIn R, you can compute the eigenvalues and eigenvectors of a matrix \\(A\\) as eA &lt;- eigen(A); the function returns a list with the matrix of eigenvectors stored in eA$vectors and the vector of eigenvalues in eA$values.\n\n\n\n\n\nIn the previous lectures, we have approximated the behavior of \\(f(x)\\) around the equilibrium, to determine whether small perturbations would be buffered by the system. We can perform the same type of analysis here. However, now \\(dx_i / dt = f_i(x)\\) is a function of multiple populations, and therefore we need to Taylor-expand multivariate functions.\nIn analogy with the Talyor-expansion of functions of a single variable, we can write:\n\\[\nf_i(x^\\star + \\Delta x) = f_i(x^\\star) + \\sum_k \\left. \\dfrac{\\partial f_i(x)}{\\partial x_k} \\right|_{x^\\star} \\Delta x_k + \\dfrac{1}{2} \\sum_{k}\\sum_{l} \\left. \\dfrac{\\partial^2 f_i(x)}{\\partial x_k \\partial x_l} \\right|_{x^\\star} \\Delta x_k \\Delta x_l + \\cdots\n\\] As before, \\(f_i(x^\\star) = 0\\), and if we take only the second term (i.e., the term linear in \\(\\Delta x\\)) we can approximate the function as:\n\\[\nf_i(x^\\star + \\Delta x) \\approx \\sum_k \\left. J_{ik} \\right|_{x^\\star} \\Delta x_k\n\\]\nWhere we have defined the Jacobian matrix \\(J\\):\n\\[\nJ_{ij} = \\dfrac{\\partial f_i(x)}{\\partial x_j}\n\\] For each equilibrium in the system, we can obtain a different community matrix (the name is due to Levins) \\(M\\):\n\\[\nM = \\left. J \\right|_{x^\\star}\n\\]\nAs such, a system of ODEs has a single Jacobian, and as many community matrices as there are equilibria. As before, we assume that we have slightly perturbed the system at equilibrium, \\(x(t) = x^\\star + \\Delta x\\), where \\(\\Delta x\\) is assumed to be small, and then we approximate the dynamics:\n\\[\n\\dfrac{d\\Delta x}{dt} \\approx \\left. J \\right|_{x^\\star} \\Delta x\n\\]\ni.e., we need to solve a linear system of ODEs.\n\n\n\n\n\n\nSolving systems of linear ODEs\n\n\n\n\n\nConsider the system of first-order, autnonomous ODEs:\n\\[\n\\dfrac{dx}{dt} = Ax\n\\]\nIf the matrix \\(A\\) is diagonalizable, we can decompose the matrix as:\n\\[\nA = Q \\Lambda Q^{-1}\n\\]\nWe define a new system of equations, by changing the variables:\n\\[\ny = Q^{-1}x\\quad x = Q y\n\\]\nThen, by chain rule:\n\\[\n\\dfrac{dy}{dt} = Q^{-1} \\dfrac{d x}{dt} = Q^{-1}Q \\Lambda Q^{-1} x= \\Lambda Q^{-1} x = \\Lambda y\n\\]\nWe have decoupled all equations: now the \\(y_i\\) grow or decline independently of each other.\n\\[\n\\dfrac{dy_i}{dt} = \\lambda_i y_i\n\\]\nThis is in fact the equation for the exponential growth/decay, with solution \\(y_i(t) = y(0) e^{\\lambda_i t}\\).\nWe can bring these solutions back to the original form:\n\\[\ny(t) = e^{\\Lambda t} y(0)\n\\]\nwhere \\(e^\\Lambda t\\) is a diagonal matrix:\n\\[\ne^{\\Lambda t}= \\begin{pmatrix}\ne^{\\lambda_1 t} & 0 & \\cdots &0\\\\\n0 & e^{\\lambda_2 t} & \\cdots &0\\\\\n\\cdots & \\cdots & \\cdots & \\cdots\\\\\n0 & 0 & \\cdots & e^{\\lambda_n t}\\\\\n\\end{pmatrix}\n\\]\nThen:\n\\[\nx(t) = Q y(t) = Q e^{\\Lambda t} y(0) = Q e^{\\Lambda t} Q^{-1} x(0)\n\\]\nAllowing to easily compute the solution for any linear systems of ODEs.\nStability of the origin\nSuppose that \\(\\lambda_i\\) is a real, negative number; then \\(\\lim_{t \\to \\infty}e^{\\lambda_i t} = 0\\). If \\(\\lambda_i\\) is positive, on the other hand, then \\(\\lim_{t \\to \\infty}e^{\\lambda_i t} = \\infty\\). Thus, if any of the \\(\\lambda_i &gt; 0\\), the system will move to \\(\\infty\\) in the direction specified by the corresponding eigenvector.\nWhenever \\(\\lambda_i\\) is complex (e.g., generically, when \\(A\\) is not symmetric), then we need to consider:\n\\[\ne^{\\alpha t + i \\beta t} = e^{\\alpha t} e^{i \\beta t} = e^{\\alpha t} (\\cos \\beta + i \\sin \\beta )t\n\\]\nwhere we have used Euler’s formula. Importantly, \\((\\cos \\beta + i \\sin \\beta )\\) is bounded, and in fact its real (imaginary) part is \\(\\leq 1\\) (the equation describes a unit circle in the complex plane). Then, \\(\\lim_{t \\to \\infty} e^{\\alpha t + i \\beta t} = 0\\) if \\(\\alpha &lt; 0\\).\nTherefore, the vector \\(0_n\\) is an asymptotically stable equilibrium of the system \\(\\dfrac{dx}{dt} = A x\\) if and only if all the eigenvalues of \\(A\\) have negative real part.\nStability of the origin for \\(A_{2 \\times 2}\\)\nAs we have shown above, the eigenvalues of a \\(2\\times2\\) matrix \\(A\\):\n\\[\nA = \\begin{pmatrix}\na & b\\\\\nc & d\n\\end{pmatrix}\n\\]\nare:\n\\[\n\\lambda = \\dfrac{a + d \\pm \\sqrt{4bc + (a-d)^2}}{2}\n\\]\nWe can rewrite the values as:\n\\[\n\\lambda = \\dfrac{1}{2} \\left(\\text{Tr}A \\pm\\sqrt{\\left(\\text{Tr}A \\right)^2 - 4 \\det A} \\right)\n\\]\nIf the trace is negative, and the determinant positive, then the eigenvalues have negative real part, and thus the origin is stable for the corresponding system of linear ODEs. In fact, knowing the trace and the determinant is in this case sufficient to determine the type of dynamics around equilibrium:\n\n\n\nCharacterizing dynamics using trace and determinant\n\n\n\n\n\nTo probe the local asymptotic stability of the equilibria, we can:\n\nCalculate the Jacobian matrix, \\(J\\)\nPlug in an equilibrium, obtaining the corresponding community matrix \\(M\\)\nCompute the eigenvalues of \\(M\\), \\(\\lambda_i\\)\nIf all the eigenvalues have negative real part, \\(\\Re (\\lambda_i) &lt; 0\\), then the equilibrium is locally asymptotically stable; if any \\(\\Re (\\lambda_i) &gt; 0\\), then the equilibrium is unstable, and there are small perturbations that will amplify\n\nFor example, for the system above, we have:\n\\[\n\\begin{cases}\nf_x(x,y) = x- x^2 - A_{12}xy \\\\\nf_y(x,y) = \\rho y - A_{21} xy - y^2\n\\end{cases}\n\\]\n\\[\nJ = \\begin{pmatrix}\n(1 - 2 x - A_{12} y) & -A_{12} x\\\\\n-A_{21} y & (\\rho - 2 y - A_{21} x)\n\\end{pmatrix}\n\\] For \\((x^\\star, y^\\star) = (0,0)\\), we obtain:\n\\[\nM = \\begin{pmatrix}\n1 & 0\\\\\n0 & \\rho\n\\end{pmatrix}\n\\]\nwith eigenvalues \\(1\\) and \\(\\rho&gt;0\\): the equilibrium is unstable.\nFor the marginal equilibrium \\((x^\\star, y^\\star) = (1,0)\\), we obtain:\n\\[\nM = \\begin{pmatrix}\n-1  & -A_{12} \\\\\n0 & \\rho - A_{21}\n\\end{pmatrix}\n\\]\nThe eigenvalues are \\(-1\\) and \\(\\rho - A_{21}\\) and thus the equilibrium is stable whenever \\(\\rho &lt; A_{21}\\) and unstable when \\(\\rho &gt; A_{21}\\).\nFor the other marginal equilibrium \\((x^\\star, y^\\star) = (0,\\rho)\\), we obtain:\n\\[\nM = \\begin{pmatrix}\n1 - A_{12} \\rho & 0\\\\\n-A_{21} \\rho & -\\rho\n\\end{pmatrix}\n\\] with eigenvalues \\(-\\rho\\) and \\(1 - A_{12} \\rho\\). Thus, the equilibrium is stable whenever \\(\\rho &gt; 1/A_{12}\\) and unstable when \\(\\rho &lt; 1/A_{12}\\).\nFinally, whenever a feasible equilibrium \\((x^\\star, y^\\star) &gt; (0,0)\\) we have that the terms in parenthesis are zero. Thus \\((1 - x^\\star - A_{12} y^\\star) = 0\\) and \\((\\rho - y^\\star - A_{21} x^\\star) =0\\), yielding:\n\\[\nM = \\begin{pmatrix}\n- x^\\star & -A_{12} x^\\star\\\\\n-A_{21} y^\\star & -y^\\star\n\\end{pmatrix}\n\\]\nThe eigenvalues are:\n\\[\n\\lambda_{12} = \\dfrac{1}{2}\\left(-(x^\\star+y^\\star) \\pm \\sqrt{(x^\\star-y^\\star)^2 + 4 A_{12}A_{21} x^\\star y^\\star} \\right)\n\\]\nNote that if \\(A_{12}A_{21} = 1\\), then we have that the eigenvalues are \\(\\frac{1}{2}(-(x^\\star+y^\\star) \\pm (x^\\star+y^\\star))\\), and thus one of them is zero. Hence, the equilibrium is stable as long as \\(A_{12} A_{21} &lt; 1\\). One can also see that the term under the square root is always positive whenever \\(A_{12} A_{21}&gt;0\\), and thus the eigenvalues are always real.\n\n\n\n\n\n\nExercise: LV with mutualistic interactions\n\n\n\n\n\nConsider a LV model in which populations are facultative mutualists:\n\\[\n\\begin{cases}\n\\dfrac{dx}{dt} = x(1 - x + \\alpha y)\\\\\n\\dfrac{dy}{dt} = y(\\rho - y + \\beta x)\\\\\n\\end{cases}\n\\]\n\nfind all equilibria\nfor which combination of parameters will the system have a coexistence equilibrium?\ncompute the Jacobian matrix for the system, and the community matrices associated with each equilibrium\nclassify the equilibria according to their local asymptotic stability"
  },
  {
    "objectID": "ch2.html#lotka-volterra-predator-prey-model",
    "href": "ch2.html#lotka-volterra-predator-prey-model",
    "title": "Models for two populations",
    "section": "",
    "text": "We have a prey who would grow exponentially when the predator is absent, and a predator that would decline exponentially when the prey is absent. The two species interact, thus allowing for their coexistence:\n\\[\n\\begin{cases}\n\\dfrac{dX}{d\\tau} = \\rho X - \\alpha X Y = X(\\rho - \\alpha Y)\\\\\n\\dfrac{dY}{d\\tau} = -\\delta Y + \\beta X Y = Y(-\\delta + \\beta X)\n\\end{cases}\n\\]\nwhere all parameters are positive. There are two equilibria: \\((X, Y) = (0, 0)\\) and \\((X, Y) = \\left(\\frac{\\delta}{\\beta}, \\frac{\\rho}{\\alpha} \\right)\\).\nNondimensionalization To simplify the equation (but maintain all its important features), we can define two new variables and a new time scale:\n\\[\nX = c_1 x \\quad Y = c_2 y \\quad \\tau = c_3 t\n\\]\nUsing the new variables, we write:\n\\[\n\\begin{cases}\n\\dfrac{c_1}{c_3}\\dfrac{dx}{dt} = c_1 x(\\rho - \\alpha c_2 y)\\\\\n\\dfrac{c_2}{c_3}\\dfrac{dy}{dt} = c_2 y(-\\delta + \\beta c_1 x)\n\\end{cases}\n\\]\nand thus\n\\[\n\\begin{cases}\n\\dfrac{dx}{dt} = x(c_3 \\rho - \\alpha c_2 c_3 y)\\\\\n\\dfrac{dy}{dt} = y(-c_3 \\delta + \\beta c_1 c_3 x)\n\\end{cases}\n\\]\nIt is convenient to take \\(c_3 = 1/\\rho\\), \\(c_2 = \\rho / \\alpha\\), and \\(c_1 = \\rho / \\beta\\), thus simplifying the system to:\n\\[\n\\begin{cases}\n\\dfrac{dx}{dt} = x(1 - y)\\\\\n\\dfrac{dy}{dt} = y(-\\frac{\\delta}{\\rho} + x) = y(-\\alpha + x)\n\\end{cases}\n\\]\nWe can therefore analyze the case in which we have only a single free parameter, \\(\\alpha = \\rho / \\delta &gt; 0\\). The equilibria are \\((x^\\star,y^\\star) = (0,0)\\) and \\((x^\\star, y^\\star) = (\\alpha, 1)\\).\nIsoclines of net zero growth. Clearly, the first equation is zero when either the prey is absent, or the predator is at \\(y^\\star = 1\\); the second equation is zero when either the predator is absent or the prey is at \\(x^\\star = \\alpha\\); we can draw the two lines in a plane where we have \\(x\\) on the x-axis and \\(y\\) on the y-axis. The feasible (positive) equilibrium will be at the intersection of the two lines:\n\n\n\n\n\nDirection of trajectories\nWe have four quadrants surrounding the positive equilibrium:\n\n\\(x &lt; \\alpha, y &lt; 1\\): in the bottom-left corner, we have \\(dx/dt &gt; 0\\) and \\(dy/dt &lt; 0\\); accordingly, the prey will grow and the predator decline\n\\(x &gt; \\alpha, y &lt; 1\\): in the bottom-right corner, we have \\(dx/dt &gt; 0\\) and \\(dy/dt &gt; 0\\); accordingly, both populations will grow\n\\(x &gt; \\alpha, y &gt; 1\\): in the top-right corner, we have \\(dx/dt &lt; 0\\) and \\(dy/dt &gt; 0\\); the prey will decline, the predator grow\n\\(x &lt; \\alpha, y &gt; 1\\): in the top-left corner, we have \\(dx/dt &lt; 0\\) and \\(dy/dt &lt; 0\\); both populations will decline\n\nWe can show these directions visually, by computing \\((dx/dt, dy/dt)\\) at different values of \\((x, y)\\):\n\n\n\n\n\nWe would like to characterize the stability of the equilibria. The trivial equilibrium \\((0,0)\\) is clearly unstable, because the arrows move away from it. The flow for the system cycles counter-clockwise around the coexistence equilibrium; stability cannot be determined because trajectories could spiral away from the equilibrium, spiral toward the equilibrium, or form closed orbits.\nWe therefore compute the Jacobian:\n\\[\nJ = \\begin{pmatrix}\n1-y & -x\\\\\ny & x-\\alpha\n\\end{pmatrix}\n\\]\nPlugging \\((x^\\star, y^\\star) = (0,0)\\), we obtain:\n\\[\nM = \\begin{pmatrix}\n1 & 0\\\\\n0 & -\\alpha\n\\end{pmatrix}\n\\]\nwith eigenvalues \\(\\lambda = 1\\) and \\(\\lambda = -\\alpha\\); the equilibrium is indeed unstable.\nPlugging in the \\((x^\\star, y^\\star) = (\\alpha, 1)\\), we obtain the matrix:\n\\[\nM = \\begin{pmatrix}\n0 & -\\alpha\\\\\n1 & 0\n\\end{pmatrix}\n\\]\nwith purely imaginary eigenvalues \\(\\lambda = \\pm \\sqrt{-\\alpha} = \\pm i \\sqrt{\\alpha}\\). Because the real part is exactly zero, we have what is called a “center”: trajectories around the equilibrium form closed orbits.\nIf we look at the trajectories, we see the amplitude of the orbits is determined by the initial conditions:\n\n\n\n\n\n\n\nWe can write the dynamics for \\(dx / dy\\)—by chain rule:\n\\[\n\\dfrac{d x} {d y} = \\dfrac{x(1-y)}{y(-\\alpha + x)} = \\dfrac{x - xy}{-\\alpha y + xy}\n\\]\nThe equation is separable:\n\\[\n\\begin{aligned}\n(-\\alpha y + x y)d x &= (x-xy)dy\\\\\n\\left(-\\dfrac{\\alpha}{x} + 1 \\right)dx &= \\left(\\dfrac{1}{y}- 1\\right) dy\\\\\n\\int dx - \\alpha \\int \\dfrac{1}{x}dx &= \\int \\dfrac{1}{y} dy - \\int dy + \\mathcal c\\\\\nx - \\alpha \\log x &= \\log y - y + \\mathcal c\\\\\nx + y - \\alpha \\log x - \\log y &= \\mathcal c\n\\end{aligned}\n\\]\nAt the initial conditions, we have that:\n\\[\n\\left.V(x, y)\\right|_{(x_0, y_0)} = \\left(x+y-\\alpha \\log x - \\log y\\right)|_{(x_0, y_0)} = c_0\n\\]\nTaking the derivative w.r.t. time, we obtain:\n\\[\n\\begin{aligned}\n\\dfrac{dV}{dt} &= \\dfrac{dx}{dt} - \\alpha \\dfrac{1}{x}\\dfrac{dx}{dt} + \\dfrac{dy}{dt} - \\dfrac{1}{y} \\dfrac{dy}{dt}\\\\\n&= (x - \\alpha)(1-y)+ (y-1)(x-\\alpha)\\\\\n&=0\n\\end{aligned}\n\\]\nThus, the quantity is conserved: it is a constant of motion. The curves described by the trajectories connect all the points in the phase plane for which \\(x+y-\\alpha \\log x - \\log y = c_0\\).\n\n\n\nIn the classic LV predator-prey model, the prey grows exponentially if not kept in check by the predator. If we include a term to have the prey growing logistically, we obtain:\n\\[\n\\begin{cases}\n\\dfrac{dx}{dt} = x(1 - \\epsilon x - y)\\\\\n\\dfrac{dy}{dt} = y(-\\alpha + x)\n\\end{cases}\n\\]\nWe now have three equilibria: \\((x^\\star, y^\\star) = (0,0)\\), \\((x^\\star, y^\\star) = (\\frac{1}{\\epsilon},0)\\), and \\((x^\\star, y^\\star) = \\left(\\alpha, 1 - \\epsilon \\alpha\\right)\\). Compute the community matrix for the coexistence equilibrium:\n\\[\nJ = \\begin{pmatrix}\n(1 - 2 \\epsilon x - y) & -x\\\\\ny & x-\\alpha\n\\end{pmatrix}\n\\]\nSubstituting the equilibrium:\n\\[\nM = \\begin{pmatrix}\n- \\epsilon x^\\star & -x^\\star\\\\\ny^\\star & 0\n\\end{pmatrix}\n\\]\nThe eigenvalues are now:\n\\[\n\\lambda = \\dfrac{1}{2} \\left(-\\epsilon x^\\star \\pm \\sqrt{(\\epsilon x^\\star)^2 - 4 x^\\star y^\\star} \\right)\n\\]\nAnd thus have negative real part. Drawing the trajectories suggests global stability:\n\n\n\n\n\n\n\n\nIn 1977, BS Goh proposed a variation on the contant of motion found by Lotka and Volterra, that can be used as a Lyapunov function for the system to prove global stability. The function provides sufficient conditions, but not necessary conditions; i.e., if the function can be used to prove the stability of an equilibrium, the equilibrium is globally stable; however, there are cases in which the system is globally stable, and yet the function cannot be used to prove stability.\nFor two species, the function can be written as:\n\\[\nV(x, y) = \\left(x - x^\\star - x^\\star \\log \\dfrac{x}{x^\\star}\\right) + w \\left(y - y^\\star - y^\\star \\log \\dfrac{y}{y^\\star} \\right)\n\\]\nwhere \\(w&gt;0\\) can be chosen in the most convenient way. The function is always nonnegative and is zero only at equilibrium. Taking the derivative w.r.t time, we have:\n\\[\n\\dfrac{dV}{dt} = (x - x^\\star) \\dfrac{1}{x} \\dfrac{dx}{dt} + w (y - y^\\star)\\dfrac{1}{y} \\dfrac{dy}{dt}\n\\]\nIf we can prove that \\(dV/dt\\) is always negative unless the system is at equilibrium, we have proven the global asymptotic stability of the equilibrium.\nExample\nFor the predator-prey system with the prey growing logistically, with equilibrium \\((x^\\star, y^\\star) = \\left(\\alpha, 1 - \\epsilon \\alpha\\right)\\) (and thus \\(y^\\star = 1 - \\epsilon x^\\star\\)), we have:\n\\[\n\\begin{aligned}\n\\dfrac{dV}{dt} &= (x - x^\\star) (1 - \\epsilon x - y) + w(y-y^\\star)(x - \\alpha)\\\\\n&= (x - x^\\star) (1 - \\epsilon x - y) + w(y-y^\\star)(x - x^\\star)\\\\\n&=(x - x^\\star) (y^\\star + \\epsilon x^\\star - \\epsilon x - y) + w(y-y^\\star)(x - x^\\star)\\\\\n&=-\\epsilon (x - x^\\star)^2 + (w-1)(x - x^\\star)(y - y^\\star)\n\\end{aligned}\n\\]\nif we choose \\(w = 1\\), the function is negative unless \\(x = x^\\star\\):\n\\[\n\\dfrac{dV}{dt} =-\\epsilon (x - x^\\star)^2\n\\]\nbut when this is the case, we have \\(dy/dt = 0\\), and thus \\(y = y^\\star\\). The equilibrium is therefore globally asymptotically stable.\n\n\n\n\n\n\nExercise: Global stability for LV competition\n\n\n\n\n\nProve the global asymptotic stability of the coexistence equilibrium in the LV competition model above when \\(1 &lt; \\rho / A_{21}\\) and \\(\\rho &lt; 1/A_{12}\\)."
  },
  {
    "objectID": "ch2.html#functional-responses-and-the-paradox-of-enrichment",
    "href": "ch2.html#functional-responses-and-the-paradox-of-enrichment",
    "title": "Models for two populations",
    "section": "",
    "text": "We previously considered predator-prey interactions in which predation is proportional to the prey density, i.e.,\n\\[\n\\dfrac{dx}{dt} = x(r -a x) -\\alpha xy \\quad \\dfrac{dy}{dt} = -m y + \\beta \\alpha \\, xy\n\\]\nwhere \\(\\alpha\\) the probability of “effective encounters” (from the predator’s perspective) per unit time, and \\(\\beta\\) is the efficiency of converting prey to predators. The functional response is the rate at which predators capture prey. The model above shows a linear functional response, which is also known as a Holling type I functional response: there is a linear relationship between the number of prey eaten per unit time and the density of the prey.\n\n\n\n\n\nEcologists have traditionally focused on three different functional responses, which were originally described by Crawford S. Holling (b. 1930). The Holling type II assumes predation saturates with higher prey density. This model is justified if we assume predation is limited by prey handling time. Let \\(T\\) be total time, \\(T_{\\text{h}}\\) the handling time per prey item, and \\(X\\) the number of potential prey. We can model the number of prey caught, \\(V\\), as\n\\[\nV= \\alpha (T-VT_{\\text{h}})X\n\\]\nwhere \\(\\alpha\\) is a proportionality constant. The basic idea is that the number of prey caught is a function both of handling and searching time. Solving for \\(V\\), we obtain\n\\[\nV=\\frac{\\alpha TX}{1+\\alpha T_{\\text{h}}X}\n\\]\nwhich can be rewritten more generally as\n\\[\nf(X)= \\frac{cX}{a+X}\n\\]\nwhere \\(a\\) is the half-saturation constant.\nThe Holling type III functional response is a sigmoidal curve. It has the form\n\\[\nf(X)= \\frac{cX^2}{a^2+X^2}\n\\]\nIt assumes that predators are less efficient when prey density is low. At high prey density, their rate saturates.\nAre the differences between these forms dynamically important? They can be. Assume we have two species, a predator (consumer) \\(Y\\) and resource (prey) \\(X\\) that are stably coexisting. Assume that predation follows the type II functional response, i.e., that it saturates at high prey densities. The equations can be written as:\n\\[\n\\begin{cases}\n\\dfrac{dX}{d\\tau} = rX\\left(1-\\dfrac{X}{K}\\right)-\\dfrac{cXY}{b+X}\\\\\n\\dfrac{dY}{d\\tau} = -m Y + \\dfrac{aXY}{b+X}\n\\end{cases}\n\\]\nwhere \\(r\\) is the prey’s growth rate, \\(K\\) is the prey’s carrying capacity, \\(m\\) is the per capita mortality rate of the predator, and \\(a\\), \\(b\\), and \\(c\\) control the rate of predation and the conversion of prey into predators (efficiency).\nWe change variables to have fewer parameters:\n\\[\nX = c_1 x \\quad Y = c_2 y \\quad \\tau = c_3 t\n\\] For example, choosing \\(c_3 = 1/r\\), \\(c_1 = b\\), \\(c_2 = b r /c\\), and defining: \\(\\alpha = a / r\\), \\(\\beta = b / K\\) and \\(\\delta = m/r\\) we reduce the system to:\n\\[\n\\begin{cases}\n\\dfrac{dx}{dt} = x \\left(1 - \\beta x - \\dfrac{y}{1+x} \\right)\\\\\n\\dfrac{dy}{dt} = y \\left(- \\delta + \\dfrac{\\alpha x}{1+x} \\right)\\\\\n\\end{cases}\n\\]\nwhere all parameters are considered positive.\nEquilibria\nThe system has up to three equilibria: \\((x^\\star, y^\\star) = (0,0)\\) (trivial equilibrium); \\((x^\\star, y^\\star) = (1/\\beta,0)\\) (absence of the predator); \\((x^\\star, y^\\star) = (\\delta/(\\alpha - \\delta), \\alpha(\\alpha - (1 + \\beta) \\delta)/(\\alpha - \\delta)^2)\\) (coexistence equilibrium). With some calculations, one can show that the coexistence equilibrium is in the positive orthant whenever:\n\\[\n\\alpha &gt; \\delta (1 + \\beta)\n\\]\nNullclines\nAs before, we can draw the nullclines. The equation for the prey is zero whenever either the prey is absent, or:\n\\[\ny = - \\beta x^2 + (1-\\beta) x+1\n\\]\na downward facing parabola, intercepting the y-axis at \\(1\\), and the x-axis at \\(1/\\beta\\). The prey grows at points below the curve, and declines at points above it.\nThe equation for the predator is zero when the predator is absent or whenever:\n\\[\nx = \\dfrac{\\delta}{\\alpha - \\delta}\n\\]\na vertical line, which is in the positive orthant when \\(\\alpha &gt; \\delta\\).\n\n\n\n\n\nJacobian matrix\nWe compute the Jacobian, obtaining:\n\\[\nJ = \\begin{pmatrix}\n1 - 2 \\beta x - \\dfrac{y}{(1+x)^2} & - 1 + \\dfrac{1}{1+x}\\\\\n\\dfrac{\\alpha y}{(1+x)^2} & -\\delta + \\dfrac{\\alpha x}{1+x}\n\\end{pmatrix}\n\\] We first derive conditions for the stability of the coexistence equilibrium (when present):\n\\[\nM = \\begin{pmatrix}\n2 \\beta +\\dfrac{(\\beta +1) \\delta }{\\alpha } - \\dfrac{2 \\alpha  \\beta }{\\alpha -\\delta}& -\\dfrac{\\delta }{\\alpha } \\\\\n\\alpha -(\\beta +1) \\delta  & 0 \\\\\n\\end{pmatrix}\n\\]\nThe determinant of \\(M\\) is always positive when the coexistence equilibrium exists:\n\\[\n\\det M = \\dfrac{\\delta  (\\alpha -(\\beta +1) \\delta )}{\\alpha } &gt; 0 \\quad \\text{if}\\, \\alpha &gt; \\delta (1 + \\beta)\n\\]\nThe trace of the matrix, however, can be positive or negative depending on the parameter values:\n\\[\n\\text{Tr}M = 2 \\beta +\\dfrac{(\\beta +1) \\delta }{\\alpha } - \\dfrac{2 \\alpha  \\beta }{\\alpha -\\delta} &lt; 0\\quad \\text{if}\\, \\alpha&gt; \\delta (1 + \\beta)\\, \\text{and}\\, \\alpha -\\delta &lt; \\beta (\\alpha + \\delta)\n\\]\nThus, the stability depends on the carrying capacity, \\(1/\\beta\\). Specifically, increasing the carrying capacity (“enrichment”–subsidizing the prey) causes the equilibrium to move from stable to unstable.\nSimilarly, changes in the mortality \\(\\delta\\) or the efficiency of transformation \\(\\alpha\\),can also push the equilibrium from stable to unstable—specifically, to a limit cycle.\nFor example, let’s look at a case in which the equilibrium is stable:\n\n\n\n\n\nTrajectories converge to the equilibrium with dampened oscillations.\nNow a case in which the interior equilibrium is unstable:\n\n\n\n\n\ni.e., dynamics converge to a stable limit cycle. This is easier to see in the phase plane:\n\n\n\n\n\nWith oscillations, both the predator and prey can approach zero. If the prey goes extinct first, both will die out. Alternatively, the predator may go extinct first, and the prey will settle at its carrying capacity. The “paradox of enrichment” was first described by Michael Rosenzweig (b. 1941) in 1971. It demonstrates that the functional form of predation can have important dynamical consequences."
  },
  {
    "objectID": "ch2.html#discrete-time-nicholson-bailey-model",
    "href": "ch2.html#discrete-time-nicholson-bailey-model",
    "title": "Models for two populations",
    "section": "",
    "text": "This is a model for host-parasitoid dynamics. Parasitoids are typically insects whose larvae develop inside an host, usually killing the host when they emerge. The model assumes that hosts are randomly distributed with density \\(H_t\\), parasitoids search for hosts with efficiency \\(a\\). Each parasitized host at time \\(t\\) will produce one parasitoid at time \\(t+1\\). Each non-parasitized host gives rise to \\(R&gt;1\\) new hosts at time \\(t+1\\). The probability of a host escaping an encounter with a parasitoid is \\(e^{-aP_t}\\). This gives us a simple model:\n\\[\n\\begin{cases}\n  H_{t+1}=RH_t e^{-aP_t}\\\\\n  P_{t+1}=H_t \\left(1- e^{-aP_t} \\right)\n\\end{cases}\n\\]\nWe could assume that parasitoids lay \\(c\\) eggs in hosts that survive to become parasitoids, which would yield \\(P_{t+1}=cH_t(1- e^{-aP_t})\\), but we’ll let \\(c=1\\). All the parameters are positive.\n\n\nWe want to find points for which:\n\\[\n\\begin{cases}\n      H_{t+1}=H_t=H^\\star\\\\\n      P_{t+1}=P_t =P^\\star\n    \\end{cases}\n\\]\nFirst, we can see that \\((H^\\star, P^\\star) = (0, 0)\\) is a trivial equilibrium. Then, if the predator is absent we have \\(H^\\star = R H^\\star\\), which happens only if \\(R = 1\\). If the predator is present, we have that at equilibrium \\(H^\\star = R H^\\star e^{-aP^\\star}\\) and thus\n\\[\n\\begin{aligned}\n1 &= R e^{-a P^\\star}\\\\\n0 &= \\log R - a P^\\star\\\\\nP^\\star &= \\dfrac{\\log R}{ a}\n\\end{aligned}\n\\] meaning that the parasitoid can reach a positive equilibrium only when \\(R &gt; 1\\). If this is the case, the equilibrium for the host is:\n\\[\n\\begin{aligned}\n\\dfrac{\\log R}{a} &= H^\\star \\left(1 -  \\dfrac{1}{R}\\right)\\\\\nH^\\star &= \\dfrac{R\\log R}{a(R-1)}\n\\end{aligned}\n\\]\n\n\n\n\n\n\n\n\n\nStability of discrete-time systems\n\n\n\n\n\nWe consider \\(x_t\\), a vector containing the population densities, and we have \\(x_{t+1} = f(x_t)\\), where each entry of \\(f(x_t)\\), \\(f_i(x_t)\\) is a function describing the dynamics of population \\(i\\). As done before, we want to evaluate the asymptotic stability of equilibria, i.e., vectors at which \\(f({x}^\\star) = x^\\star\\).\nWe take a perturbation of the equilibrium \\(x_t = {x}^\\star + p_t\\), and we Taylor-expand each \\(f_i(x_t)\\) around this point. Taking only the first two terms we find:\n\\[\n\\begin{aligned}\nf_i(x^\\star + p_t) &\\approx f_i(x^\\star) + \\sum_j \\left.\\dfrac{\\partial f_i}{\\partial x_j}\\right|_{x^\\star}(x_j^\\star + {p_j}_t - x_j^\\star)\\\\\n&\\approx x_j^\\star + \\sum_j \\left. J_{ij} \\right|_{x^\\star}{p_j}_t\n\\end{aligned}\n\\]\nWhich we can write in matrix form:\n\\[\n\\begin{aligned}\nx_{t + 1} &= f(x_t)\\\\\nx^\\star + p_{t+1} &= f(x^\\star + p_t)\\\\\nx^\\star + p_{t+1} &\\approx x^\\star + \\left. J\\right|_{x^\\star} p_t\\\\\np_{t+1} &\\approx Mp_t\n\\end{aligned}\n\\]\nWhere \\(M\\) again is the community matrix, and we have obtained a linear system in discrete time. Naturally, we can iterate:\n\\[\np_{t+2} = Mp_{t+1} = MMp_t= M^2p_t\n\\]\nand in general\n\\[\np_{t+n} = M^{n} p_t\n\\]\nIf the equilibrium is stable, eventually \\(p_{t+n} = 0_n\\), i.e., the perturbation will die out.\nConsider the real number \\(a\\). We have that:\n\\[\n\\begin{aligned}\n\\lim_{n \\to \\infty} |a|^n &= 0 & \\text{iff} \\quad |a| &lt; 1\\\\\n\\lim_{n \\to \\infty} |a|^n &= \\infty & \\text{iff} \\quad |a| &gt; 1\n\\end{aligned}\n\\]\nA similar result is found for matrices, but instead of taking the absolute value of the real number, we need to consider the spectral radius of the matrix, i.e., the largest modulus (absolute value) of its eigenvalues. An eigenvalue is in general a complex number \\(\\lambda = \\alpha + i \\beta\\). Its modulus is \\(|\\lambda|= \\sqrt{\\alpha^2 + \\beta^2}\\). We then have that the spectral radius \\(\\rho(A) = \\max |\\lambda_i|\\), where \\(\\lambda_i\\) are the eigenvalues of \\(A\\).\nThen\n\\[\n\\lim_{n \\to \\infty}A^n = 0_{n \\times n} \\quad \\text{iff } \\, \\rho(A) &lt; 1\n\\] As such, an equilibrium \\(x^\\star\\) is asymptotically stable if the associated community matrix \\(M\\) has spectral radius \\(\\rho(M) &lt; 1\\).\nFor a \\(2 \\times 2\\) matrix, we have that \\(\\text{Tr} A = t\\) and \\(\\det A = d\\); then\n\\[\n\\lambda = \\dfrac{1}{2} \\left(t \\pm \\sqrt{t^2 - 4d} \\right)\n\\]\nThere are two cases:\n\nwhen \\(t^2 &lt; 4d\\), both eigenvalues are complex: \\(\\lambda_1 = \\frac{1}{2} (t + i \\sqrt{4d -t^2})\\) and \\(\\lambda_2 = \\frac{1}{2} (t - i \\sqrt{4d -t^2})\\); but then \\(\\rho(A)^2 = \\Re(\\lambda_i)^2 + \\Im(\\lambda_i)^2 = \\lambda_i \\lambda_2 = \\det A\\), meaning that the condition for stability is simply \\(0&lt;\\det A &lt; 1\\). Combined with \\(t^2 &lt; 4d\\), yielding \\(|t| &lt; 2 \\sqrt{d} &lt; 2\\), we obtain:\n\n\\[\n|\\text{Tr}A| - 1&lt; \\det A &lt; 1\n\\]\n\nwhen \\(t^2 &gt; 4d\\) both eigenvalues are real, and thus the spectral radius is \\((|t|+\\sqrt{t^2 -4d})/2\\), which is less than one if \\(|t|-1 &lt; d\\) (from \\(|t| - 2 &gt; \\sqrt{t^2 - 4d}\\), \\(t^2 - 4 |t| + 4 &gt; t^2 - 4d\\)). Combining this condition with \\(|t| &lt;2\\), we have \\(t^2 &lt; 4\\) and thus \\(d &lt; 1\\), obtaining the same formula as above.\n\nAs done before, we can characterize the dynamics around the equilibrium point for a 2-dimensional system:\n\n\\(0&lt;\\lambda_1&lt;1&lt;\\lambda_2\\; \\implies\\) Saddle (unstable)\n\\(0&lt;\\lambda_1&lt;\\lambda_2&lt;1\\; \\implies\\) Stable node\n\\(\\lambda_2&gt;\\lambda_1&gt;1\\; \\implies\\) Unstable node\n\\(\\lambda=a \\pm ib, \\; |\\lambda|&lt;1, \\; b \\neq 0\\; \\implies\\) Stable spiral\n\\(\\lambda=a \\pm ib, \\; |\\lambda|&gt;1, \\; b \\neq 0\\; \\implies\\) Unstable spiral\n\\(\\lambda=a \\pm ib, \\; |\\lambda|=1, \\; b \\neq 0\\; \\implies\\) Center\n\\(-1&lt; \\lambda_1&lt;0, \\; \\lambda_2&lt;-1\\; \\implies\\) Oscillatory saddle (unstable)\n\\(\\lambda_1&gt;1, \\; \\lambda_2&gt;-1\\; \\implies\\) Oscillatory source (unstable)\n\n\n\n\nFor the Nicholson-Baley model, the Jacobian is:\n\\[\nJ = \\begin{pmatrix}\nR e^{-a P} & -a R H e^{-a P}\\\\\n1 - e^{-a P} & H a e^{-aP}\n\\end{pmatrix}\n\\]\nThe community matrix is therefore:\n\\[\nM = \\begin{pmatrix}\n1 & -\\dfrac{R \\log R}{R-1} \\\\\n\\dfrac{R-1}{R} & \\dfrac{\\log (R)}{R-1} \\\\\n\\end{pmatrix}\n\\] the determinant of \\(M\\) is\n\\[\n\\det M = \\dfrac{R \\log R}{R -1}\n\\]\nRemember that to have a coexistence equilibrium we need \\(R&gt;1\\). The determinant of \\(M\\) is greater than 1 if\n\\[\n\\begin{aligned}\nR \\log R &&gt; R-1\\\\\n-\\log \\dfrac{1}{R} &&gt; 1 - \\dfrac{1}{R}\\\\\n\\log r &&lt; r - 1\n\\end{aligned}\n\\] where \\(r = 1/R\\). The inequality is met for any \\(r &gt; 0\\) besides \\(r = 1\\). Hence, the equilibrium is always unstable.\n\n\n\n\n\n\nExercise: Spatial Nicholson-Bailey model (Long!)\n\n\n\n\n\nWe have studied the “mean field” Nicholson-Bailey model:\n\\[\n\\begin{aligned}\nH_{t+1}&=R\\,e^{-aP_t}H_t\\\\\nP_{t+1}&=c\\left(1-e^{-aP_t}\\right)H_t\n\\end{aligned}\n\\]\nWe now want to extend it to a \\(N \\times N\\) lattice, i.e., a grid in which in each cell we have local dynamics, and we allow neighboring cells to exchange individuals. The lattice is periodic, i.e., the top and the bottom boundaries of the grid are coincident, the right and the left boundaries are coincident, so that the system runs on a torus – a donut-shaped surface.\nWe write the dynamics for the density of the host and the parasitoid in each cell (\\(H_{ij}\\) and \\(P_{ij}\\)):\n\\[\n\\begin{aligned}\nH_{{ij}_{t+1}} &= R\\,e^{-a \\tilde{P}_{{ij}_t}} \\tilde{H}_{{ij}_t}\\\\\nP_{{ij}_{t+1}} &= c(1-e^{-a \\tilde{P}_{{ij}_t}}) \\tilde{H}_{{ij}_t}\n\\end{aligned}\n\\]\nwhere\n\\[\n  \\tilde{H}_{{ij}_t}=(1-d_h)H_{{ij}_t} +\\frac{d_h}{8} \\sum_{\\text{neighbors}\\, k,l}H_{{kl}_t}\n\\]\nthe sum is taken across the 8 nearest neighbors of the cell \\({i,j}\\). The parameter \\(d_h\\) is the dispersal rate of the host. Similarly,\n\\[\n\\tilde{P}_{{ij}_t} =(1-d_p) P_{{ij}_t}+\\frac{d_p}{8}\n  \\sum_{\\text{neighbors}\\, k,l} P_{{kl}_t}\n\\]\nStart with a \\(51 \\times 51\\) lattice, and set the density of host and parasites to zero everywhere but in cell \\(26,26\\), where \\(H_{26,26}(0)=4\\) and \\(P_{26,26}(0)=1\\). Set \\(d_h=p_h=0.1\\), \\(R=2.0\\), \\(a=c=1.0\\). Evolve the system for 1000 time steps and plot the density of host using image every 5 time steps (Note: R is really poor for doing animations. If you plot every time step and have a fast enough computer, you will get a nice “photosensitive epilectic seizure effect”).\n\n\nThere are at least three strategies to code the model. At each time step, we have to have the matrices for \\(H\\) and \\(P\\) at time \\(t\\) and use these to build the matrices at time \\(t+1\\). Then we can overwrite the matrices and repeat. The main problem is how to deal with the neighbors. We can:\n\nCompute the neighbors on the fly. This is very easy to implement (just remember that when a cell is at the border it disperses on the other side of the lattice). However, in R it is likely to be extremely slow.\nStore all the neighbors. Basically, you can have a matrix of \\((N^2)\\times 8\\) in which for every cell you store the neighbors. This is going to require some memory, but it should pay off in terms of speed.\nBuild a large matrix \\((N^2)\\times (N^2)\\) in which for each cell we have the dispersal rate to any other cell. The good point is that then the whole model becomes simple matrix multiplication, but it requires a lot of memory to store an enormous matrix whose elements are going to be 0 most of the times.\nOther solutions…\n\n\n\n\nHere’s the code that you could write using implementation 1. Choose any of the other method to implement your own code.\n\n# list the coordinates of the eight neighboring cells to a\n# particular cell of interest\nneighboring_cells &lt;- function(ii, jj, N){\n    # This is tedious to write, but fast to run\n    my_neighbors &lt;- matrix(0, 8, 2)\n    my_neighbors[1,] &lt;- c(ii+1, jj+1)\n    my_neighbors[2,] &lt;- c(ii+1, jj)\n    my_neighbors[3,] &lt;- c(ii+1, jj-1)\n    my_neighbors[4,] &lt;- c(ii, jj+1)\n    my_neighbors[5,] &lt;- c(ii, jj-1)\n    my_neighbors[6,] &lt;- c(ii-1, jj-1)\n    my_neighbors[7,] &lt;- c(ii-1, jj)\n    my_neighbors[8,] &lt;- c(ii-1, jj+1)\n    # Wrap the lattice by replacing off-grid elements with\n    # the first index on the opposite side of the grid\n    my_neighbors[my_neighbors == 0] &lt;- N\n    my_neighbors[my_neighbors == N+1] &lt;- 1\n    return(my_neighbors)\n}\n\n# Run the spatial Nicholson-Bailey model, staring with initial\n# matrices of host and parasitoid counts/locations H0 and P0,\n# dispersal rates dh and dp, host growth rate R, parasitoid\n# reproductive rate c, and parasitoid search efficiency a. The\n# remaining parameters set the number of time steps to take and\n# a logical flag for whether to plot the results or not.\nspatial_nicholson_bailey &lt;- function(H, P, dh, dp, R, c, a,\n                                     n_time_steps, plot_graph){\n    # Extract size of (square) grid from matrix of populations\n    N &lt;- nrow(H)\n    # For each time step\n    for (zz in 1:n_time_steps){\n        # Plot every 5 time steps (we use base plotting here\n        # because it is faster)\n        if (plot_graph == TRUE) if (zz %% 5 == 0) image(H)\n        # For each cell\n        for (ii in 1:N) {\n            for (jj in 1:N) {\n                # Find the neighbors\n                my_neighbors &lt;- neighboring_cells(ii, jj, N)\n                # Calculate the equilibrium values for each\n                # cell based on its neighbors\n                HStar &lt;- (1 - dh) * H[ii,jj] +\n                    dh * sum(H[my_neighbors])/8\n                PStar &lt;- (1 - dp) * P[ii,jj] +\n                    dp * sum(P[my_neighbors])/8\n                # Update the matrices\n                H[ii,jj] &lt;- R * HStar * exp(-a * PStar)\n                P[ii,jj] &lt;- c * HStar * (1 - exp(-a * PStar))\n            }\n        }\n    }\n    return(0)\n}\n\n# Initialize the system\nN &lt;- 51\nH &lt;- matrix(0, N, N)\nP &lt;- matrix(0, N, N)\n# put some hosts, parasitoids in the middle\nH[round(N/2), round(N/2)] &lt;- 4\nP[round(N/2), round(N/2)] &lt;- 1\n# Run the system\nspatial_nicholson_bailey(H, P, dh=0.2, dp=0.2, R=2, c=1, a=1,\n                         n_time_steps=100, plot_graph=TRUE)"
  },
  {
    "objectID": "ch2.html#classic-papers",
    "href": "ch2.html#classic-papers",
    "title": "Models for two populations",
    "section": "",
    "text": "The Lotka-Volterra predator-prey model was discovered independently by Alfred J. Lotka and Vito Volterra:\n\nAlfred J. Lotka, 1920. Analytical Note on Certain Rhythmic Relations in Organic Systems. PNAS 6 (7) 410-415\nVito Volterra, 1926. Fluctuations in the Abundance of a Species Considered Mathematically. Nature 118:558-60\n\nYou can read their exchange here.\nThe constant of motion was derived by Lotka in 1920:\n\nAlfred J. Lotka, 1920. Undamped oscillations derived from the law of mass action. Journal of the American Chemical Society 42:1595-1599\n\nVolterra considered many variations, including the competition between species. His results caught the eye of an experimentalist, who validated the principle of competitive exclusion using protozoans:\n\nG.F. Gause, 1934. Experimental Analysis of Vito Volterra’s Mathematical Theory of the Struggle for Existence. Science 79:16-17\n\nThe analysis of two-species competitive Lotka-Volterra inspired the so-called Modern Coexistence Theory:\n\nChesson, P. 2000. Mechanisms of Maintenance of Species Diversity. Annual Review of Ecology and Systematics 31:343-366\n\nOn functional responses:\n\nCrawford S. Holling, 1959. Some Characteristics of Simple Types of Predation and Parasitism. The Canadian Entomologist 91:385-398\n\nThe paper proposing the paradox of enrichment:\n\nRosenzweig, Michael, 1971. The Paradox of Enrichment. Science 171: 385–387\n\nMore on limit cycles in predator-prey systems:\n\nRobert M. May, 1972. Limit Cycles in Predator-Prey Communities Science 177:900-902\nMichael E. Gilpin, 1972. Enriched Predator-Prey Systems: Theoretical Stability Science 177:902-904\n\nThe Nicholson-Bailey model:\n\nA.J. Nicholson, V.A. Bailey, 1935. The Balance of Animal Populations. Part I. Proceedings of the Zoological Society of London. 105: 551–598\n\nand its spatial version:\n\nH.N. Comins, M.P. Hassell, R.M. May, 1992. The Spatial Dynamics of Host–Parasitoid Systems. Journal of Animal Ecology 61:735-748"
  }
]