[
  {
    "objectID": "ch3.html",
    "href": "ch3.html",
    "title": "Models for many populations",
    "section": "",
    "text": "Models for many populations"
  },
  {
    "objectID": "ch4.html",
    "href": "ch4.html",
    "title": "Disease models",
    "section": "",
    "text": "Disease models"
  },
  {
    "objectID": "about.html",
    "href": "about.html",
    "title": "About",
    "section": "",
    "text": "These lecture notes were prepared by Stefano Allesina (sallesina@uchicago.edu) for the graduate class ECEV 42900, Theoretical Ecology, taught at the University of Chicago, Winter Quarter 2024. The notes grew out of other notes from Sarah Cobey.\n\nResources\nThese are good introductions to theoretical ecology:\nThese are good resources for the mathematics of dynamical systems:\n\n\nCourse policies\nThe ethos of the course is collaborative rather than competitive. The instructors are happy to help with assignments and clarifications. Email Stefano Allesina sallesina@uchicago.edu or Greg Dwyer gdwyer@uchicago.edu to meet.\nStudents are expected to work in accordance with the University Policy of Academic Integrity, which can be found here.\nStudents can collaborate, but graded homework should be completed by each student, and not copied from others or from online resources. Students ca use online resources (e.g. StackOverflow, ChatGPT, or other LLMs) to help with coding, but should explicitly acknowledge sources whenever this is the case.\nLate homework: TODO"
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Lecture notes, Part 1: Population Dynamics",
    "section": "",
    "text": "The class is divided in two parts. The first part of the class deals with models for population dynamics. We are going to explore:\n\nModels for a single population\nModels for two populations\nModels for many populations\nModels for disease dynamics\n\n\n\nThe GitHub associated with the lecture notes contains the code to generate the lectures and all the figures and simulations. Crucially, these depend on the following R packages:\n\nlibrary(tidyverse) # plotting, data organization\nlibrary(deSolve) # integrate differential equations\n\n\n\n\n\nWe write \\(x(t)\\) for the density of population \\(x\\) at time \\(t\\). In many cases, we will write simply \\(x\\), as the dependency on time is always assumed. For discrete-time models, we write \\(x_t\\) instead. Typically, \\(x(t)\\) is measured in either \\([\\text{mass}]/[\\text{area/volume}]\\) or \\([\\text{number of individuals}]/[\\text{area/volume}]\\)\nThe density of a population typically changes in time, and the change is modulated by several parameters. We use Greek letters for scalars, lower-case Latin letters for vectors, and upper-case Latin letters for matrices.\nOther useful notation:\n\n\\(i\\) is the imaginary unit, such that \\(i^2 = -1\\)\n\\(0_n\\) is a vector of zeros of lenght \\(n\\)\n\\(1_n\\) is a vector of ones of lenght \\(n\\)\n\\(I\\) is the identity matrix (i.e., a matrix with \\(1_n\\) on the diagonal, and zeros elsewhere)\n\\(D(a)\\) is a diagonal matrix with vector \\(a\\) on the diagonal"
  },
  {
    "objectID": "index.html#computing",
    "href": "index.html#computing",
    "title": "Lecture notes, Part 1: Population Dynamics",
    "section": "",
    "text": "The GitHub associated with the lecture notes contains the code to generate the lectures and all the figures and simulations. Crucially, these depend on the following R packages:\n\nlibrary(tidyverse) # plotting, data organization\nlibrary(deSolve) # integrate differential equations"
  },
  {
    "objectID": "index.html#notation",
    "href": "index.html#notation",
    "title": "Lecture notes, Part 1: Population Dynamics",
    "section": "",
    "text": "We write \\(x(t)\\) for the density of population \\(x\\) at time \\(t\\). In many cases, we will write simply \\(x\\), as the dependency on time is always assumed. For discrete-time models, we write \\(x_t\\) instead. Typically, \\(x(t)\\) is measured in either \\([\\text{mass}]/[\\text{area/volume}]\\) or \\([\\text{number of individuals}]/[\\text{area/volume}]\\)\nThe density of a population typically changes in time, and the change is modulated by several parameters. We use Greek letters for scalars, lower-case Latin letters for vectors, and upper-case Latin letters for matrices.\nOther useful notation:\n\n\\(i\\) is the imaginary unit, such that \\(i^2 = -1\\)\n\\(0_n\\) is a vector of zeros of lenght \\(n\\)\n\\(1_n\\) is a vector of ones of lenght \\(n\\)\n\\(I\\) is the identity matrix (i.e., a matrix with \\(1_n\\) on the diagonal, and zeros elsewhere)\n\\(D(a)\\) is a diagonal matrix with vector \\(a\\) on the diagonal"
  },
  {
    "objectID": "ch1.html",
    "href": "ch1.html",
    "title": "Models for a single population",
    "section": "",
    "text": "Consider a population reproducing annually, with non-overlapping generations. Over its lifetime, each individual produces \\(\\rho\\) offspring, which form the next generation. Then, we can write:\n\\[\nx_{k+1} = \\rho x_k\n\\]\nwhere \\(x_k\\) is the number of individuals/area at generation \\(k\\). Naturally, we can iterate again, and find the population density at time \\(x_{k+2}\\):\n\\[\nx_{k+2} = \\rho x_{k+1} = \\rho^2 x_{k}\n\\]\nand in general:\n\\[\nx_{n} = \\rho^n x_0\n\\]\nwhere \\(x_0\\) is the initial population size, and \\(n\\) is the number of generations since we started tracking the population. We assume \\(x_0&gt;0\\), and thus the population grows whenever \\(\\rho &gt; 1\\), declines whenever \\(\\rho &lt; 1\\), and is constant whenever \\(\\rho = 1\\). Armed with \\(x_0\\) and \\(\\rho\\) we can project the population forward in time for an arbitrary number of generations.\n\n\n\nTake the population density at time \\(t\\) and \\(t + \\Delta t\\); in the time interval \\(\\Delta t\\) the change in population density is \\(x(t + \\Delta t) - x(t)\\), and the average change per unit of time is \\((x(t + \\Delta t) - x(t))/\\Delta t\\). We can consider the limit in which the interval \\(\\Delta t\\) shrinks to zero:\n\\[\n\\lim_{\\Delta t \\to 0} \\dfrac{x(t + \\Delta t) - x(t)}{\\Delta t} = \\frac{dx(t)}{dt}\n\\]\nIn fact, this is exactly the definition of the derivative with respect to (w.r.t.) time of the function \\(x(t)\\). A great contribution of Newton and Leibniz was to recognize that many natural phenomena can be described by simple differential equations—even though the equations describing the rate of change \\(dx(t)/dt\\) are simple, the behavior of the solutions \\(x(t)\\) can be incredibly complex.\nIn ecology and evolutionary biology, one encounters two main types of differential equations:\n\nOrdinary differential equations (ODEs) describe the rate of change of a quantity (in our case, population densities, \\(x(t)\\)) as a function of an independent variable (in our case, the time \\(t\\)), and can contain functions of the quantity, and its derivatives. If only the first derivative (\\(dx(t)/dt\\)) is included, they are called first-order ODEs.\nPartial differential equations (PDEs) contain more than one independent variable (e.g., time and coordinates in space). Therefore, the quantity of interest is a multivariate function, such as \\(q(x,y,t)\\), denoting the density of a population at the coordinates \\(x,y\\) and time \\(t\\). The partial derivatives with respect to the independent variables are considered, hence the name.\n\nMany other types of differential equations (stochastic differential equations, SDEs; integro-differential equations, IDEs; etc.) are found in certain technical areas.\nIn this class, we will deal exclusively with ODEs of the form:\n\\[\n\\dfrac{dx(t)}{dt} = f(x(t))\n\\]\nwhere the function \\(f(x(t))\\) models different ecological phenomena influencing the growth and decline of populations. For example, take populations growing thanks to the per-capita birth rate \\(\\beta\\), and declining due to the death rate \\(\\delta\\):\n\\[\n\\dfrac{dx(t)}{dt} = \\beta x(t) - \\delta x(t) = (\\beta - \\delta) x(t) = \\rho\\, x(t)\n\\]\nhere the intrinsic growth rate \\(\\rho\\) represents the difference between birth and death rates. The parameter is taken to be independent of time, yielding an autonomous differential equation. An ODE is autonomous if it does not depend explicitly on the independent variable (in our case, time). I.e., if \\(dx/dt = f(x(t))\\) the system is autonomous, while \\(dx/dt = g(x(t),t)\\) is not.\n\n\n\n\n\n\nSeparation of variables\n\n\n\n\n\nA differential equation for \\(x(t)\\) is called separable, if it can be written as:\n\\[\n\\frac{dx(t)}{dt} = g(t)\\, h(x(t))\n\\]\nwhere \\(g(t)\\) is a function of \\(t\\), and \\(h(x(t))\\) a function of \\(x(t)\\). As long as \\(h(x(t)) \\neq 0\\), we can formally write:\n\\[\n\\frac{1}{h(x(t))} dx(t) = g(t)\\, dt\n\\]\nWe can now integrate both sides, obtaining\n\\[\n\\begin{aligned}\n\\int \\frac{1}{h(x(t))} dx(t) + \\mathcal c_1 &= \\int g(t)\\, dt + \\mathcal c_2\\\\\n\\int \\frac{1}{h(x(t))} dx(t) &= \\int g(t)\\, dt + \\mathcal c\n\\end{aligned}\n\\]\nwhere \\(\\mathcal c_1, \\mathcal c_2\\) and \\(\\mathcal c = \\mathcal c_2 - \\mathcal c_1\\) are constants of integration, whose value can be set by considering the initial conditions.\nExample\nConsider:\n\\[\n\\frac{dx(t)}{dt} = \\alpha\n\\]\nwith initial condition \\(x(0) = x_0\\). Separate the variables and integrate:\n\\[\n\\begin{aligned}\nd x(t) &= \\alpha\\, dt\\\\\n\\int d x(t) &= \\alpha \\int dt + \\mathcal c\\\\\nx(t) &= \\alpha t + \\mathcal c\n\\end{aligned}\n\\]\nNow substitute the initial condition:\n\\[\nx(0) = x_0 = \\alpha 0 + c  = c\n\\]\nYielding the solution:\n\\[\nx(t) = x_0 + \\alpha t\n\\]\nA solution of an initial-value problem is an equation which, given the values of the parameters (\\(\\alpha\\), in this case) and the initial conditions (\\(x_0\\), in this case), allows us to determine the value of the dependent variable (\\(x(t)\\)) for any value of the independent variable (\\(t\\)). Only relatively simple ODEs or systems of ODEs can be solved explicitly.\n\n\n\nWe can solve the differential equation:\n\\[\n\\begin{aligned}\n\\dfrac{dx}{dt} &= \\rho\\, x\\\\\n\\dfrac{1}{x}\\,dx &= \\rho\\, dt\n\\end{aligned}\n\\]\nIntegrate both sides\n\\[\n\\begin{aligned}\n\\int \\dfrac{1}{x}\\,dx &= \\int \\rho\\, dt\\\\\n\\log x &= \\rho\\, t + \\mathcal c\\\\\nx &= e^{\\rho\\, t  + \\mathcal c}\\\\\nx &= e^{\\rho\\, t} e^\\mathcal c\\\\\n\\end{aligned}\n\\]\nwhere \\(\\mathcal c\\) is a constant of integration. Then, we can plug in the initial condition: at \\(t=0\\), the population is at density \\(x_0\\):\n\\[\n\\begin{aligned}\nx_0 &= e^{\\rho\\, 0}e^{\\mathcal c}\\\\\nx_0 &= e^\\mathcal c\n\\end{aligned}\n\\]\nWe obtain the solution:\n\\[\nx(t) = x(0) e^{\\rho\\, t}\n\\]\n\n\n\n\n\n\nIntegrating differential equations numerically\n\n\n\n\n\nYou can compute \\(x(t)\\) for any differential equation (or system of differential equations) in R using numerical techniques. Your code needs to include two parts:\nFirst, we write a function defining the (system of) ODE(s). This function takes three arguments: t, the time, x, the state of the system, and parms, a list of parameters, and returns a list containing \\(dx/dt\\). For the exponential growth, we can write:\n\nexponential_growth &lt;- function(t, x, parms){\n  dxdt &lt;- x * parms$rho\n  return(list(dxdt))\n}\n\nBecause ecological models only make sense for positive population densities, we can set an arbitrarily small threshold, and consider the population extinct if it falls below the threshold:\n\nTHRESH &lt;- 10^-10\n\nexponential_growth &lt;- function(t, x, parms){\n  if(x &lt; THRESH) x &lt;- 0\n  dxdt &lt;- x * parms$rho\n  return(list(dxdt))\n}\n\nThe second part of the code invokes the numerical integration function ode. For this function, we need to set a) initial conditions, b) determine at which times do we want to observe the state of the population, c) specify the name of the function to use, d) the parameters to use, and e) (optional) specify the method to use for the integration. The function ode is part of the package deSolve:\n\nx0 &lt;- 1 # initial conditions\nmy_time &lt;- seq(0, 5, by = 0.1) # we will observe the system at these times\nparms &lt;- list(rho = 1.05) # list of parameters\noutput &lt;- ode(y = x0, # a) initial conditions\n             times = my_time,  # b) time at which we observe the system\n             func = exponential_growth, # c) function computing r.h.s. of ODEs\n             parms = parms, # d) parameters of ODEs\n             method = \"ode45\") # e) more on this later; this is a good general-purpose choice\n\nThe output is a matrix of class deSolve, containing the time in the first column, and the values of \\(x(t)\\) in the second. For plotting, it is best to convert this into a data frame:\n\noutput %&gt;% \n  as.data.frame() %&gt;% \n  ggplot() + aes(x = time, y = `1`) + \n  geom_point() + \n  geom_line() + \n  xlab(\"t\") + \n  ylab(expression(x(t))) + \n  theme_bw()\n\n\n\n\n\n\n\n\n\nHow long will it take for a growing population (\\(\\rho &gt; 0\\)) to double in density? We are looking for \\(\\tau\\) such that \\[\n\\begin{aligned}\nx(\\tau) &= 2 x_0\\\\\nx_0 e^{\\rho \\tau} &= 2 x_0\\\\\ne^{\\rho \\tau} &= 2\\\\\n\\rho \\tau &= \\log 2\\\\\n\\tau &= \\dfrac{\\log 2}{\\rho}\n\\end{aligned}\n\\]\nThus, the doubling time does not depend on the initial condition: the population will keep doubling every \\(\\log 2 / \\rho\\) units of time. For example, take \\(\\rho = 0.01\\), then \\(\\tau \\approx 30\\): a population growing exponentially with rate of 1% per year will double every 30 years or so. Then, a growth of 3% doubles every 10 years, etc.\n\n\n\n\n\n\nExercise: Radiocarbon dating\n\n\n\n\n\nWhile at the University of Chicago, Willard Libby (Nobel Laureate in Chemistry, 1960) pioneered radiocarbon dating. The carbon isotope \\({}^{14}\\)C is constantly being created in the Earth’s atmosphere by the interaction of cosmic rays with atmospheric nitrogen. The carbon combines with oxygen, to form CO\\({}_2\\) that is then absorbed by plants. When plants die, the isotope decays in their tissues. Radioactive decay follows the exponential model:\n\\[\nN(t) = e^{\\lambda t} N(0)\n\\]\nwhere \\(\\lambda &lt; 0\\) is the decay rate of the isotope. The half-life of a radioisotope is the time it takes to be reduced to half of the original concentration, and is 5,730 years for \\({}^{14}\\)C.\n\nFind the value of \\(\\lambda\\) given the half-life\nExpress \\(t\\) as a function of \\(\\lambda\\), and the ratio between \\(N(t)\\) and \\(N(0)\\)\nThe concentration in the atmosphere is about 1 atom of \\({}^{14}\\)C for every \\(10^{12}\\) atoms of carbon. You have a collected sample that contains \\(1/16\\) atoms of \\({}^{14}\\)C for every \\(10^{12}\\) atoms of carbon; date the sample.\n\n\n\n\n\n\n\n\nWe have a population that grows exponentially when at very low densities, but experience a slow down in growth when densities are higher. The logistic growth equation is typically written as:\n\\[\n\\frac{d X}{d \\tau} = X\\left(\\rho - \\alpha X\\right)\n\\]\nwhere \\(\\rho&gt;0\\) is the intrinsic growth rate of the population, and \\(\\alpha&gt;0\\) is a parameter that regulates the amount by which growth is decreased as \\(X\\) increases.\nAn equilibrium (steady-state, fixed point) of a differential equation is a value of the dependent variable (\\(X\\)) that makes the right-hand side of the equation zero. We denote an equilibrium as \\(X^\\star\\). We can write:\n\\[\n\\left.\\dfrac{dX}{d\\tau}\\right|_{X^\\star} = 0\n\\]\ni.e., the differential equation, evaluated at the point \\(X^\\star\\) is zero: the population will not grow nor decline, but rather will remain at \\(X^\\star\\). The logistic equation has two equilibria: \\(X^\\star=0\\) (absence of the population), and \\(\\rho = \\alpha X^\\star\\), \\(X^\\star = \\rho / \\alpha = \\kappa\\), called the carrying capacity of the population.\n\n\n\n\n\n\nChain rule\n\n\n\n\n\nThis is one of the most useful formulas from calculus. It relates the derivative of the composition of two differentiable functions with the derivatives of the functions. If \\(h(x) = g(u)\\) and \\(u = f(x)\\), then:\n\\[\n\\dfrac{dh}{dx} = \\dfrac{dg}{du}\\dfrac{du}{dx}\n\\]\nAs put by George Simmons [Calculus with Analytic Geometry (1985)]: If a car travels twice as fast as a bicycle and the bicycle is four times as fast as a walking man, then the car travels 2 × 4 = 8 times as fast as the man.\nExample\nTake\n\\[\n\\dfrac{dx(t)}{dt} = x(t) f(x(t))\n\\]\nand write the ODE describing \\(d \\log x(t) /dt\\). We can write this function as the derivative of the composition \\(\\log x(t) = \\log u\\) and \\(u = x(t)\\). Then, by chain rule:\n\\[\n\\begin{aligned}\n\\dfrac{d \\log x(t)}{dt} &= \\dfrac{d \\log u}{du} \\dfrac{du}{dt}\\\\\n&= \\dfrac{1}{u} \\dfrac{du}{dt}\\\\\n&= \\dfrac{1}{x(t)} \\dfrac{d x(t)}{dt}\\\\\n&= \\dfrac{1}{x(t)}  x(t) f(x(t))\\\\\n&= f(x(t))\n\\end{aligned}\n\\]\nshowing that the per-capita rate of change:\n\\[\n\\dfrac{1}{x(t)} \\dfrac{dx(t)}{dt} = \\dfrac{\\log x(t)}{dt}\n\\]\nis the derivative in time of the logarithm of the density of the population.\n\n\n\nWe can simplify the analysis of the differential equation by rescaling all the variables by positive quantities, thus obtaining a simpler form that retains the behavior of the original equation.\n\n\n\n\n\n\nNondimensionalization\n\n\n\n\n\nEcological models can have many parameters, and the goal of nondimensionalization is to rewrite the equations using as few parameters as possible, via a change of variables. Importantly, the new system and the original one are equivalent, and share the same dynamics. In fact, the trajectories of the original system can be reconstructed from those of the simpler system by inverting the transformation.\nTo perform nondimensionalization:\n\nidentify all the variables that depend on time (\\(X(\\tau)\\), \\(Y(\\tau)\\), etc.), as well as the independent variable (the time, \\(\\tau\\))\nreplace each of them by a scaled version: \\(X = c_x x\\), \\(Y = c_y y\\), \\(t = c_t \\tau\\), in which \\(c_i\\) are positive constants to be determined, and rewrite the equations for the new variables\nchoose the values for the constants to eliminate as many parameters as possible. Generally, one should be able to remove one parameter for each dependent variable, plus one parameter by scaling the time.\n\nExample\nThe exponential growth equation has a single parameter:\n\\[\n\\frac{dx}{d\\tau} = \\rho x\n\\]\none can define \\(t = c_1 \\tau\\), obtaining:\n\\[\n\\begin{aligned}\n\\frac{1}{c_1}\\frac{dx}{dt} &= \\rho x\\\\\n\\frac{dx}{dt} &= c_1 \\rho x\\\\\n\\frac{dx}{dt} &= x\n\\end{aligned}\n\\]\nwhere we have chosen \\(c_1 = 1/\\rho\\).\n\n\n\nWe rewrite the equation for the logistic growth by choosing \\(x = c_1 X\\) and \\(t = c_2 \\tau\\). Our equations become (use the chain rule):\n\\[\n\\begin{aligned}\n\\dfrac{c_1}{c_2}\\dfrac{dx}{dt} &= c_1 x (\\rho - \\alpha c_1 x)\\\\\n\\dfrac{dx}{dt} &= x (\\rho c_2 - \\alpha c_1 c_2 x)\\\\\n\\end{aligned}\n\\]\nWe choose \\(c_2 = 1/\\rho\\) to make the first coefficient in parenthesis be equal to 1; then, we choose \\(c_1 = \\rho/\\alpha\\) to make the second coefficient be 1:\n\\[\n\\dfrac{dx}{dt} = x (1 - x)\n\\]\nNote that, in practice, we have chosen to rescale the variables using the intrinsic growth rate, \\(t = \\tau / \\rho\\), and the carrying capacity, \\(x = X \\alpha / \\rho = X / \\kappa\\).\nThe logistic equation can be solved, because it is separable:\n\\[\n\\begin{aligned}\n\\dfrac{1}{x(1-x)} dx &= dt\\\\\n\\left(\\dfrac{1}{x}-\\dfrac{1}{x-1}\\right)dx &= dt\\\\\n\\int \\dfrac{1}{x} dx - \\int \\dfrac{1}{1-x} dx &= \\int dt + \\mathcal c\\\\\n\\log x - \\log(x-1)&= t + c\\\\\n\\log \\dfrac{x}{x-1}&= t + c\\\\\n\\dfrac{x}{x-1} &= e^t e^c\\\\\nx &= \\dfrac{e^t e^c}{e^t e^c - 1}\\\\\nx &= \\dfrac{1}{1 - e^{-t}e^{-c}}\n\\end{aligned}\n\\]\nPlugging in \\(x_0\\) when \\(t=0\\), we find the value for the constant of proportionality:\n\\[\n\\begin{aligned}\nx_0 &= \\frac{e^c}{e^c - 1}\\\\\ne^c &= \\frac{x_0}{x_0 - 1}\n\\end{aligned}\n\\]\nYielding the solution\n\\[\nx(t) = \\dfrac{x_0 e^t}{1 + (e^t - 1)x_0}\n\\]\n\n\n\nAs shown for the logistic growth, solving ODEs can be very hard, and for most equations found in ecology a closed-form solution cannot be found. Moreover, even when we can solve the equations, the solution might be difficult to interpret or overly complex. Important information on the behavior of the system can be found by performing a qualitative analysis of the system. Here we concentrate on the location of equilibria, and their stability.\n\n\nFor any first-order ODE with a single dependent variable, one can understand the behavior of the system by simply plotting \\(x(t)\\) (x-axis) vs \\(dx(t)/dt\\) (y-axis). For example, for the logisitic model:\n\\[\n\\dfrac{dx}{dt} = x(1-x)\n\\]\n\n\n\n\n\nShowing that there are two equilibria (\\(x^\\star =0\\), and \\(x^\\star = 1\\)), corresponding to the points where the curve \\(dx/dt\\) intercepts the x-axis. The function \\(dx/dt\\) is positive whenever \\(0&lt;x&lt;1\\), and is negative when \\(x&gt;1\\). Thus, the population will grow in time when \\(0&lt;x&lt;1\\), eventually reaching \\(x^\\star = 1\\); similarly, if we start the population at a density that is larger than the equilibrium, it will decline, again eventually reaching \\(x^\\star = 1\\). We therefore say that \\(x^\\star = 1\\) is asymptotically stable.\n\n\n\n\n\n\nAsymptotic stability\n\n\n\n\n\nThere are two useful notions of equilibrium stability for dynamical systems. We state them informally; you can find a more rigorous definition in any book on dynamical systems.\nLyapunov stability For a given dynamical system \\(dx(t)/dt\\), \\(x^\\star\\) is Lyapunov stable if trajectories starting close to \\(x^\\star\\) remain close to it, indefinitely. More formally, we define a neighborhood of \\(x^\\star\\), \\(\\| x(0) - x^\\star\\| &lt; \\delta\\); then \\(x^\\star\\) is Lyapunov stable if \\(\\| x(t) - x^\\star\\| &lt; \\epsilon\\) for every \\(t\\), where \\(\\epsilon &gt; 0\\).\nAsymptotic stability An equilibrium is asymptotically stable if it is Lyapunov stable, and trajectories eventually converge to \\(x^\\star\\): \\(x^\\star\\) is asymptotically stable if there exist a neighborhood \\(\\| x(0) - x^\\star\\| &lt; \\delta\\) such that \\(\\lim_{t\\to\\infty}\\| x(t) - x^\\star\\| = 0\\).\n\n\n\nThe logistic model assumes that the per capita growth rate is higher at low densities. This assumption may not be realistic for all species: when the density is low, for example, it can be more difficult to find a partner and defend against predators. This phenomenon of lower per capita growth rates at low densities, and higher per capita growth at high densities—which can also be called positive density-dependence—is known as the Allee effect. It is named after Warder Clyde Allee (1885-1955), who received his PhD from the University of Chicago and was later a professor and chair of Zoology. We could model this effect with the following equation:\n\\[\n\\dfrac{dX}{dt} = X\\left(\\dfrac{u X}{v + X} - c X \\right) = X^2 \\left(\\dfrac{u}{v + X} - c  \\right)\n\\]\nwhere \\(c\\) is the density-dependent death rate. Assume that all parameters are positive; then, besides the trivial equilibrium \\(X^\\star =0\\), we have a positive equilibrium \\(X^\\star = \\frac{u}{c} - v &gt; 0\\).\n\n\n\n\n\nThe graphical method allows to classify all equilibria according to their stability in a straightforward manner. Here’s an example with many equilibria:\n\n\n\n\n\n\n\n\n\n\n\nExercise: Strong Allee effect\n\n\n\n\n\nA stronger version of the Allee effect can be modeled as:\n\\[\n\\dfrac{dX}{dt} = X (X - \\gamma)(\\kappa - X)\n\\]\nwith \\(0&lt;\\gamma &lt; \\kappa\\).\n\nInterpret the parameters\nPlot \\(dX/dt\\) vs \\(X\\), and identify all equilibria\nClassify the equilibria according to their stability\n\n\n\n\n\n\n\n\nYou might have noticed that, when performing the graphical analysis above, and equilibrium is stable if \\(dx/dt\\) has a negative slope at \\(x^\\star\\). Here we formalize this notion, by considering small perturbations of the system resting at an equilibrium.\n\nTake an ODE \\(dx/dt = f(x)\\)\nThe system is resting at an equilibrium \\(x^\\star &gt; 0\\)\nWe perturb the system, and track the dynamics starting at \\(x(0) = x^\\star + \\epsilon\\), where \\(\\epsilon\\) is taken to be sufficiently small \\(\\| \\epsilon \\| \\ll 1\\)\nWe write \\(\\Delta x(0) = x(0) - x^\\star\\)\nWe derive the dynamics for \\(\\Delta x\\):\n\nBy chain rule,\n\\[\n\\begin{aligned}\n\\dfrac{d \\Delta x}{dt} &= \\dfrac{d \\Delta x}{dx} \\dfrac{d x}{dt} \\\\\n&= 1 \\dfrac{d x}{dt}\\\\\n&= f(x)\\\\\n&= f(\\Delta x + x^\\star)\n\\end{aligned}\n\\] Where we have substituted \\(x = \\Delta x + x^\\star\\).\n\nNow we approximate the function \\(f(\\Delta x + x^\\star)\\) by Talyor expanding.\n\n\n\n\n\n\n\nTaylor series\n\n\n\n\n\nWe can approximate the behavior of a (infinitely differentiable) function in the vicinity of a point \\(a\\) by a power series:\n\\[\nf(x) = f(a) + \\dfrac{1}{1!} \\left. \\dfrac{df(x)}{dx} \\right|_a (x-a)+ \\dfrac{1}{2!} \\left. \\dfrac{d^2f(x)}{dx^2} \\right|_a (x-a)^2+ \\dfrac{1}{3!} \\left. \\dfrac{d^3f(x)}{dx^3} \\right|_a (x-a)^3 + \\ldots\n\\] where \\(n! = n (n-1)(n-2)\\ldots 1\\) is the factorial function and the derivatives are evaluated at \\(a\\). When we choose \\(a=0\\) this is called the Maclaurin series.\nExample\nExpand \\(e^x\\) around \\(0\\):\n\\[\n\\begin{aligned}\ne^x &= e^0 + \\left. e^x\\right|_0 x + \\frac{1}{2}\\left. e^x\\right|_0 x^2  + \\frac{1}{6}\\left. e^x\\right|_0 x^3 + \\ldots\\\\\n&=1 + x + \\frac{1}{2} x^2  + \\frac{1}{6}x^3 + \\ldots\\\\\n&=\\sum_{k=0}^\\infty \\frac{x^k}{k!}\n\\end{aligned}\n\\]\n\n\n\nWe want to Taylor-expand \\(f(x) = f(\\Delta x + x^\\star)\\) around \\(x^\\star\\):\n\\[\nf(x) = f(x^\\star) + \\left.\\dfrac{d f(x)}{d x}\\right|_{x^\\star} (x - x^\\star) + \\dfrac{1}{2}\\left.\\dfrac{d^2 f(x)}{d x^2}\\right|_{x^\\star} (x - x^\\star)^2 + \\ldots\n\\] Note that \\(f(x^\\star) = 0\\) by the definition of an equilibrium. If the deviation is small, we can neglect all the higher-order terms, obtaining:\n\\[\n\\dfrac{d \\Delta x}{dt} = f(x) \\approx \\left.\\dfrac{d f(x)}{d x}\\right|_{x^\\star} \\Delta x\n\\]\nwhich is the equation of the exponential growth model, with \\(\\rho = \\left.\\dfrac{d f(x)}{d x}\\right|_{x^\\star}\\). Then, the solution is \\(\\Delta x(t) = \\Delta x(0) e^{\\rho t}\\), and the deviation from the equilibrium goes to zero (i.e., the system goes back to \\(x^\\star\\)) whenever \\(\\rho &lt; 0\\).\nFor example, take the logistic growth model and evaluate the stability of \\(x^\\star = 1\\); we have:\n\\[\n\\left.\\dfrac{d f(x)}{d x}\\right|_{x^\\star} = \\left.\\dfrac{d (x - x^2)}{d x}\\right|_{x^\\star} = \\left.(1 - 2x)\\right|_{x^\\star} = -1\n\\]\nand thus the equilibrium is locally asymptotically stable. Locally, because we have considered very small deviations from the equilibrium.\n\n\n\n\n\n\nExercise: Stability of equilibria for strong Allee effect\n\n\n\n\n\nTake the function for the Allee effect in the previous exercise:\n\\[\n\\dfrac{dX}{dt} = X (X - \\gamma)(\\kappa - X)\n\\]\nUse local stability analysis to show that the system has three equilibria, of which two are locally stable.\n\n\n\n\n\n\nIn certain models, we can show that whenever the population starts at a positive value, it will always reach a certain equilibrium \\(x^\\star\\). In this case, we say the equilibrium is globally asymptotically stable.\nBecause as we said solving differential equations is in general very difficult, and in many cases of interest impossible, we employ a proxy function, called a Lyapunov function.\n\n\n\n\n\n\nLyapunov functions\n\n\n\n\n\nWe want to prove that all trajectories originating at \\(x(0) &gt; 0\\) eventually converge to \\(x^\\star\\). If we can find a function \\(V\\) such that:\n\n\\(V(x(t)) \\geq 0\\) for all \\(x(t) &gt; 0\\)\n\\(V(x(t)) = 0\\) if and only if \\(x(t) = x^\\star\\)\n\\(\\dfrac{d V(x(t))}{dt} \\leq 0\\) for all \\(t\\) and\n\\(\\dfrac{d V(x(t))}{dt} = 0\\) if and only if \\(x(t) = x^\\star\\)\n\nthen \\(x^\\star\\) is globally asymptotically stable: all trajectories starting at a positive point will converge to it.\nThe logic of this procedure is to identify a suitable function \\(V\\) that is positive everywhere but at the equilibrium, and is constantly declining in time; then necessarily the function will eventually reach zero, which is attained only at equilibrium.\nExample\n\\(V(x(t)) = (x(t) - x^\\star)^2\\) is a Lyapunov function that can be used to prove that the logistic growth model \\(dx/dt = x(1-x)\\) has an equilibrium \\(x^\\star = 1\\) that is globally asymptotically stable.\n\n\\(V(x(t))\\) is always nonnegative, and is zero only at \\(x(t) = x^\\star = 1\\)\nThe derivative of \\(V(x(t))\\) w.r.t. time is:\n\n\\[\n\\begin{aligned}\n\\dfrac{dV(t)}{dt} &= \\dfrac{dV(t)}{dx(t)}\\dfrac{dx(t)}{dt}\\\\\n&= 2(x(t) - x^\\star)\\dfrac{dx(t)}{dt}\\\\\n&=2(x(t)-1) x(t)(x(t)-1)\\\\\n&=2 x(t) (x(t)-1)^2 \\geq 0\n\\end{aligned}\n\\]\n\n\n\n\n\n\n\n\n\nExercise: Global stability of logistic growth\n\n\n\n\n\nShow that \\(V(x(t)) = x(t) - 1 - \\log x(t)\\) is a Lyapunov function that can be used to prove the global stability of \\(x^\\star = 1\\) for the logistic growth model \\(dx/dt = x(1-x)\\).\n\nProve that \\(V \\geq 0\\), with equality only at equilibrium\nProve that \\(dV/dt \\leq 0\\), with equality only at equilibrium"
  },
  {
    "objectID": "ch1.html#a-simple-model-for-non-overlapping-generations",
    "href": "ch1.html#a-simple-model-for-non-overlapping-generations",
    "title": "Models for a single population",
    "section": "",
    "text": "Consider a population reproducing annually, with non-overlapping generations. Over its lifetime, each individual produces \\(\\rho\\) offspring, which form the next generation. Then, we can write:\n\\[\nx_{k+1} = \\rho x_k\n\\]\nwhere \\(x_k\\) is the number of individuals/area at generation \\(k\\). Naturally, we can iterate again, and find the population density at time \\(x_{k+2}\\):\n\\[\nx_{k+2} = \\rho x_{k+1} = \\rho^2 x_{k}\n\\]\nand in general:\n\\[\nx_{n} = \\rho^n x_0\n\\]\nwhere \\(x_0\\) is the initial population size, and \\(n\\) is the number of generations since we started tracking the population. We assume \\(x_0&gt;0\\), and thus the population grows whenever \\(\\rho &gt; 1\\), declines whenever \\(\\rho &lt; 1\\), and is constant whenever \\(\\rho = 1\\). Armed with \\(x_0\\) and \\(\\rho\\) we can project the population forward in time for an arbitrary number of generations."
  },
  {
    "objectID": "ch1.html#overlapping-generations-exponential-growth",
    "href": "ch1.html#overlapping-generations-exponential-growth",
    "title": "Models for a single population",
    "section": "",
    "text": "Take the population density at time \\(t\\) and \\(t + \\Delta t\\); in the time interval \\(\\Delta t\\) the change in population density is \\(x(t + \\Delta t) - x(t)\\), and the average change per unit of time is \\((x(t + \\Delta t) - x(t))/\\Delta t\\). We can consider the limit in which the interval \\(\\Delta t\\) shrinks to zero:\n\\[\n\\lim_{\\Delta t \\to 0} \\dfrac{x(t + \\Delta t) - x(t)}{\\Delta t} = \\frac{dx(t)}{dt}\n\\]\nIn fact, this is exactly the definition of the derivative with respect to (w.r.t.) time of the function \\(x(t)\\). A great contribution of Newton and Leibniz was to recognize that many natural phenomena can be described by simple differential equations—even though the equations describing the rate of change \\(dx(t)/dt\\) are simple, the behavior of the solutions \\(x(t)\\) can be incredibly complex.\nIn ecology and evolutionary biology, one encounters two main types of differential equations:\n\nOrdinary differential equations (ODEs) describe the rate of change of a quantity (in our case, population densities, \\(x(t)\\)) as a function of an independent variable (in our case, the time \\(t\\)), and can contain functions of the quantity, and its derivatives. If only the first derivative (\\(dx(t)/dt\\)) is included, they are called first-order ODEs.\nPartial differential equations (PDEs) contain more than one independent variable (e.g., time and coordinates in space). Therefore, the quantity of interest is a multivariate function, such as \\(q(x,y,t)\\), denoting the density of a population at the coordinates \\(x,y\\) and time \\(t\\). The partial derivatives with respect to the independent variables are considered, hence the name.\n\nMany other types of differential equations (stochastic differential equations, SDEs; integro-differential equations, IDEs; etc.) are found in certain technical areas.\nIn this class, we will deal exclusively with ODEs of the form:\n\\[\n\\dfrac{dx(t)}{dt} = f(x(t))\n\\]\nwhere the function \\(f(x(t))\\) models different ecological phenomena influencing the growth and decline of populations. For example, take populations growing thanks to the per-capita birth rate \\(\\beta\\), and declining due to the death rate \\(\\delta\\):\n\\[\n\\dfrac{dx(t)}{dt} = \\beta x(t) - \\delta x(t) = (\\beta - \\delta) x(t) = \\rho\\, x(t)\n\\]\nhere the intrinsic growth rate \\(\\rho\\) represents the difference between birth and death rates. The parameter is taken to be independent of time, yielding an autonomous differential equation. An ODE is autonomous if it does not depend explicitly on the independent variable (in our case, time). I.e., if \\(dx/dt = f(x(t))\\) the system is autonomous, while \\(dx/dt = g(x(t),t)\\) is not.\n\n\n\n\n\n\nSeparation of variables\n\n\n\n\n\nA differential equation for \\(x(t)\\) is called separable, if it can be written as:\n\\[\n\\frac{dx(t)}{dt} = g(t)\\, h(x(t))\n\\]\nwhere \\(g(t)\\) is a function of \\(t\\), and \\(h(x(t))\\) a function of \\(x(t)\\). As long as \\(h(x(t)) \\neq 0\\), we can formally write:\n\\[\n\\frac{1}{h(x(t))} dx(t) = g(t)\\, dt\n\\]\nWe can now integrate both sides, obtaining\n\\[\n\\begin{aligned}\n\\int \\frac{1}{h(x(t))} dx(t) + \\mathcal c_1 &= \\int g(t)\\, dt + \\mathcal c_2\\\\\n\\int \\frac{1}{h(x(t))} dx(t) &= \\int g(t)\\, dt + \\mathcal c\n\\end{aligned}\n\\]\nwhere \\(\\mathcal c_1, \\mathcal c_2\\) and \\(\\mathcal c = \\mathcal c_2 - \\mathcal c_1\\) are constants of integration, whose value can be set by considering the initial conditions.\nExample\nConsider:\n\\[\n\\frac{dx(t)}{dt} = \\alpha\n\\]\nwith initial condition \\(x(0) = x_0\\). Separate the variables and integrate:\n\\[\n\\begin{aligned}\nd x(t) &= \\alpha\\, dt\\\\\n\\int d x(t) &= \\alpha \\int dt + \\mathcal c\\\\\nx(t) &= \\alpha t + \\mathcal c\n\\end{aligned}\n\\]\nNow substitute the initial condition:\n\\[\nx(0) = x_0 = \\alpha 0 + c  = c\n\\]\nYielding the solution:\n\\[\nx(t) = x_0 + \\alpha t\n\\]\nA solution of an initial-value problem is an equation which, given the values of the parameters (\\(\\alpha\\), in this case) and the initial conditions (\\(x_0\\), in this case), allows us to determine the value of the dependent variable (\\(x(t)\\)) for any value of the independent variable (\\(t\\)). Only relatively simple ODEs or systems of ODEs can be solved explicitly.\n\n\n\nWe can solve the differential equation:\n\\[\n\\begin{aligned}\n\\dfrac{dx}{dt} &= \\rho\\, x\\\\\n\\dfrac{1}{x}\\,dx &= \\rho\\, dt\n\\end{aligned}\n\\]\nIntegrate both sides\n\\[\n\\begin{aligned}\n\\int \\dfrac{1}{x}\\,dx &= \\int \\rho\\, dt\\\\\n\\log x &= \\rho\\, t + \\mathcal c\\\\\nx &= e^{\\rho\\, t  + \\mathcal c}\\\\\nx &= e^{\\rho\\, t} e^\\mathcal c\\\\\n\\end{aligned}\n\\]\nwhere \\(\\mathcal c\\) is a constant of integration. Then, we can plug in the initial condition: at \\(t=0\\), the population is at density \\(x_0\\):\n\\[\n\\begin{aligned}\nx_0 &= e^{\\rho\\, 0}e^{\\mathcal c}\\\\\nx_0 &= e^\\mathcal c\n\\end{aligned}\n\\]\nWe obtain the solution:\n\\[\nx(t) = x(0) e^{\\rho\\, t}\n\\]\n\n\n\n\n\n\nIntegrating differential equations numerically\n\n\n\n\n\nYou can compute \\(x(t)\\) for any differential equation (or system of differential equations) in R using numerical techniques. Your code needs to include two parts:\nFirst, we write a function defining the (system of) ODE(s). This function takes three arguments: t, the time, x, the state of the system, and parms, a list of parameters, and returns a list containing \\(dx/dt\\). For the exponential growth, we can write:\n\nexponential_growth &lt;- function(t, x, parms){\n  dxdt &lt;- x * parms$rho\n  return(list(dxdt))\n}\n\nBecause ecological models only make sense for positive population densities, we can set an arbitrarily small threshold, and consider the population extinct if it falls below the threshold:\n\nTHRESH &lt;- 10^-10\n\nexponential_growth &lt;- function(t, x, parms){\n  if(x &lt; THRESH) x &lt;- 0\n  dxdt &lt;- x * parms$rho\n  return(list(dxdt))\n}\n\nThe second part of the code invokes the numerical integration function ode. For this function, we need to set a) initial conditions, b) determine at which times do we want to observe the state of the population, c) specify the name of the function to use, d) the parameters to use, and e) (optional) specify the method to use for the integration. The function ode is part of the package deSolve:\n\nx0 &lt;- 1 # initial conditions\nmy_time &lt;- seq(0, 5, by = 0.1) # we will observe the system at these times\nparms &lt;- list(rho = 1.05) # list of parameters\noutput &lt;- ode(y = x0, # a) initial conditions\n             times = my_time,  # b) time at which we observe the system\n             func = exponential_growth, # c) function computing r.h.s. of ODEs\n             parms = parms, # d) parameters of ODEs\n             method = \"ode45\") # e) more on this later; this is a good general-purpose choice\n\nThe output is a matrix of class deSolve, containing the time in the first column, and the values of \\(x(t)\\) in the second. For plotting, it is best to convert this into a data frame:\n\noutput %&gt;% \n  as.data.frame() %&gt;% \n  ggplot() + aes(x = time, y = `1`) + \n  geom_point() + \n  geom_line() + \n  xlab(\"t\") + \n  ylab(expression(x(t))) + \n  theme_bw()\n\n\n\n\n\n\n\n\n\nHow long will it take for a growing population (\\(\\rho &gt; 0\\)) to double in density? We are looking for \\(\\tau\\) such that \\[\n\\begin{aligned}\nx(\\tau) &= 2 x_0\\\\\nx_0 e^{\\rho \\tau} &= 2 x_0\\\\\ne^{\\rho \\tau} &= 2\\\\\n\\rho \\tau &= \\log 2\\\\\n\\tau &= \\dfrac{\\log 2}{\\rho}\n\\end{aligned}\n\\]\nThus, the doubling time does not depend on the initial condition: the population will keep doubling every \\(\\log 2 / \\rho\\) units of time. For example, take \\(\\rho = 0.01\\), then \\(\\tau \\approx 30\\): a population growing exponentially with rate of 1% per year will double every 30 years or so. Then, a growth of 3% doubles every 10 years, etc.\n\n\n\n\n\n\nExercise: Radiocarbon dating\n\n\n\n\n\nWhile at the University of Chicago, Willard Libby (Nobel Laureate in Chemistry, 1960) pioneered radiocarbon dating. The carbon isotope \\({}^{14}\\)C is constantly being created in the Earth’s atmosphere by the interaction of cosmic rays with atmospheric nitrogen. The carbon combines with oxygen, to form CO\\({}_2\\) that is then absorbed by plants. When plants die, the isotope decays in their tissues. Radioactive decay follows the exponential model:\n\\[\nN(t) = e^{\\lambda t} N(0)\n\\]\nwhere \\(\\lambda &lt; 0\\) is the decay rate of the isotope. The half-life of a radioisotope is the time it takes to be reduced to half of the original concentration, and is 5,730 years for \\({}^{14}\\)C.\n\nFind the value of \\(\\lambda\\) given the half-life\nExpress \\(t\\) as a function of \\(\\lambda\\), and the ratio between \\(N(t)\\) and \\(N(0)\\)\nThe concentration in the atmosphere is about 1 atom of \\({}^{14}\\)C for every \\(10^{12}\\) atoms of carbon. You have a collected sample that contains \\(1/16\\) atoms of \\({}^{14}\\)C for every \\(10^{12}\\) atoms of carbon; date the sample."
  },
  {
    "objectID": "ch1.html#logistic-equation",
    "href": "ch1.html#logistic-equation",
    "title": "Models for a single population",
    "section": "",
    "text": "We have a population that grows exponentially when at very low densities, but experience a slow down in growth when densities are higher. The logistic growth equation is typically written as:\n\\[\n\\frac{d X}{d \\tau} = X\\left(\\rho - \\alpha X\\right)\n\\]\nwhere \\(\\rho&gt;0\\) is the intrinsic growth rate of the population, and \\(\\alpha&gt;0\\) is a parameter that regulates the amount by which growth is decreased as \\(X\\) increases.\nAn equilibrium (steady-state, fixed point) of a differential equation is a value of the dependent variable (\\(X\\)) that makes the right-hand side of the equation zero. We denote an equilibrium as \\(X^\\star\\). We can write:\n\\[\n\\left.\\dfrac{dX}{d\\tau}\\right|_{X^\\star} = 0\n\\]\ni.e., the differential equation, evaluated at the point \\(X^\\star\\) is zero: the population will not grow nor decline, but rather will remain at \\(X^\\star\\). The logistic equation has two equilibria: \\(X^\\star=0\\) (absence of the population), and \\(\\rho = \\alpha X^\\star\\), \\(X^\\star = \\rho / \\alpha = \\kappa\\), called the carrying capacity of the population.\n\n\n\n\n\n\nChain rule\n\n\n\n\n\nThis is one of the most useful formulas from calculus. It relates the derivative of the composition of two differentiable functions with the derivatives of the functions. If \\(h(x) = g(u)\\) and \\(u = f(x)\\), then:\n\\[\n\\dfrac{dh}{dx} = \\dfrac{dg}{du}\\dfrac{du}{dx}\n\\]\nAs put by George Simmons [Calculus with Analytic Geometry (1985)]: If a car travels twice as fast as a bicycle and the bicycle is four times as fast as a walking man, then the car travels 2 × 4 = 8 times as fast as the man.\nExample\nTake\n\\[\n\\dfrac{dx(t)}{dt} = x(t) f(x(t))\n\\]\nand write the ODE describing \\(d \\log x(t) /dt\\). We can write this function as the derivative of the composition \\(\\log x(t) = \\log u\\) and \\(u = x(t)\\). Then, by chain rule:\n\\[\n\\begin{aligned}\n\\dfrac{d \\log x(t)}{dt} &= \\dfrac{d \\log u}{du} \\dfrac{du}{dt}\\\\\n&= \\dfrac{1}{u} \\dfrac{du}{dt}\\\\\n&= \\dfrac{1}{x(t)} \\dfrac{d x(t)}{dt}\\\\\n&= \\dfrac{1}{x(t)}  x(t) f(x(t))\\\\\n&= f(x(t))\n\\end{aligned}\n\\]\nshowing that the per-capita rate of change:\n\\[\n\\dfrac{1}{x(t)} \\dfrac{dx(t)}{dt} = \\dfrac{\\log x(t)}{dt}\n\\]\nis the derivative in time of the logarithm of the density of the population.\n\n\n\nWe can simplify the analysis of the differential equation by rescaling all the variables by positive quantities, thus obtaining a simpler form that retains the behavior of the original equation.\n\n\n\n\n\n\nNondimensionalization\n\n\n\n\n\nEcological models can have many parameters, and the goal of nondimensionalization is to rewrite the equations using as few parameters as possible, via a change of variables. Importantly, the new system and the original one are equivalent, and share the same dynamics. In fact, the trajectories of the original system can be reconstructed from those of the simpler system by inverting the transformation.\nTo perform nondimensionalization:\n\nidentify all the variables that depend on time (\\(X(\\tau)\\), \\(Y(\\tau)\\), etc.), as well as the independent variable (the time, \\(\\tau\\))\nreplace each of them by a scaled version: \\(X = c_x x\\), \\(Y = c_y y\\), \\(t = c_t \\tau\\), in which \\(c_i\\) are positive constants to be determined, and rewrite the equations for the new variables\nchoose the values for the constants to eliminate as many parameters as possible. Generally, one should be able to remove one parameter for each dependent variable, plus one parameter by scaling the time.\n\nExample\nThe exponential growth equation has a single parameter:\n\\[\n\\frac{dx}{d\\tau} = \\rho x\n\\]\none can define \\(t = c_1 \\tau\\), obtaining:\n\\[\n\\begin{aligned}\n\\frac{1}{c_1}\\frac{dx}{dt} &= \\rho x\\\\\n\\frac{dx}{dt} &= c_1 \\rho x\\\\\n\\frac{dx}{dt} &= x\n\\end{aligned}\n\\]\nwhere we have chosen \\(c_1 = 1/\\rho\\).\n\n\n\nWe rewrite the equation for the logistic growth by choosing \\(x = c_1 X\\) and \\(t = c_2 \\tau\\). Our equations become (use the chain rule):\n\\[\n\\begin{aligned}\n\\dfrac{c_1}{c_2}\\dfrac{dx}{dt} &= c_1 x (\\rho - \\alpha c_1 x)\\\\\n\\dfrac{dx}{dt} &= x (\\rho c_2 - \\alpha c_1 c_2 x)\\\\\n\\end{aligned}\n\\]\nWe choose \\(c_2 = 1/\\rho\\) to make the first coefficient in parenthesis be equal to 1; then, we choose \\(c_1 = \\rho/\\alpha\\) to make the second coefficient be 1:\n\\[\n\\dfrac{dx}{dt} = x (1 - x)\n\\]\nNote that, in practice, we have chosen to rescale the variables using the intrinsic growth rate, \\(t = \\tau / \\rho\\), and the carrying capacity, \\(x = X \\alpha / \\rho = X / \\kappa\\).\nThe logistic equation can be solved, because it is separable:\n\\[\n\\begin{aligned}\n\\dfrac{1}{x(1-x)} dx &= dt\\\\\n\\left(\\dfrac{1}{x}-\\dfrac{1}{x-1}\\right)dx &= dt\\\\\n\\int \\dfrac{1}{x} dx - \\int \\dfrac{1}{1-x} dx &= \\int dt + \\mathcal c\\\\\n\\log x - \\log(x-1)&= t + c\\\\\n\\log \\dfrac{x}{x-1}&= t + c\\\\\n\\dfrac{x}{x-1} &= e^t e^c\\\\\nx &= \\dfrac{e^t e^c}{e^t e^c - 1}\\\\\nx &= \\dfrac{1}{1 - e^{-t}e^{-c}}\n\\end{aligned}\n\\]\nPlugging in \\(x_0\\) when \\(t=0\\), we find the value for the constant of proportionality:\n\\[\n\\begin{aligned}\nx_0 &= \\frac{e^c}{e^c - 1}\\\\\ne^c &= \\frac{x_0}{x_0 - 1}\n\\end{aligned}\n\\]\nYielding the solution\n\\[\nx(t) = \\dfrac{x_0 e^t}{1 + (e^t - 1)x_0}\n\\]"
  },
  {
    "objectID": "ch1.html#qualitative-analysis",
    "href": "ch1.html#qualitative-analysis",
    "title": "Models for a single population",
    "section": "",
    "text": "As shown for the logistic growth, solving ODEs can be very hard, and for most equations found in ecology a closed-form solution cannot be found. Moreover, even when we can solve the equations, the solution might be difficult to interpret or overly complex. Important information on the behavior of the system can be found by performing a qualitative analysis of the system. Here we concentrate on the location of equilibria, and their stability.\n\n\nFor any first-order ODE with a single dependent variable, one can understand the behavior of the system by simply plotting \\(x(t)\\) (x-axis) vs \\(dx(t)/dt\\) (y-axis). For example, for the logisitic model:\n\\[\n\\dfrac{dx}{dt} = x(1-x)\n\\]\n\n\n\n\n\nShowing that there are two equilibria (\\(x^\\star =0\\), and \\(x^\\star = 1\\)), corresponding to the points where the curve \\(dx/dt\\) intercepts the x-axis. The function \\(dx/dt\\) is positive whenever \\(0&lt;x&lt;1\\), and is negative when \\(x&gt;1\\). Thus, the population will grow in time when \\(0&lt;x&lt;1\\), eventually reaching \\(x^\\star = 1\\); similarly, if we start the population at a density that is larger than the equilibrium, it will decline, again eventually reaching \\(x^\\star = 1\\). We therefore say that \\(x^\\star = 1\\) is asymptotically stable.\n\n\n\n\n\n\nAsymptotic stability\n\n\n\n\n\nThere are two useful notions of equilibrium stability for dynamical systems. We state them informally; you can find a more rigorous definition in any book on dynamical systems.\nLyapunov stability For a given dynamical system \\(dx(t)/dt\\), \\(x^\\star\\) is Lyapunov stable if trajectories starting close to \\(x^\\star\\) remain close to it, indefinitely. More formally, we define a neighborhood of \\(x^\\star\\), \\(\\| x(0) - x^\\star\\| &lt; \\delta\\); then \\(x^\\star\\) is Lyapunov stable if \\(\\| x(t) - x^\\star\\| &lt; \\epsilon\\) for every \\(t\\), where \\(\\epsilon &gt; 0\\).\nAsymptotic stability An equilibrium is asymptotically stable if it is Lyapunov stable, and trajectories eventually converge to \\(x^\\star\\): \\(x^\\star\\) is asymptotically stable if there exist a neighborhood \\(\\| x(0) - x^\\star\\| &lt; \\delta\\) such that \\(\\lim_{t\\to\\infty}\\| x(t) - x^\\star\\| = 0\\).\n\n\n\nThe logistic model assumes that the per capita growth rate is higher at low densities. This assumption may not be realistic for all species: when the density is low, for example, it can be more difficult to find a partner and defend against predators. This phenomenon of lower per capita growth rates at low densities, and higher per capita growth at high densities—which can also be called positive density-dependence—is known as the Allee effect. It is named after Warder Clyde Allee (1885-1955), who received his PhD from the University of Chicago and was later a professor and chair of Zoology. We could model this effect with the following equation:\n\\[\n\\dfrac{dX}{dt} = X\\left(\\dfrac{u X}{v + X} - c X \\right) = X^2 \\left(\\dfrac{u}{v + X} - c  \\right)\n\\]\nwhere \\(c\\) is the density-dependent death rate. Assume that all parameters are positive; then, besides the trivial equilibrium \\(X^\\star =0\\), we have a positive equilibrium \\(X^\\star = \\frac{u}{c} - v &gt; 0\\).\n\n\n\n\n\nThe graphical method allows to classify all equilibria according to their stability in a straightforward manner. Here’s an example with many equilibria:\n\n\n\n\n\n\n\n\n\n\n\nExercise: Strong Allee effect\n\n\n\n\n\nA stronger version of the Allee effect can be modeled as:\n\\[\n\\dfrac{dX}{dt} = X (X - \\gamma)(\\kappa - X)\n\\]\nwith \\(0&lt;\\gamma &lt; \\kappa\\).\n\nInterpret the parameters\nPlot \\(dX/dt\\) vs \\(X\\), and identify all equilibria\nClassify the equilibria according to their stability"
  },
  {
    "objectID": "ch1.html#local-asymptotic-stability",
    "href": "ch1.html#local-asymptotic-stability",
    "title": "Models for a single population",
    "section": "",
    "text": "You might have noticed that, when performing the graphical analysis above, and equilibrium is stable if \\(dx/dt\\) has a negative slope at \\(x^\\star\\). Here we formalize this notion, by considering small perturbations of the system resting at an equilibrium.\n\nTake an ODE \\(dx/dt = f(x)\\)\nThe system is resting at an equilibrium \\(x^\\star &gt; 0\\)\nWe perturb the system, and track the dynamics starting at \\(x(0) = x^\\star + \\epsilon\\), where \\(\\epsilon\\) is taken to be sufficiently small \\(\\| \\epsilon \\| \\ll 1\\)\nWe write \\(\\Delta x(0) = x(0) - x^\\star\\)\nWe derive the dynamics for \\(\\Delta x\\):\n\nBy chain rule,\n\\[\n\\begin{aligned}\n\\dfrac{d \\Delta x}{dt} &= \\dfrac{d \\Delta x}{dx} \\dfrac{d x}{dt} \\\\\n&= 1 \\dfrac{d x}{dt}\\\\\n&= f(x)\\\\\n&= f(\\Delta x + x^\\star)\n\\end{aligned}\n\\] Where we have substituted \\(x = \\Delta x + x^\\star\\).\n\nNow we approximate the function \\(f(\\Delta x + x^\\star)\\) by Talyor expanding.\n\n\n\n\n\n\n\nTaylor series\n\n\n\n\n\nWe can approximate the behavior of a (infinitely differentiable) function in the vicinity of a point \\(a\\) by a power series:\n\\[\nf(x) = f(a) + \\dfrac{1}{1!} \\left. \\dfrac{df(x)}{dx} \\right|_a (x-a)+ \\dfrac{1}{2!} \\left. \\dfrac{d^2f(x)}{dx^2} \\right|_a (x-a)^2+ \\dfrac{1}{3!} \\left. \\dfrac{d^3f(x)}{dx^3} \\right|_a (x-a)^3 + \\ldots\n\\] where \\(n! = n (n-1)(n-2)\\ldots 1\\) is the factorial function and the derivatives are evaluated at \\(a\\). When we choose \\(a=0\\) this is called the Maclaurin series.\nExample\nExpand \\(e^x\\) around \\(0\\):\n\\[\n\\begin{aligned}\ne^x &= e^0 + \\left. e^x\\right|_0 x + \\frac{1}{2}\\left. e^x\\right|_0 x^2  + \\frac{1}{6}\\left. e^x\\right|_0 x^3 + \\ldots\\\\\n&=1 + x + \\frac{1}{2} x^2  + \\frac{1}{6}x^3 + \\ldots\\\\\n&=\\sum_{k=0}^\\infty \\frac{x^k}{k!}\n\\end{aligned}\n\\]\n\n\n\nWe want to Taylor-expand \\(f(x) = f(\\Delta x + x^\\star)\\) around \\(x^\\star\\):\n\\[\nf(x) = f(x^\\star) + \\left.\\dfrac{d f(x)}{d x}\\right|_{x^\\star} (x - x^\\star) + \\dfrac{1}{2}\\left.\\dfrac{d^2 f(x)}{d x^2}\\right|_{x^\\star} (x - x^\\star)^2 + \\ldots\n\\] Note that \\(f(x^\\star) = 0\\) by the definition of an equilibrium. If the deviation is small, we can neglect all the higher-order terms, obtaining:\n\\[\n\\dfrac{d \\Delta x}{dt} = f(x) \\approx \\left.\\dfrac{d f(x)}{d x}\\right|_{x^\\star} \\Delta x\n\\]\nwhich is the equation of the exponential growth model, with \\(\\rho = \\left.\\dfrac{d f(x)}{d x}\\right|_{x^\\star}\\). Then, the solution is \\(\\Delta x(t) = \\Delta x(0) e^{\\rho t}\\), and the deviation from the equilibrium goes to zero (i.e., the system goes back to \\(x^\\star\\)) whenever \\(\\rho &lt; 0\\).\nFor example, take the logistic growth model and evaluate the stability of \\(x^\\star = 1\\); we have:\n\\[\n\\left.\\dfrac{d f(x)}{d x}\\right|_{x^\\star} = \\left.\\dfrac{d (x - x^2)}{d x}\\right|_{x^\\star} = \\left.(1 - 2x)\\right|_{x^\\star} = -1\n\\]\nand thus the equilibrium is locally asymptotically stable. Locally, because we have considered very small deviations from the equilibrium.\n\n\n\n\n\n\nExercise: Stability of equilibria for strong Allee effect\n\n\n\n\n\nTake the function for the Allee effect in the previous exercise:\n\\[\n\\dfrac{dX}{dt} = X (X - \\gamma)(\\kappa - X)\n\\]\nUse local stability analysis to show that the system has three equilibria, of which two are locally stable."
  },
  {
    "objectID": "ch1.html#global-asymptotic-stability",
    "href": "ch1.html#global-asymptotic-stability",
    "title": "Models for a single population",
    "section": "",
    "text": "In certain models, we can show that whenever the population starts at a positive value, it will always reach a certain equilibrium \\(x^\\star\\). In this case, we say the equilibrium is globally asymptotically stable.\nBecause as we said solving differential equations is in general very difficult, and in many cases of interest impossible, we employ a proxy function, called a Lyapunov function.\n\n\n\n\n\n\nLyapunov functions\n\n\n\n\n\nWe want to prove that all trajectories originating at \\(x(0) &gt; 0\\) eventually converge to \\(x^\\star\\). If we can find a function \\(V\\) such that:\n\n\\(V(x(t)) \\geq 0\\) for all \\(x(t) &gt; 0\\)\n\\(V(x(t)) = 0\\) if and only if \\(x(t) = x^\\star\\)\n\\(\\dfrac{d V(x(t))}{dt} \\leq 0\\) for all \\(t\\) and\n\\(\\dfrac{d V(x(t))}{dt} = 0\\) if and only if \\(x(t) = x^\\star\\)\n\nthen \\(x^\\star\\) is globally asymptotically stable: all trajectories starting at a positive point will converge to it.\nThe logic of this procedure is to identify a suitable function \\(V\\) that is positive everywhere but at the equilibrium, and is constantly declining in time; then necessarily the function will eventually reach zero, which is attained only at equilibrium.\nExample\n\\(V(x(t)) = (x(t) - x^\\star)^2\\) is a Lyapunov function that can be used to prove that the logistic growth model \\(dx/dt = x(1-x)\\) has an equilibrium \\(x^\\star = 1\\) that is globally asymptotically stable.\n\n\\(V(x(t))\\) is always nonnegative, and is zero only at \\(x(t) = x^\\star = 1\\)\nThe derivative of \\(V(x(t))\\) w.r.t. time is:\n\n\\[\n\\begin{aligned}\n\\dfrac{dV(t)}{dt} &= \\dfrac{dV(t)}{dx(t)}\\dfrac{dx(t)}{dt}\\\\\n&= 2(x(t) - x^\\star)\\dfrac{dx(t)}{dt}\\\\\n&=2(x(t)-1) x(t)(x(t)-1)\\\\\n&=2 x(t) (x(t)-1)^2 \\geq 0\n\\end{aligned}\n\\]\n\n\n\n\n\n\n\n\n\nExercise: Global stability of logistic growth\n\n\n\n\n\nShow that \\(V(x(t)) = x(t) - 1 - \\log x(t)\\) is a Lyapunov function that can be used to prove the global stability of \\(x^\\star = 1\\) for the logistic growth model \\(dx/dt = x(1-x)\\).\n\nProve that \\(V \\geq 0\\), with equality only at equilibrium\nProve that \\(dV/dt \\leq 0\\), with equality only at equilibrium"
  },
  {
    "objectID": "ch2.html",
    "href": "ch2.html",
    "title": "Models for two populations",
    "section": "",
    "text": "We have a prey who would grow exponentially when the predator is absent, and a predator that would decline exponentially when the prey is absent. The two species interact, thus allowing for their coexistence:\n\\[\n\\begin{cases}\n\\dfrac{dX}{d\\tau} = \\rho X - \\alpha X Y = X(\\rho - \\alpha Y)\\\\\n\\dfrac{dY}{d\\tau} = -\\delta Y + \\beta X Y = Y(-\\delta + \\beta X)\n\\end{cases}\n\\]\nwhere all parameters are positive. There are two equilibria: \\((X, Y) = (0, 0)\\) and \\((X, Y) = \\left(\\frac{\\delta}{\\beta}, \\frac{\\rho}{\\alpha} \\right)\\).\nNondimensionalization To simplify the equation (but maintain all its important features), we can define two new variables and a new time scale:\n\\[\nx = c_1 X \\quad y = c_2 Y \\quad t = c_3 \\tau\n\\]\nUsing the new variables, we write:\n\\[\n\\begin{cases}\n\\dfrac{c_1}{c_3}\\dfrac{dx}{dt} = c_1 x(\\rho - \\alpha c_2 y)\\\\\n\\dfrac{c_2}{c_3}\\dfrac{dy}{dt} = c_2 y(-\\delta + \\beta c_1 x)\n\\end{cases}\n\\] and thus\n\\[\n\\begin{cases}\n\\dfrac{dx}{dt} = x(c_3 \\rho - \\alpha c_2 c_3 y)\\\\\n\\dfrac{dy}{dt} = y(-c_3 \\delta + \\beta c_1 c_3 x)\n\\end{cases}\n\\]\nIt is convenient to take \\(c_3 = 1/\\rho\\), \\(c_2 = \\rho / \\alpha\\), and \\(c_1 = \\rho / \\beta\\), thus simplifying the system to:\n\\[\n\\begin{cases}\n\\dfrac{dx}{dt} = x(1 - y)\\\\\n\\dfrac{dy}{dt} = y(-\\frac{\\delta}{\\rho} + x) = y(-\\alpha + x)\n\\end{cases}\n\\]\nWe can therefore analyze the case in which we have only a single free parameter, \\(\\alpha = \\rho / \\delta &gt; 0\\). The equilibria are \\((x,y) = (0,0)\\) and \\((x, y) = (\\alpha, 1)\\).\nIsoclines of net zero growth. Clearly, the first equation is zero when either the prey is absent, or the predator is at \\(y = 1\\); the second equation is zero when either the predator is absent or the prey is at \\(x = \\alpha\\); we can draw the two lines in a plane where we have \\(x\\) on the x-axis and \\(y\\) on the y-axis. The feasible (positive) equilibrium will be at the intersection of the two lines:\n\n\n\n\n\nDirection of trajectories\nWe have four quadrants surrounding the equilibrium:\n\n\\(x &lt; \\alpha, y &lt; 1\\): in the bottom-left corner, we have \\(dx/dt &gt; 0\\) and \\(dy/dt &lt; 0\\); accordingly, the prey will grow and the predator decline.\n\\(x &gt; \\alpha, y &lt; 1\\): in the bottom-right corner, we have \\(dx/dt &gt; 0\\) and \\(dy/dt &gt; 0\\); accordingly, both populations will grow\n\\(x &gt; \\alpha, y &gt; 1\\): in the top-right corner, we have \\(dx/dt &lt; 0\\) and \\(dy/dt &gt; 0\\); the prey will decline, the predator grow\n\\(x &lt; \\alpha, y &gt; 1\\): in the top-left corner, we have \\(dx/dt &lt; 0\\) and \\(dy/dt &lt; 0\\); both populations will decline\n\nWe can show these directions visually, by computing \\((dx/dt, dy/dt)\\) at different values of \\((x, y)\\):"
  },
  {
    "objectID": "ch2.html#lotka-volterra-predator-prey-model",
    "href": "ch2.html#lotka-volterra-predator-prey-model",
    "title": "Models for two populations",
    "section": "",
    "text": "We have a prey who would grow exponentially when the predator is absent, and a predator that would decline exponentially when the prey is absent. The two species interact, thus allowing for their coexistence:\n\\[\n\\begin{cases}\n\\dfrac{dX}{d\\tau} = \\rho X - \\alpha X Y = X(\\rho - \\alpha Y)\\\\\n\\dfrac{dY}{d\\tau} = -\\delta Y + \\beta X Y = Y(-\\delta + \\beta X)\n\\end{cases}\n\\]\nwhere all parameters are positive. There are two equilibria: \\((X, Y) = (0, 0)\\) and \\((X, Y) = \\left(\\frac{\\delta}{\\beta}, \\frac{\\rho}{\\alpha} \\right)\\).\nNondimensionalization To simplify the equation (but maintain all its important features), we can define two new variables and a new time scale:\n\\[\nx = c_1 X \\quad y = c_2 Y \\quad t = c_3 \\tau\n\\]\nUsing the new variables, we write:\n\\[\n\\begin{cases}\n\\dfrac{c_1}{c_3}\\dfrac{dx}{dt} = c_1 x(\\rho - \\alpha c_2 y)\\\\\n\\dfrac{c_2}{c_3}\\dfrac{dy}{dt} = c_2 y(-\\delta + \\beta c_1 x)\n\\end{cases}\n\\] and thus\n\\[\n\\begin{cases}\n\\dfrac{dx}{dt} = x(c_3 \\rho - \\alpha c_2 c_3 y)\\\\\n\\dfrac{dy}{dt} = y(-c_3 \\delta + \\beta c_1 c_3 x)\n\\end{cases}\n\\]\nIt is convenient to take \\(c_3 = 1/\\rho\\), \\(c_2 = \\rho / \\alpha\\), and \\(c_1 = \\rho / \\beta\\), thus simplifying the system to:\n\\[\n\\begin{cases}\n\\dfrac{dx}{dt} = x(1 - y)\\\\\n\\dfrac{dy}{dt} = y(-\\frac{\\delta}{\\rho} + x) = y(-\\alpha + x)\n\\end{cases}\n\\]\nWe can therefore analyze the case in which we have only a single free parameter, \\(\\alpha = \\rho / \\delta &gt; 0\\). The equilibria are \\((x,y) = (0,0)\\) and \\((x, y) = (\\alpha, 1)\\).\nIsoclines of net zero growth. Clearly, the first equation is zero when either the prey is absent, or the predator is at \\(y = 1\\); the second equation is zero when either the predator is absent or the prey is at \\(x = \\alpha\\); we can draw the two lines in a plane where we have \\(x\\) on the x-axis and \\(y\\) on the y-axis. The feasible (positive) equilibrium will be at the intersection of the two lines:\n\n\n\n\n\nDirection of trajectories\nWe have four quadrants surrounding the equilibrium:\n\n\\(x &lt; \\alpha, y &lt; 1\\): in the bottom-left corner, we have \\(dx/dt &gt; 0\\) and \\(dy/dt &lt; 0\\); accordingly, the prey will grow and the predator decline.\n\\(x &gt; \\alpha, y &lt; 1\\): in the bottom-right corner, we have \\(dx/dt &gt; 0\\) and \\(dy/dt &gt; 0\\); accordingly, both populations will grow\n\\(x &gt; \\alpha, y &gt; 1\\): in the top-right corner, we have \\(dx/dt &lt; 0\\) and \\(dy/dt &gt; 0\\); the prey will decline, the predator grow\n\\(x &lt; \\alpha, y &gt; 1\\): in the top-left corner, we have \\(dx/dt &lt; 0\\) and \\(dy/dt &lt; 0\\); both populations will decline\n\nWe can show these directions visually, by computing \\((dx/dt, dy/dt)\\) at different values of \\((x, y)\\):"
  }
]