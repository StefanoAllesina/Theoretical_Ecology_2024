[
  {
    "objectID": "ch1.html",
    "href": "ch1.html",
    "title": "Models for a single population",
    "section": "",
    "text": "Consider a population reproducing annually, with non-overlapping generations. Each individual produces \\(\\rho\\) individuals, which form the next generation. Then, we can write:\n\\[\nx_{k+1} = \\rho x_k\n\\]\nwhere \\(x_k\\) is the number of individuals/area at generation \\(k\\). Naturally, we can iterate again and find the population density at time \\(x_{k+2}\\):\n\\[\nx_{k+2} = \\rho x_{k+1} = \\rho^2 x_{k}\n\\]\nand in general:\n\\[\nx_{n} = \\rho^n x_0\n\\]\nwhere \\(x_0\\) is the initial population size, and \\(n\\) is the number of generations since we started tracking the population. Naturally, we assume \\(x_0&gt;0\\), and thus the population grows whenever \\(\\rho &gt; 1\\), shrinks whenever \\(\\rho &lt; 1\\), and is constant whenever \\(\\rho = 1\\). Thus, armed with \\(x_0\\) and \\(\\rho\\) we can project the population forward in time for an arbitrary number of generations.\n\n\n\n\n\n\n\n\n\nSeparation of variables\n\n\n\n\n\nA differential equation for \\(x(t)\\) is called separable, if it can be written as:\n\\[\n\\frac{dx(t)}{dt} = g(t)\\, h(x(t))\n\\]\nwhere \\(g(t)\\) is a function of \\(t\\), and \\(h(x(t))\\) a function of \\(x(t)\\). As long as \\(h(x(t)) \\neq 0\\), we can formally write:\n\\[\n\\frac{1}{h(x(t))} dx(t) = g(t)\\, dt\n\\]\nWe can now integrate both sides, obtaining\n\\[\n\\begin{aligned}\n\\int \\frac{1}{h(x(t))} dx(t) + \\mathcal c_1 &= \\int g(t)\\, dt + \\mathcal c_2\\\\\n\\int \\frac{1}{h(x(t))} dx(t) &= \\int g(t)\\, dt + \\mathcal c\n\\end{aligned}\n\\]\nwhere \\(\\mathcal c_1, \\mathcal c_2\\) and \\(\\mathcal c = \\mathcal c_2 - \\mathcal c_1\\) are constants of integration, whose value can be set by considering the initial conditions.\nExample\nConsider:\n\\[\n\\frac{dx(t)}{dt} = \\alpha\n\\]\nwith initial condition \\(x(0) = x_0\\). Separate the variables and integrate:\n\\[\n\\begin{aligned}\nd x(t) &= \\alpha\\, dt\\\\\n\\int d x(t) &= \\alpha \\int dt + \\mathcal c\\\\\nx(t) &= \\alpha t + \\mathcal c\n\\end{aligned}\n\\] Now substitute the initial condition:\n\\[\nx(0) = x_0 = \\alpha 0 + c  = c\n\\]\nCompleting the solution:\n\\[\nx(t) = x_0 + \\alpha t\n\\]\n\n\n\nWe can solve the differential equation:\n\\[\n\\begin{aligned}\n\\dfrac{dx}{dt} &= \\rho\\, x\\\\\n\\dfrac{1}{x}\\,dx &= \\rho\\, dt\n\\end{aligned}\n\\]\nIntegrate both sides\n\\[\n\\begin{aligned}\n\\int \\dfrac{1}{x}\\,dx &= \\int \\rho\\, dt\\\\\n\\log x &= \\rho\\, t + \\mathcal c\\\\\nx &= e^{\\rho\\, t  + \\mathcal c}\\\\\nx &= e^{\\rho\\, t} e^\\mathcal c\\\\\n\\end{aligned}\n\\]\nwhere \\(\\mathcal c\\) is a constant of integration. Then, we can plug in the initial condition: at \\(t=0\\), the population is at density \\(x_0\\):\n\\[\n\\begin{aligned}\nx_0 &= e^{\\rho\\, 0}e^{\\mathcal c}\\\\\nx_0 &= e^\\mathcal c\n\\end{aligned}\n\\]\nWe obtain the solution:\n\\[\nx(t) = x(0) e^{\\rho\\, t}\n\\]\n\n\n\n\n\n\nIntegrating differential equations\n\n\n\n\n\nYou can compute \\(x(t)\\) for any differential equation (or system of differential equations) in R using numerical techniques. You need two parts:\nFirst, we write a function defining the (system of) ODE(s). This function takes three arguments: t, the time, x, the state of the system, and parms, the parameters, and returns a list containing \\(dx/dt\\). For the exponential growth, we can write:\n\nexponential_growth &lt;- function(t, x, parms){\n  dxdt &lt;- x * parms$rho\n  return(list(dxdt))\n}\n\nBecause ecological models only make sense for positive population densities, we can set an arbitrarily small threshold, and consider the population extinct if it fall below the threshold:\n\nTHRESH &lt;- 10^-10\n\nexponential_growth &lt;- function(t, x, parms){\n  if(x &lt; THRESH) x &lt;- 0\n  dxdt &lt;- x * parms$rho\n  return(list(dxdt))\n}\n\nThe second part of the code invokes the numerical integration function ode. For this function, we need to set a) initial conditions, b) determine at which times do we want to observe the state of the population, c) specify the name of the function to use, d) the parameters to use, and e) (optional) specify the method to use for the integration. The function ode is part of the package deSolve:\n\nx0 &lt;- 1 # initial conditions\nmy_time &lt;- seq(0, 5, by = 0.1) # we will observe the system at these times\nparms &lt;- list(rho = 1.05) # this is always a list of parameters\noutput &lt;- ode(y = x0, # a) initial conditions\n             times = my_time,  # b) time at which we observe the system\n             func = exponential_growth, # c) function computing r.h.s. of ODEs\n             parms = parms, # d) parameters of ODEs\n             method = \"ode45\") # e) more on this later; this is a good general-purpose choice\n\nThe output is a matrix of class deSolve, containing the time in the first column, and the values of \\(x(t)\\) in the second. For plotting, it is best to convert this into a data frame:\n\noutput %&gt;% \n  as.data.frame() %&gt;% \n  ggplot() + aes(x = time, y = `1`) + \n  geom_point() + \n  geom_line() + \n  xlab(\"t\") + \n  ylab(expression(x(t))) + \n  theme_bw()\n\n\n\n\n\n\n\n\n\n\n\n\n\nExercise 1\n\n\n\n\n\nTake the equation for the logistic growth:\n\\[\n\\frac{dx}{dt} = x(1-x)\n\\]\n\nSolve the logistic growth model (the equation is separable).\nDetermine the location of all equilibria and their stability.\nWrite code to integrate the equation numerically.\nWhat happens if \\(x(0) &gt; 1\\), \\(x(0) = 1\\), \\(0 &lt; x(0) &lt; 1\\)?\n(Bonus question) write a Lyapunov function for the logistic equation, and prove the global stability of the positive equilibrium."
  },
  {
    "objectID": "ch1.html#a-simple-model-for-non-overlapping-generations",
    "href": "ch1.html#a-simple-model-for-non-overlapping-generations",
    "title": "Models for a single population",
    "section": "",
    "text": "Consider a population reproducing annually, with non-overlapping generations. Each individual produces \\(\\rho\\) individuals, which form the next generation. Then, we can write:\n\\[\nx_{k+1} = \\rho x_k\n\\]\nwhere \\(x_k\\) is the number of individuals/area at generation \\(k\\). Naturally, we can iterate again and find the population density at time \\(x_{k+2}\\):\n\\[\nx_{k+2} = \\rho x_{k+1} = \\rho^2 x_{k}\n\\]\nand in general:\n\\[\nx_{n} = \\rho^n x_0\n\\]\nwhere \\(x_0\\) is the initial population size, and \\(n\\) is the number of generations since we started tracking the population. Naturally, we assume \\(x_0&gt;0\\), and thus the population grows whenever \\(\\rho &gt; 1\\), shrinks whenever \\(\\rho &lt; 1\\), and is constant whenever \\(\\rho = 1\\). Thus, armed with \\(x_0\\) and \\(\\rho\\) we can project the population forward in time for an arbitrary number of generations."
  },
  {
    "objectID": "ch1.html#overlapping-generations-exponential-growth",
    "href": "ch1.html#overlapping-generations-exponential-growth",
    "title": "Models for a single population",
    "section": "",
    "text": "Separation of variables\n\n\n\n\n\nA differential equation for \\(x(t)\\) is called separable, if it can be written as:\n\\[\n\\frac{dx(t)}{dt} = g(t)\\, h(x(t))\n\\]\nwhere \\(g(t)\\) is a function of \\(t\\), and \\(h(x(t))\\) a function of \\(x(t)\\). As long as \\(h(x(t)) \\neq 0\\), we can formally write:\n\\[\n\\frac{1}{h(x(t))} dx(t) = g(t)\\, dt\n\\]\nWe can now integrate both sides, obtaining\n\\[\n\\begin{aligned}\n\\int \\frac{1}{h(x(t))} dx(t) + \\mathcal c_1 &= \\int g(t)\\, dt + \\mathcal c_2\\\\\n\\int \\frac{1}{h(x(t))} dx(t) &= \\int g(t)\\, dt + \\mathcal c\n\\end{aligned}\n\\]\nwhere \\(\\mathcal c_1, \\mathcal c_2\\) and \\(\\mathcal c = \\mathcal c_2 - \\mathcal c_1\\) are constants of integration, whose value can be set by considering the initial conditions.\nExample\nConsider:\n\\[\n\\frac{dx(t)}{dt} = \\alpha\n\\]\nwith initial condition \\(x(0) = x_0\\). Separate the variables and integrate:\n\\[\n\\begin{aligned}\nd x(t) &= \\alpha\\, dt\\\\\n\\int d x(t) &= \\alpha \\int dt + \\mathcal c\\\\\nx(t) &= \\alpha t + \\mathcal c\n\\end{aligned}\n\\] Now substitute the initial condition:\n\\[\nx(0) = x_0 = \\alpha 0 + c  = c\n\\]\nCompleting the solution:\n\\[\nx(t) = x_0 + \\alpha t\n\\]\n\n\n\nWe can solve the differential equation:\n\\[\n\\begin{aligned}\n\\dfrac{dx}{dt} &= \\rho\\, x\\\\\n\\dfrac{1}{x}\\,dx &= \\rho\\, dt\n\\end{aligned}\n\\]\nIntegrate both sides\n\\[\n\\begin{aligned}\n\\int \\dfrac{1}{x}\\,dx &= \\int \\rho\\, dt\\\\\n\\log x &= \\rho\\, t + \\mathcal c\\\\\nx &= e^{\\rho\\, t  + \\mathcal c}\\\\\nx &= e^{\\rho\\, t} e^\\mathcal c\\\\\n\\end{aligned}\n\\]\nwhere \\(\\mathcal c\\) is a constant of integration. Then, we can plug in the initial condition: at \\(t=0\\), the population is at density \\(x_0\\):\n\\[\n\\begin{aligned}\nx_0 &= e^{\\rho\\, 0}e^{\\mathcal c}\\\\\nx_0 &= e^\\mathcal c\n\\end{aligned}\n\\]\nWe obtain the solution:\n\\[\nx(t) = x(0) e^{\\rho\\, t}\n\\]\n\n\n\n\n\n\nIntegrating differential equations\n\n\n\n\n\nYou can compute \\(x(t)\\) for any differential equation (or system of differential equations) in R using numerical techniques. You need two parts:\nFirst, we write a function defining the (system of) ODE(s). This function takes three arguments: t, the time, x, the state of the system, and parms, the parameters, and returns a list containing \\(dx/dt\\). For the exponential growth, we can write:\n\nexponential_growth &lt;- function(t, x, parms){\n  dxdt &lt;- x * parms$rho\n  return(list(dxdt))\n}\n\nBecause ecological models only make sense for positive population densities, we can set an arbitrarily small threshold, and consider the population extinct if it fall below the threshold:\n\nTHRESH &lt;- 10^-10\n\nexponential_growth &lt;- function(t, x, parms){\n  if(x &lt; THRESH) x &lt;- 0\n  dxdt &lt;- x * parms$rho\n  return(list(dxdt))\n}\n\nThe second part of the code invokes the numerical integration function ode. For this function, we need to set a) initial conditions, b) determine at which times do we want to observe the state of the population, c) specify the name of the function to use, d) the parameters to use, and e) (optional) specify the method to use for the integration. The function ode is part of the package deSolve:\n\nx0 &lt;- 1 # initial conditions\nmy_time &lt;- seq(0, 5, by = 0.1) # we will observe the system at these times\nparms &lt;- list(rho = 1.05) # this is always a list of parameters\noutput &lt;- ode(y = x0, # a) initial conditions\n             times = my_time,  # b) time at which we observe the system\n             func = exponential_growth, # c) function computing r.h.s. of ODEs\n             parms = parms, # d) parameters of ODEs\n             method = \"ode45\") # e) more on this later; this is a good general-purpose choice\n\nThe output is a matrix of class deSolve, containing the time in the first column, and the values of \\(x(t)\\) in the second. For plotting, it is best to convert this into a data frame:\n\noutput %&gt;% \n  as.data.frame() %&gt;% \n  ggplot() + aes(x = time, y = `1`) + \n  geom_point() + \n  geom_line() + \n  xlab(\"t\") + \n  ylab(expression(x(t))) + \n  theme_bw()\n\n\n\n\n\n\n\n\n\n\n\n\n\nExercise 1\n\n\n\n\n\nTake the equation for the logistic growth:\n\\[\n\\frac{dx}{dt} = x(1-x)\n\\]\n\nSolve the logistic growth model (the equation is separable).\nDetermine the location of all equilibria and their stability.\nWrite code to integrate the equation numerically.\nWhat happens if \\(x(0) &gt; 1\\), \\(x(0) = 1\\), \\(0 &lt; x(0) &lt; 1\\)?\n(Bonus question) write a Lyapunov function for the logistic equation, and prove the global stability of the positive equilibrium."
  },
  {
    "objectID": "ch2.html",
    "href": "ch2.html",
    "title": "Models for two populations",
    "section": "",
    "text": "We have a prey who would grow exponentially when the predator is absent, and a predator that would decline exponentially when the prey is absent. The two species interact, thus allowing for their coexistence:\n\\[\n\\begin{cases}\n\\dfrac{dX}{d\\tau} = \\rho X - \\alpha X Y = X(\\rho - \\alpha Y)\\\\\n\\dfrac{dY}{d\\tau} = -\\delta Y + \\beta X Y = Y(-\\delta + \\beta X)\n\\end{cases}\n\\]\nwhere all parameters are positive. There are two equilibria: \\((X, Y) = (0, 0)\\) and \\((X, Y) = \\left(\\frac{\\delta}{\\beta}, \\frac{\\rho}{\\alpha} \\right)\\).\nNondimensionalization To simplify the equation (but maintain all its important features), we can define two new variables and a new time scale:\n\\[\nx = c_1 X \\quad y = c_2 Y \\quad t = c_3 \\tau\n\\]\nUsing the new variables, we write:\n\\[\n\\begin{cases}\n\\dfrac{c_1}{c_3}\\dfrac{dx}{dt} = c_1 x(\\rho - \\alpha c_2 y)\\\\\n\\dfrac{c_2}{c_3}\\dfrac{dy}{dt} = c_2 Y(-\\delta + \\beta c_1 x)\n\\end{cases}\n\\] and thus\n\\[\n\\begin{cases}\n\\dfrac{dx}{dt} = x(c_3 \\rho - \\alpha c_2 c_3 y)\\\\\n\\dfrac{dy}{dt} = y(-c_3 \\delta + \\beta c_1 c_3 x)\n\\end{cases}\n\\]\nIt is convenient to take \\(c_3 = 1/\\rho\\), \\(c_2 = \\rho / \\alpha\\), and \\(c_1 = \\rho / \\beta\\), thus simplifying the system to:\n\\[\n\\begin{cases}\n\\dfrac{dx}{dt} = x(1 - y)\\\\\n\\dfrac{dy}{dt} = y(-\\frac{\\delta}{\\rho} + x) = y(-\\alpha + x)\n\\end{cases}\n\\]\nWe can therefore analyze the case in which we have only a single free parameter, \\(\\alpha = \\rho / \\delta &gt; 0\\). The equilibria are \\((x,y) = (0,0)\\) and \\((x, y) = (\\alpha, 1)\\).\nIsoclines of net zero growth. Clearly, the first equation is zero when either the prey is absent, or the predator is at \\(y = 1\\); the second equation is zero when either the predator is absent or the prey is at \\(x = \\alpha\\); we can draw the two lines in a plane where we have \\(x\\) on the x-axis and \\(y\\) on the y-axis. The feasible (positive) equilibrium will be at the intersection of the two lines:\n\n\n\n\n\nDirection of trajectories\nWe have four quadrants surrounding the equilibrium:\n\n\\(x &lt; \\alpha, y &lt; 1\\): in the bottom-left corner, we have \\(dx/dt &gt; 0\\) and \\(dy/dt &lt; 0\\); accordingly, the prey will grow and the predator decline.\n\\(x &gt; \\alpha, y &lt; 1\\): in the bottom-right corner, we have \\(dx/dt &gt; 0\\) and \\(dy/dt &gt; 0\\); accordingly, both populations will grow\n\\(x &gt; \\alpha, y &gt; 1\\): in the top-right corner, we have \\(dx/dt &lt; 0\\) and \\(dy/dt &gt; 0\\); the prey will decline, the predator grow\n\\(x &lt; \\alpha, y &gt; 1\\): in the top-left corner, we have \\(dx/dt &lt; 0\\) and \\(dy/dt &lt; 0\\); both populations will decline\n\nWe can show these directions visually, by computing \\((dx/dt, dy/dt)\\) at different values of \\((x, y)\\):"
  },
  {
    "objectID": "ch2.html#lotka-volterra-predator-prey-model",
    "href": "ch2.html#lotka-volterra-predator-prey-model",
    "title": "Models for two populations",
    "section": "",
    "text": "We have a prey who would grow exponentially when the predator is absent, and a predator that would decline exponentially when the prey is absent. The two species interact, thus allowing for their coexistence:\n\\[\n\\begin{cases}\n\\dfrac{dX}{d\\tau} = \\rho X - \\alpha X Y = X(\\rho - \\alpha Y)\\\\\n\\dfrac{dY}{d\\tau} = -\\delta Y + \\beta X Y = Y(-\\delta + \\beta X)\n\\end{cases}\n\\]\nwhere all parameters are positive. There are two equilibria: \\((X, Y) = (0, 0)\\) and \\((X, Y) = \\left(\\frac{\\delta}{\\beta}, \\frac{\\rho}{\\alpha} \\right)\\).\nNondimensionalization To simplify the equation (but maintain all its important features), we can define two new variables and a new time scale:\n\\[\nx = c_1 X \\quad y = c_2 Y \\quad t = c_3 \\tau\n\\]\nUsing the new variables, we write:\n\\[\n\\begin{cases}\n\\dfrac{c_1}{c_3}\\dfrac{dx}{dt} = c_1 x(\\rho - \\alpha c_2 y)\\\\\n\\dfrac{c_2}{c_3}\\dfrac{dy}{dt} = c_2 Y(-\\delta + \\beta c_1 x)\n\\end{cases}\n\\] and thus\n\\[\n\\begin{cases}\n\\dfrac{dx}{dt} = x(c_3 \\rho - \\alpha c_2 c_3 y)\\\\\n\\dfrac{dy}{dt} = y(-c_3 \\delta + \\beta c_1 c_3 x)\n\\end{cases}\n\\]\nIt is convenient to take \\(c_3 = 1/\\rho\\), \\(c_2 = \\rho / \\alpha\\), and \\(c_1 = \\rho / \\beta\\), thus simplifying the system to:\n\\[\n\\begin{cases}\n\\dfrac{dx}{dt} = x(1 - y)\\\\\n\\dfrac{dy}{dt} = y(-\\frac{\\delta}{\\rho} + x) = y(-\\alpha + x)\n\\end{cases}\n\\]\nWe can therefore analyze the case in which we have only a single free parameter, \\(\\alpha = \\rho / \\delta &gt; 0\\). The equilibria are \\((x,y) = (0,0)\\) and \\((x, y) = (\\alpha, 1)\\).\nIsoclines of net zero growth. Clearly, the first equation is zero when either the prey is absent, or the predator is at \\(y = 1\\); the second equation is zero when either the predator is absent or the prey is at \\(x = \\alpha\\); we can draw the two lines in a plane where we have \\(x\\) on the x-axis and \\(y\\) on the y-axis. The feasible (positive) equilibrium will be at the intersection of the two lines:\n\n\n\n\n\nDirection of trajectories\nWe have four quadrants surrounding the equilibrium:\n\n\\(x &lt; \\alpha, y &lt; 1\\): in the bottom-left corner, we have \\(dx/dt &gt; 0\\) and \\(dy/dt &lt; 0\\); accordingly, the prey will grow and the predator decline.\n\\(x &gt; \\alpha, y &lt; 1\\): in the bottom-right corner, we have \\(dx/dt &gt; 0\\) and \\(dy/dt &gt; 0\\); accordingly, both populations will grow\n\\(x &gt; \\alpha, y &gt; 1\\): in the top-right corner, we have \\(dx/dt &lt; 0\\) and \\(dy/dt &gt; 0\\); the prey will decline, the predator grow\n\\(x &lt; \\alpha, y &gt; 1\\): in the top-left corner, we have \\(dx/dt &lt; 0\\) and \\(dy/dt &lt; 0\\); both populations will decline\n\nWe can show these directions visually, by computing \\((dx/dt, dy/dt)\\) at different values of \\((x, y)\\):"
  }
]